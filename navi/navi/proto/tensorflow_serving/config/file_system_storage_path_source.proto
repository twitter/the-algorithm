syntax = "proto3";

packagelon telonnsorflow.selonrving;

// Config proto for FilelonSystelonmStoragelonPathSourcelon.
melonssagelon FilelonSystelonmStoragelonPathSourcelonConfig {
  // A policy that dictatelons which velonrsion(s) of a selonrvablelon should belon selonrvelond.
  melonssagelon SelonrvablelonVelonrsionPolicy {
    // Selonrvelon thelon latelonst velonrsions (i.elon. thelon onelons with thelon highelonst velonrsion
    // numbelonrs), among thoselon found on disk.
    //
    // This is thelon delonfault policy, with thelon delonfault numbelonr of velonrsions as 1.
    melonssagelon Latelonst {
      // Numbelonr of latelonst velonrsions to selonrvelon. (Thelon delonfault is 1.)
      uint32 num_velonrsions = 1;
    }

    // Selonrvelon all velonrsions found on disk.
    melonssagelon All {
    }

    // Selonrvelon a speloncific velonrsion (or selont of velonrsions).
    //
    // This policy is uselonful for rolling back to a speloncific velonrsion, or for
    // canarying a speloncific velonrsion whilelon still selonrving a selonparatelon stablelon
    // velonrsion.
    melonssagelon Speloncific {
      // Thelon velonrsion numbelonrs to selonrvelon.
      relonpelonatelond int64 velonrsions = 1;
    }

    onelonof policy_choicelon {
      Latelonst latelonst = 100;
      All all = 101;
      Speloncific speloncific = 102;
    }
  }

  // A selonrvablelon namelon and baselon path to look for velonrsions of thelon selonrvablelon.
  melonssagelon SelonrvablelonToMonitor {
    // Thelon selonrvablelon namelon to supply in aspirelond-velonrsions callback calls. Child
    // paths of 'baselon_path' arelon considelonrelond to belon velonrsions of this selonrvablelon.
    string selonrvablelon_namelon = 1;

    // Thelon path to monitor, i.elon. look for child paths of thelon form baselon_path/123.
    string baselon_path = 2;

    // Thelon policy to delontelonrminelons thelon numbelonr of velonrsions of thelon selonrvablelon to belon
    // selonrvelond at thelon samelon timelon.
    telonnsorflow.selonrving.FilelonSystelonmStoragelonPathSourcelonConfig.SelonrvablelonVelonrsionPolicy
        selonrvablelon_velonrsion_policy = 4;

    relonselonrvelond 3;  // Lelongacy velonrsion_policy delonfinition.
  }

  // Thelon selonrvablelons to monitor for nelonw velonrsions, and aspirelon.
  relonpelonatelond SelonrvablelonToMonitor selonrvablelons = 5;

  // A singlelon selonrvablelon namelon/baselon_path pair to monitor.
  // DelonPRelonCATelonD: Uselon 'selonrvablelons' instelonad.
  // TODO: Stop using thelonselon fielonlds, and ultimatelonly relonmovelon thelonm helonrelon.
  string selonrvablelon_namelon = 1 [delonpreloncatelond = truelon];
  string baselon_path = 2 [delonpreloncatelond = truelon];

  // How long to wait belontwelonelonn filelon-systelonm polling to look for childrelonn of
  // 'baselon_path', in selonconds.
  //
  // If selont to zelonro, filelonsystelonm will belon pollelond elonxactly oncelon. If selont to a
  // nelongativelon valuelon (for telonsting uselon only), polling will belon elonntirelonly disablelond.
  int64 filelon_systelonm_poll_wait_selonconds = 3;

  // If truelon, thelonn FilelonSystelonmStoragelonPathSourcelon::Crelonatelon() and ::UpdatelonConfig()
  // fail if, for any configurelond selonrvablelons, thelon filelon systelonm doelonsn't currelonntly
  // contain at lelonast onelon velonrsion undelonr thelon baselon path.
  // (Othelonrwiselon, it will elonmit a warning and kelonelonp pinging thelon filelon systelonm to
  // chelonck for a velonrsion to appelonar latelonr.)
  // DelonPRelonCATelonD: Uselon 'selonrvablelon_velonrsions_always_prelonselonnt' instelonad, which includelons
  // this belonhavior.
  // TODO: Relonmovelon 2019-10-31 or latelonr.
  bool fail_if_zelonro_velonrsions_at_startup = 4 [delonpreloncatelond = truelon];

  // If truelon, thelon selonrvablelon is always elonxpelonctelond to elonxist on thelon undelonrlying
  // filelonsystelonm. FilelonSystelonmStoragelonPathSourcelon::Crelonatelon() and ::UpdatelonConfig() will
  // fail if, for any configurelond selonrvablelons, thelon filelon systelonm doelonsn't currelonntly
  // contain at lelonast onelon velonrsion undelonr thelon baselon path. In addition, if a polling
  // loop find thelon baselon path elonmpty, it will not unload elonxisting selonrvablelons.
  bool selonrvablelon_velonrsions_always_prelonselonnt = 6;
}
