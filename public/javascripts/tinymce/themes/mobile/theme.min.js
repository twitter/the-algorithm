/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.0.16 (2019-09-24)
 */
!function(d){"use strict";var b=function(){return(b=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)};function u(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]])}return t}function x(){}function y(n){return n}var a=function(t,r){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t(r.apply(null,n))}},v=function(n){return function(){return n}};function l(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=o.concat(n);return r.apply(null,t)}}function m(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return!t.apply(null,n)}}function o(n){return function(){throw new Error(n)}}function t(n){return n()}function n(){return f}var e,c=v(!1),i=v(!0),f=(e={fold:function(n,e){return n()},is:c,isSome:c,isNone:i,getOr:g,getOrThunk:s,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:v(null),getOrUndefined:v(undefined),or:g,orThunk:s,map:n,each:x,bind:n,exists:c,forall:i,filter:n,equals:r,equals_:r,toArray:function(){return[]},toString:v("none()")},Object.freeze&&Object.freeze(e),e);function r(n){return n.isNone()}function s(n){return n()}function g(n){return n}function w(n,t){return Vn(n,function(n,e){return{k:e,v:t(n,e)}})}function p(n,e){return Fn.call(n,e)}function h(t){var r,o=!1;return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return o||(o=!0,r=t.apply(null,n)),r}}function S(n,e){var t=function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.test(e))return r}return undefined}(n,e);if(!t)return{major:0,minor:0};function r(n){return Number(e.replace(t,"$"+n))}return Qn(r(1),r(2))}function T(n,e){return function(){return e===n}}function O(n,e){return function(){return e===n}}function k(e){return function(n){return function(n){if(null===n)return"null";var e=typeof n;return"object"==e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e}(n)===e}}function E(n,e){return-1<function(n,e){return xe.call(n,e)}(n,e)}function C(n,e){for(var t=0,r=n.length;t<r;t++){if(e(n[t],t))return!0}return!1}function D(n,e){for(var t=0,r=n.length;t<r;t++){e(n[t],t)}}function M(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var i=n[r];e(i,r)&&t.push(i)}return t}function I(n,e,t){return function(n,e){for(var t=n.length-1;0<=t;t--){e(n[t],t)}}(n,function(n){t=e(t,n)}),t}function R(n,e,t){return D(n,function(n){t=e(t,n)}),t}function A(n,e){for(var t=0,r=n.length;t<r;t++){var o=n[t];if(e(o,t))return Rn.some(o)}return Rn.none()}function F(n,e){for(var t=0,r=n.length;t<r;t++){if(e(n[t],t))return Rn.some(t)}return Rn.none()}function B(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!pe(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);we.apply(e,n[t])}return e}function V(n,e){var t=Se(n,e);return B(t)}function N(n,e){for(var t=0,r=n.length;t<r;++t){if(!0!==e(n[t],t))return!1}return!0}function j(n){var e=be.call(n,0);return e.reverse(),e}function _(n){return[n]}function H(n,e){var t=String(e).toLowerCase();return A(n,function(n){return n.search(t)})}function P(n,e){return-1!==n.indexOf(e)}function z(e){return function(n){return P(n,e)}}function L(n,e){Xe(n,n.element(),e,{})}function G(n,e,t){Xe(n,n.element(),e,t)}function U(n){L(n,Ne())}function $(n,e,t){Xe(n,e,t,{})}function W(n){return n.dom().nodeName.toLowerCase()}function X(e){return function(n){return function(n){return n.dom().nodeType}(n)===e}}function q(n){var e=nt(n)?n.dom().parentNode:n.dom();return e!==undefined&&null!==e&&e.ownerDocument.body.contains(e)}function Y(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(e.length!==t.length)throw new Error('Wrong number of arguments to struct. Expected "['+e.length+']", got '+t.length+" arguments");var r={};return D(e,function(n,e){r[n]=v(t[e])}),r}}function K(n){return n.slice(0).sort()}function J(e,n){if(!pe(n))throw new Error("The "+e+" fields must be an array. Was: "+n+".");D(n,function(n){if(!me(n))throw new Error("The value "+n+" in the "+e+" fields was not a string.")})}function Q(o,i){var u=o.concat(i);if(0===u.length)throw new Error("You must specify at least one required or optional field.");return J("required",o),J("optional",i),function(n){var t=K(n);A(t,function(n,e){return e<t.length-1&&n===t[e+1]}).each(function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+t.join(", ")+"].")})}(u),function(e){var t=An(e);N(o,function(n){return E(t,n)})||function(n,e){throw new Error("All required keys ("+K(n).join(", ")+") were not specified. Specified keys were: "+K(e).join(", ")+".")}(o,t);var n=M(t,function(n){return!E(u,n)});0<n.length&&function(n){throw new Error("Unsupported keys for object: "+K(n).join(", "))}(n);var r={};return D(o,function(n){r[n]=v(e[n])}),D(i,function(n){r[n]=v(Object.prototype.hasOwnProperty.call(e,n)?Rn.some(e[n]):Rn.none())}),r}}function Z(n,e,t){return 0!=(n.compareDocumentPosition(e)&t)}function nn(n,e){var t=n.dom();if(t.nodeType!==ot)return!1;var r=t;if(r.matches!==undefined)return r.matches(e);if(r.msMatchesSelector!==undefined)return r.msMatchesSelector(e);if(r.webkitMatchesSelector!==undefined)return r.webkitMatchesSelector(e);if(r.mozMatchesSelector!==undefined)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}function en(n){return n.nodeType!==ot&&n.nodeType!==it||0===n.childElementCount}function tn(n,e){var t=e===undefined?d.document:e.dom();return en(t)?[]:Se(t.querySelectorAll(n),Ye.fromDom)}function rn(n,e){var t=e===undefined?d.document:e.dom();return en(t)?Rn.none():Rn.from(t.querySelector(n)).map(Ye.fromDom)}function on(n,e){return n.dom()===e.dom()}function un(n){return Ye.fromDom(n.dom().ownerDocument)}function cn(n){return Rn.from(n.dom().parentNode).map(Ye.fromDom)}function an(n,e){var t=n.dom().childNodes;return Rn.from(t[e]).map(Ye.fromDom)}function fn(e,t){cn(e).each(function(n){n.dom().insertBefore(t.dom(),e.dom())})}function sn(n,e){(function(n){return Rn.from(n.dom().nextSibling).map(Ye.fromDom)})(n).fold(function(){cn(n).each(function(n){ct(n,e)})},function(n){fn(n,e)})}function ln(e,t){(function(n){return an(n,0)})(e).fold(function(){ct(e,t)},function(n){e.dom().insertBefore(t.dom(),n.dom())})}function dn(e,n){D(n,function(n){ct(e,n)})}function mn(n){n.dom().textContent="",D(ut(n),function(n){at(n)})}function gn(n,e){lt(n,e,ct)}function pn(n){ft(n),at(n.element()),n.getSystem().removeFromWorld(n)}function hn(e){var n=cn(e.element()).bind(function(n){return e.getSystem().getByDom(n).toOption()});pn(e),n.each(function(n){n.syncComponents()})}function vn(u){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var t={},r=0;r<n.length;r++){var o=n[r];for(var i in o)vt.call(o,i)&&(t[i]=u(t[i],o[i]))}return t}}function yn(n){return xt.defaultedThunk(v(n))}function bn(e){return function(n){return p(n,e)?Rn.from(n[e]):Rn.none()}}function xn(n,e){return bn(e)(n)}function wn(n,e){var t={};return t[n]=e,t}function Sn(n,e){return function(n,t){var r={};return Bn(n,function(n,e){E(t,e)||(r[e]=n)}),r}(n,e)}function Tn(n,e){return function(e,t){return function(n){return p(n,e)?n[e]:t}}(n,e)}function On(n,e){return wn(n,e)}function kn(n){return function(n){var e={};return D(n,function(n){e[n.key]=n.value}),e}(n)}function En(n,e){var t=function(n){var e=[],t=[];return D(n,function(n){n.fold(function(n){e.push(n)},function(n){t.push(n)})}),{errors:e,values:t}}(n);return 0<t.errors.length?function(n){return pt.error(B(n))}(t.errors):function(n,e){return 0===n.length?pt.value(e):pt.value(yt(e,bt.apply(undefined,n)))}(t.values,e)}function Cn(n,e){return function(n,e){return p(n,e)&&n[e]!==undefined&&null!==n[e]}(n,e)}var Dn,Mn,In=function(t){function n(){return o}function e(n){return n(t)}var r=v(t),o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:i,isNone:c,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:n,orThunk:n,map:function(n){return In(n(t))},each:function(n){n(t)},bind:e,exists:e,forall:e,filter:function(n){return n(t)?o:f},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(c,function(n){return e(t,n)})}};return o},Rn={some:In,none:n,from:function(n){return null===n||n===undefined?f:In(n)}},An=Object.keys,Fn=Object.hasOwnProperty,Bn=function(n,e){for(var t=An(n),r=0,o=t.length;r<o;r++){var i=t[r];e(n[i],i)}},Vn=function(n,r){var o={};return Bn(n,function(n,e){var t=r(n,e);o[t.k]=t.v}),o},Nn=function(n,t){var r=[];return Bn(n,function(n,e){r.push(t(n,e))}),r},jn=v("touchstart"),_n=v("touchmove"),Hn=v("touchend"),Pn=v("mousedown"),zn=v("mousemove"),Ln=v("mouseup"),Gn=v("mouseover"),Un=v("keydown"),$n=v("keyup"),Wn=v("input"),Xn=v("change"),qn=v("click"),Yn=v("transitionend"),Kn=v("selectstart"),Jn=function(){return Qn(0,0)},Qn=function(n,e){return{major:n,minor:e}},Zn={nu:Qn,detect:function(n,e){var t=String(e).toLowerCase();return 0===n.length?Jn():S(n,t)},unknown:Jn},ne="Edge",ee="Chrome",te="Opera",re="Firefox",oe="Safari",ie=function(n){var e=n.current;return{current:e,version:n.version,isEdge:T(ne,e),isChrome:T(ee,e),isIE:T("IE",e),isOpera:T(te,e),isFirefox:T(re,e),isSafari:T(oe,e)}},ue={unknown:function(){return ie({current:undefined,version:Zn.unknown()})},nu:ie,edge:v(ne),chrome:v(ee),ie:v("IE"),opera:v(te),firefox:v(re),safari:v(oe)},ce="Windows",ae="Android",fe="Solaris",se="FreeBSD",le=function(n){var e=n.current;return{current:e,version:n.version,isWindows:O(ce,e),isiOS:O("iOS",e),isAndroid:O(ae,e),isOSX:O("OSX",e),isLinux:O("Linux",e),isSolaris:O(fe,e),isFreeBSD:O(se,e)}},de={unknown:function(){return le({current:undefined,version:Zn.unknown()})},nu:le,windows:v(ce),ios:v("iOS"),android:v(ae),linux:v("Linux"),osx:v("OSX"),solaris:v(fe),freebsd:v(se)},me=k("string"),ge=k("object"),pe=k("array"),he=k("boolean"),ve=k("function"),ye=k("number"),be=Array.prototype.slice,xe=Array.prototype.indexOf,we=Array.prototype.push,Se=function(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var i=n[o];r[o]=e(i,o)}return r},Te=(ve(Array.from)&&Array.from,function(n,t){return H(n,t).map(function(n){var e=Zn.detect(n.versionRegexes,t);return{current:n.name,version:e}})}),Oe=function(n,t){return H(n,t).map(function(n){var e=Zn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},ke=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Ee=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return P(n,"edge/")&&P(n,"chrome")&&P(n,"safari")&&P(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ke],search:function(n){return P(n,"chrome")&&!P(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return P(n,"msie")||P(n,"trident")}},{name:"Opera",versionRegexes:[ke,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:z("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:z("firefox")},{name:"Safari",versionRegexes:[ke,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(P(n,"safari")||P(n,"mobile/"))&&P(n,"applewebkit")}}],Ce=[{name:"Windows",search:z("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return P(n,"iphone")||P(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:z("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:z("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:z("linux"),versionRegexes:[]},{name:"Solaris",search:z("sunos"),versionRegexes:[]},{name:"FreeBSD",search:z("freebsd"),versionRegexes:[]}],De={browsers:v(Ee),oses:v(Ce)},Me=function(n){var e=De.browsers(),t=De.oses(),r=Te(e,n).fold(ue.unknown,ue.nu),o=Oe(t,n).fold(de.unknown,de.nu);return{browser:r,os:o,deviceType:function(n,e,t){var r=n.isiOS()&&!0===/ipad/i.test(t),o=n.isiOS()&&!r,i=n.isAndroid()&&3===n.version.major,u=n.isAndroid()&&4===n.version.major,c=r||i||u&&!0===/mobile/i.test(t),a=n.isiOS()||n.isAndroid(),f=a&&!c,s=e.isSafari()&&n.isiOS()&&!1===/safari/i.test(t);return{isiPad:v(r),isiPhone:v(o),isTablet:v(c),isPhone:v(f),isTouch:v(a),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:v(s)}}(o,r,n)}},Ie={detect:h(function(){var n=d.navigator.userAgent;return Me(n)})},Re={tap:v("alloy.tap")},Ae=v("alloy.focus"),Fe=v("alloy.blur.post"),Be=v("alloy.paste.post"),Ve=v("alloy.receive"),Ne=v("alloy.execute"),je=v("alloy.focus.item"),_e=Re.tap,He=Ie.detect().deviceType.isTouch()?Re.tap:qn,Pe=v("alloy.longpress"),ze=v("alloy.system.init"),Le=v("alloy.system.attached"),Ge=v("alloy.system.detached"),Ue=v("alloy.focusmanager.shifted"),$e=v("alloy.highlight"),We=v("alloy.dehighlight"),Xe=function(n,e,t,r){var o=b({target:e},r);n.getSystem().triggerEvent(t,e,w(o,v))},qe=function(n){if(null===n||n===undefined)throw new Error("Node cannot be null or undefined");return{dom:v(n)}},Ye={fromHtml:function(n,e){var t=(e||d.document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw d.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return qe(t.childNodes[0])},fromTag:function(n,e){var t=(e||d.document).createElement(n);return qe(t)},fromText:function(n,e){var t=(e||d.document).createTextNode(n);return qe(t)},fromDom:qe,fromPoint:function(n,e,t){var r=n.dom();return Rn.from(r.elementFromPoint(e,t)).map(qe)}},Ke=(d.Node.ATTRIBUTE_NODE,d.Node.CDATA_SECTION_NODE,d.Node.COMMENT_NODE,d.Node.DOCUMENT_NODE),Je=(d.Node.DOCUMENT_TYPE_NODE,d.Node.DOCUMENT_FRAGMENT_NODE,d.Node.ELEMENT_NODE),Qe=d.Node.TEXT_NODE,Ze=(d.Node.PROCESSING_INSTRUCTION_NODE,d.Node.ENTITY_REFERENCE_NODE,d.Node.ENTITY_NODE,d.Node.NOTATION_NODE,"undefined"!=typeof d.window?d.window:Function("return this;")(),X(Je)),nt=X(Qe),et=h(function(){return tt(Ye.fromDom(d.document))}),tt=function(n){var e=n.dom().body;if(null===e||e===undefined)throw new Error("Body is not available yet");return Ye.fromDom(e)},rt=function(n,e){return Z(n,e,d.Node.DOCUMENT_POSITION_CONTAINED_BY)},ot=Je,it=Ke,ut=(Ie.detect().browser.isIE(),function(n){return Se(n.dom().childNodes,Ye.fromDom)}),ct=(Y("element","offset"),function(n,e){n.dom().appendChild(e.dom())}),at=function(n){var e=n.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},ft=function(n){L(n,Ge());var e=n.components();D(e,ft)},st=function(n){var e=n.components();D(e,st),L(n,Le())},lt=function(n,e,t){n.getSystem().addToWorld(e),t(n.element(),e.element()),q(n.element())&&st(e),n.syncComponents()},dt=function(n,e,t){t(n,e.element());var r=ut(e.element());D(r,function(n){e.getByDom(n).each(st)})},mt=function(t){return{is:function(n){return t===n},isValue:i,isError:c,getOr:v(t),getOrThunk:v(t),getOrDie:v(t),or:function(n){return mt(t)},orThunk:function(n){return mt(t)},fold:function(n,e){return e(t)},map:function(n){return mt(n(t))},mapError:function(n){return mt(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOption:function(){return Rn.some(t)}}},gt=function(t){return{is:c,isValue:c,isError:i,getOr:y,getOrThunk:function(n){return n()},getOrDie:function(){return o(String(t))()},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,e){return n(t)},map:function(n){return gt(t)},mapError:function(n){return gt(n(t))},each:x,bind:function(n){return gt(t)},exists:c,forall:i,toOption:Rn.none}},pt={value:mt,error:gt,fromOption:function(n,e){return n.fold(function(){return gt(e)},mt)}},ht=function(u){if(!pe(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var c=[],t={};return D(u,function(n,r){var e=An(n);if(1!==e.length)throw new Error("one and only one name per case");var o=e[0],i=n[o];if(t[o]!==undefined)throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!pe(i))throw new Error("case arguments must be an array");c.push(o),t[o]=function(){var n=arguments.length;if(n!==i.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+i.length+" ("+i+"), got "+n);for(var t=new Array(n),e=0;e<t.length;e++)t[e]=arguments[e];return{fold:function(){if(arguments.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+arguments.length);return arguments[r].apply(null,t)},match:function(n){var e=An(n);if(c.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+e.join(","));if(!N(c,function(n){return E(e,n)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+c.join(", "));return n[o].apply(null,t)},log:function(n){d.console.log(n,{constructors:c,constructor:o,params:t})}}}}),t},vt=Object.prototype.hasOwnProperty,yt=vn(function(n,e){return ge(n)&&ge(e)?yt(n,e):e}),bt=vn(function(n,e){return e}),xt=ht([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),wt=xt.strict,St=xt.asOption,Tt=xt.defaultedThunk,Ot=xt.mergeWithThunk,kt=(ht([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n){return bn(n)}),Et=function(n,e){return xn(n,e)};(Mn=Dn=Dn||{})[Mn.Error=0]="Error",Mn[Mn.Value=1]="Value";function Ct(n,e,t){return n.stype===Dn.Error?e(n.serror):t(n.svalue)}function Dt(n){return{stype:Dn.Value,svalue:n}}function Mt(n){return{stype:Dn.Error,serror:n}}function It(n){return a(dr,B)(n)}function Rt(n){return ge(n)&&100<An(n).length?" removed due to size":JSON.stringify(n,null,2)}function At(n,e){return dr([{path:n,getErrorInfo:e}])}function Ft(n,e,t){return xn(e,t).fold(function(){return function(n,e,t){return At(n,function(){return'Could not find valid *strict* value for "'+e+'" in '+Rt(t)})}(n,t,e)},sr)}function Bt(n,e,t){var r=xn(n,e).fold(function(){return t(n)},y);return sr(r)}function Vt(u,c,n,a){return n.fold(function(r,t,n,o){function i(n){var e=o.extract(u.concat([r]),a,n);return pr(e,function(n){return wn(t,a(n))})}function e(n){return n.fold(function(){var n=wn(t,a(Rn.none()));return sr(n)},function(n){var e=o.extract(u.concat([r]),a,n);return pr(e,function(n){return wn(t,a(Rn.some(n)))})})}return n.fold(function(){return mr(Ft(u,c,r),i)},function(n){return mr(Bt(c,r,n),i)},function(){return mr(function(n,e){return sr(xn(n,e))}(c,r),e)},function(n){return mr(function(e,n,t){var r=xn(e,n).map(function(n){return!0===n?t(e):n});return sr(r)}(c,r,n),e)},function(n){var e=n(c),t=pr(Bt(c,r,v({})),function(n){return yt(e,n)});return mr(t,i)})},function(n,e){var t=e(c);return sr(wn(n,a(t)))})}function Nt(r){return{extract:function(e,n,t){return gr(r(t,n),function(n){return function(n,e){return At(n,function(){return e})}(e,n)})},toString:function(){return"val"},toDsl:function(){return br.itemOf(r)}}}function jt(n){var i=Sr(n),u=I(n,function(e,n){return n.fold(function(n){return yt(e,On(n,!0))},v(e))},{});return{extract:function(n,e,t){var r=he(t)?[]:function(e){var n=An(e);return M(n,function(n){return Cn(e,n)})}(t),o=M(r,function(n){return!Cn(u,n)});return 0===o.length?i.extract(n,e,t):function(n,e){return At(n,function(){return"There are unsupported fields: ["+e.join(", ")+"] specified"})}(n,o)},toString:i.toString,toDsl:i.toDsl}}function _t(t,i){function u(n,e){return function(o){return{extract:function(t,r,n){var e=Se(n,function(n,e){return o.extract(t.concat(["["+e+"]"]),r,n)});return yr(e)},toString:function(){return"array("+o.toString()+")"},toDsl:function(){return br.arrOf(o)}}}(Nt(t)).extract(n,y,e)}return{extract:function(t,r,o){var n=An(o),e=u(t,n);return mr(e,function(n){var e=Se(n,function(n){return wr.field(n,n,wt(),i)});return Sr(e).extract(t,r,o)})},toString:function(){return"setOf("+i.toString()+")"},toDsl:function(){return br.setOf(t,i)}}}function Ht(e,t,r,n,o){return Et(n,o).fold(function(){return function(n,e,t){return At(n,function(){return'The chosen schema: "'+t+'" did not exist in branches: '+Rt(e)})}(e,n,o)},function(n){return n.extract(e.concat(["branch: "+o]),t,r)})}function Pt(n,o){return{extract:function(e,t,r){return Et(r,n).fold(function(){return function(n,e){return At(n,function(){return'Choice schema did not contain choice key: "'+e+'"'})}(e,n)},function(n){return Ht(e,t,r,o,n)})},toString:function(){return"chooseOn("+n+"). Possible values: "+An(o)},toDsl:function(){return br.choiceOf(n,o)}}}function zt(e){return Nt(function(n){return e(n).fold(dr,sr)})}function Lt(e,n){return _t(function(n){return ar(e(n))},n)}function Gt(n,e,t){return fr(function(n,e,t,r){var o=e.extract([n],t,r);return hr(o,function(n){return{input:r,errors:n}})}(n,e,y,t))}function Ut(n){return n.fold(function(n){throw new Error(Cr(n))},y)}function $t(n,e,t){return Ut(Gt(n,e,t))}function Wt(n,e){return Pt(n,w(e,Sr))}function Xt(n){return kr(n,n,wt(),Tr())}function qt(n,e){return kr(n,n,wt(),e)}function Yt(n,e){return kr(n,n,wt(),Sr(e))}function Kt(n){return kr(n,n,St(),Tr())}function Jt(n,e){return kr(n,n,St(),e)}function Qt(n,e){return Jt(n,Sr(e))}function Zt(n,e){return Jt(n,jt(e))}function nr(n,e){return kr(n,n,yn(e),Tr())}function er(n,e,t){return kr(n,n,yn(e),t)}function tr(n,e){return Or(n,e)}function rr(n,e){return on(n.element(),e.event().target())}function or(n){if(!Cn(n,"can")&&!Cn(n,"abort")&&!Cn(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return $t("Extracting event.handler",jt([nr("can",v(!0)),nr("abort",v(!1)),nr("run",x)]),n)}function ir(t){var n=function(e,r){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return R(e,function(n,e){return n&&r(e).apply(undefined,t)},!0)}}(t,function(n){return n.can}),e=function(e,r){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return R(e,function(n,e){return n||r(e).apply(undefined,t)},!1)}}(t,function(n){return n.abort});return or({can:n,abort:e,run:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];D(t,function(n){n.run.apply(undefined,e)})}})}var ur,cr,ar=function(n){return n.fold(Mt,Dt)},fr=function(n){return Ct(n,pt.error,pt.value)},sr=Dt,lr=function(n){var e=[],t=[];return D(n,function(n){Ct(n,function(n){return t.push(n)},function(n){return e.push(n)})}),{values:e,errors:t}},dr=Mt,mr=function(n,e){return n.stype===Dn.Value?e(n.svalue):n},gr=function(n,e){return n.stype===Dn.Error?e(n.serror):n},pr=function(n,e){return n.stype===Dn.Value?{stype:Dn.Value,svalue:e(n.svalue)}:n},hr=function(n,e){return n.stype===Dn.Error?{stype:Dn.Error,serror:e(n.serror)}:n},vr=function(n,e){var t=lr(n);return 0<t.errors.length?It(t.errors):function(n,e){return 0<n.length?sr(yt(e,bt.apply(undefined,n))):sr(e)}(t.values,e)},yr=function(n){var e=lr(n);return 0<e.errors.length?It(e.errors):sr(e.values)},br=ht([{setOf:["validator","valueType"]},{arrOf:["valueType"]},{objOf:["fields"]},{itemOf:["validator"]},{choiceOf:["key","branches"]},{thunk:["description"]},{func:["args","outputSchema"]}]),xr=ht([{field:["name","presence","type"]},{state:["name"]}]),wr=ht([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Sr=function(r){return{extract:function(n,e,t){return function(e,t,n,r){var o=Se(n,function(n){return Vt(e,t,n,r)});return vr(o,{})}(n,t,r,e)},toString:function(){return"obj{\n"+Se(r,function(n){return n.fold(function(n,e,t,r){return n+" -> "+r.toString()},function(n,e){return"state("+n+")"})}).join("\n")+"}"},toDsl:function(){return br.objOf(Se(r,function(n){return n.fold(function(n,e,t,r){return xr.field(n,t,r)},function(n,e){return xr.state(n)})}))}}},Tr=v(Nt(sr)),Or=wr.state,kr=wr.field,Er=Nt(sr),Cr=function(n){return"Errors: \n"+function(n){var e=10<n.length?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n;return Se(e,function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()})}(n.errors)+"\n\nInput object: "+Rt(n.input)},Dr=v(Er),Mr=(ur=ve,cr="function",Nt(function(n){var e=typeof n;return ur(n)?sr(n):dr("Expected type: "+cr+" but got: "+e)}));function Ir(n,e,t,r,o){return n(t,r)?Rn.some(t):ve(o)&&o(t)?Rn.none():e(t,r,o)}function Rr(n,e,t){for(var r=n.dom(),o=ve(t)?t:v(!1);r.parentNode;){r=r.parentNode;var i=Ye.fromDom(r);if(e(i))return Rn.some(i);if(o(i))break}return Rn.none()}function Ar(n,e,t){return Ir(function(n,e){return e(n)},Rr,n,e,t)}function Fr(n,o){var i=function(n){for(var e=0;e<n.childNodes.length;e++){var t=Ye.fromDom(n.childNodes[e]);if(o(t))return Rn.some(t);var r=i(n.childNodes[e]);if(r.isSome())return r}return Rn.none()};return i(n.dom())}function Br(n){return kn(n)}function Vr(n,e){return{key:n,value:or({abort:e})}}function Nr(n,e){return{key:n,value:or({run:e})}}function jr(n,e,t){return{key:n,value:or({run:function(n){e.apply(undefined,[n].concat(t))}})}}function _r(n){return function(t){return{key:n,value:or({run:function(n,e){rr(n,e)&&t(n,e)}})}}}function Hr(n,e,t){return function(t,r){return Nr(t,function(n,e){n.getSystem().getByUid(r).each(function(n){!function(n,e,t,r){n.getSystem().triggerEvent(t,e,r.event())}(n,n.element(),t,e)})})}(n,e.partUids[t])}function Pr(n){return Nr(n,function(n,e){e.cut()})}function zr(n,e){var t=n.toString(),r=t.indexOf(")")+1,o=t.indexOf("("),i=t.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:e,parameters:Do(i)}},n}function Lr(n){return{classes:n.classes!==undefined?n.classes:[],attributes:n.attributes!==undefined?n.attributes:{},styles:n.styles!==undefined?n.styles:{}}}function Gr(t,r,o){return Eo(function(n,e){o(n,t,r)})}function Ur(o,i,u){return function(n,e,t){var r=t.toString(),o=r.indexOf(")")+1,i=r.indexOf("("),u=r.substring(i+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:e,parameters:Do(u.slice(0,1).concat(u.slice(3)))}},n}(function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];var r=[t].concat(n);return t.config({name:v(o)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+o+". Using API: "+u)},function(n){var e=Array.prototype.slice.call(r,1);return i.apply(undefined,[t,n.config,n.state].concat(e))})},u,i)}function $r(n){return{key:n,value:undefined}}function Wr(n){var e=$t("Creating behaviour: "+n.name,Fo,n);return function(n,e,t,r,o,i){var u=jt(n),c=Qt(e,[Zt("config",n)]);return Mo(u,c,e,t,r,o,i)}(e.fields,e.name,e.active,e.apis,e.extra,e.state)}function Xr(n,e,t){if(!(me(t)||he(t)||ye(t)))throw d.console.error("Invalid call to Attr.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")}function qr(n,e,t){Xr(n.dom(),e,t)}function Yr(n,e){var t=n.dom();Bn(e,function(n,e){Xr(t,e,n)})}function Kr(n,e){var t=n.dom().getAttribute(e);return null===t?undefined:t}function Jr(n,e){var t=n.dom();return!(!t||!t.hasAttribute)&&t.hasAttribute(e)}function Qr(n,e){n.dom().removeAttribute(e)}function Zr(n,e){var t=Kr(n,e);return t===undefined||""===t?[]:t.split(" ")}function no(n){return n.dom().classList!==undefined}function eo(n,e){return function(n,e,t){var r=Zr(n,e).concat([t]);return qr(n,e,r.join(" ")),!0}(n,"class",e)}function to(n,e){return function(n,e,t){var r=M(Zr(n,e),function(n){return n!==t});return 0<r.length?qr(n,e,r.join(" ")):Qr(n,e),!1}(n,"class",e)}function ro(n,e){no(n)?n.dom().classList.add(e):eo(n,e)}function oo(n){0===(no(n)?n.dom().classList:function(n){return Zr(n,"class")}(n)).length&&Qr(n,"class")}function io(n,e){no(n)?n.dom().classList.remove(e):to(n,e),oo(n)}function uo(n,e){return no(n)&&n.dom().classList.contains(e)}function co(n,e,t){io(n,t),ro(n,e)}function ao(n){n.dom().focus()}function fo(n){n.dom().blur()}function so(n){var e=n!==undefined?n.dom():d.document;return Rn.from(e.activeElement).map(Ye.fromDom)}function lo(e){return so(un(e)).filter(function(n){return e.dom().contains(n.dom())})}function mo(n){return n.dom().innerHTML}function go(n,e){var t=un(n).dom(),r=Ye.fromDom(t.createDocumentFragment()),o=function(n,e){var t=(e||d.document).createElement("div");return t.innerHTML=n,ut(Ye.fromDom(t))}(e,t);dn(r,o),mn(n),ct(n,r)}function po(n){return function(n,e){return Ye.fromDom(n.dom().cloneNode(e))}(n,!1)}function ho(n){return function(n){var e=Ye.fromTag("div"),t=Ye.fromDom(n.dom().cloneNode(!0));return ct(e,t),mo(e)}(po(n))}function vo(n){return ho(n)}function yo(n){for(var e=[],t=function(n){e.push(n)},r=0;r<n.length;r++)n[r].each(t);return e}function bo(n,e){for(var t=0;t<n.length;t++){var r=e(n[t],t);if(r.isSome())return r}return Rn.none()}var xo,wo,So,To=function(n,e,t){return Ar(n,function(n){return e(n).isSome()},t).bind(e)},Oo=_r(Le()),ko=_r(Ge()),Eo=_r(ze()),Co=(xo=Ne(),function(n){return Nr(xo,n)}),Do=function(n){return Se(n,function(n){return function(n,e){return function(n,e,t){return""===e||!(n.length<e.length)&&n.substr(t,t+e.length)===e}(n,e,n.length-e.length)}(n,"/*")?n.substring(0,n.length-"/*".length):n})},Mo=function(t,n,r,o,e,i,u){function c(n){return Cn(n,r)?n[r]():Rn.none()}var a=w(e,function(n,e){return Ur(r,n,e)}),f=w(i,function(n,e){return zr(n,e)}),s=b(b(b({},f),a),{revoke:l($r,r),config:function(n){var e=$t(r+"-config",t,n);return{key:r,value:{config:e,me:s,configAsRaw:h(function(){return $t(r+"-config",t,n)}),initialConfig:n,state:u}}},schema:function(){return n},exhibit:function(n,t){return c(n).bind(function(e){return Et(o,"exhibit").map(function(n){return n(t,e.config,e.state)})}).getOr(Lr({}))},name:function(){return r},handlers:function(n){return c(n).map(function(n){return Tn("events",function(n,e){return{}})(o)(n.config,n.state)}).getOr({})}});return s},Io={init:function(){return Ro({readState:function(){return"No State required"}})}},Ro=function(n){return n},Ao=function(n){return kn(n)},Fo=jt([Xt("fields"),Xt("name"),nr("active",{}),nr("apis",{}),nr("state",Io),nr("extra",{})]),Bo=jt([Xt("branchKey"),Xt("branches"),Xt("name"),nr("active",{}),nr("apis",{}),nr("state",Io),nr("extra",{})]),Vo=v(undefined),No=/* */Object.freeze({toAlpha:function(n,e,t){co(n.element(),e.alpha,e.omega)},toOmega:function(n,e,t){co(n.element(),e.omega,e.alpha)},isAlpha:function(n,e,t){return uo(n.element(),e.alpha)},isOmega:function(n,e,t){return uo(n.element(),e.omega)},clear:function(n,e,t){io(n.element(),e.alpha),io(n.element(),e.omega)}}),jo=[Xt("alpha"),Xt("omega")],_o=Wr({fields:jo,name:"swapping",apis:No}),Ho=function(n){function e(){return t}var t=n;return{get:e,set:function(n){t=n},clone:function(){return Ho(e())}}},Po=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),zo=tinymce.util.Tools.resolve("tinymce.ThemeManager"),Lo=function(n){var e=d.document.createElement("a");e.target="_blank",e.href=n.href,e.rel="noreferrer noopener";var t=d.document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,d.window,0,0,0,0,0,!1,!1,!1,!1,0,null),d.document.body.appendChild(e),e.dispatchEvent(t),d.document.body.removeChild(e)},Go={formatChanged:v("formatChanged"),orientationChanged:v("orientationChanged"),dropupDismissed:v("dropupDismissed")},Uo=/* */Object.freeze({events:function(e){return Br([Nr(Ve(),function(o,i){var u=e.channels,n=function(n,e){return e.universal()?n:M(n,function(n){return E(e.channels(),n)})}(An(u),i);D(n,function(n){var e=u[n],t=e.schema,r=$t("channel["+n+"] data\nReceiver: "+vo(o.element()),t,i.data());e.onReceive(o,r)})})])}}),$o="unknown";(So=wo=wo||{})[So.STOP=0]="STOP",So[So.NORMAL=1]="NORMAL",So[So.LOGGING=2]="LOGGING";function Wo(e,n,t){switch(Et(hi.get(),e).orThunk(function(){var n=An(hi.get());return bo(n,function(n){return-1<e.indexOf(n)?Rn.some(hi.get()[n]):Rn.none()})}).getOr(wo.NORMAL)){case wo.NORMAL:return t(yi());case wo.LOGGING:var r=function(e,t){var r=[],o=(new Date).getTime();return{logEventCut:function(n,e,t){r.push({outcome:"cut",target:e,purpose:t})},logEventStopped:function(n,e,t){r.push({outcome:"stopped",target:e,purpose:t})},logNoParent:function(n,e,t){r.push({outcome:"no-parent",target:e,purpose:t})},logEventNoHandlers:function(n,e){r.push({outcome:"no-handlers-left",target:e})},logEventResponse:function(n,e,t){r.push({outcome:"response",purpose:t,target:e})},write:function(){var n=(new Date).getTime();E(["mousemove","mouseover","mouseout",ze()],e)||d.console.log(e,{event:e,time:n-o,target:t.dom(),sequence:Se(r,function(n){return E(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+vo(n.target)+")":n.outcome})})}}}(e,n),o=t(r);return r.write(),o;case wo.STOP:return!0}}function Xo(n,e,t){return Wo(n,e,t)}function qo(n,e,t){return function(){var n=new Error;if(n.stack===undefined)return;var e=n.stack.split("\n");A(e,function(e){return 0<e.indexOf("alloy")&&!C(vi,function(n){return-1<e.indexOf(n)})}).getOr($o)}(),kr(e,e,t,zt(function(t){return pt.value(function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(undefined,n)})}))}function Yo(n){return qo(0,n,yn(x))}function Ko(n){return qo(0,n,yn(Rn.none))}function Jo(n){return qo(0,n,wt())}function Qo(n){return qo(0,n,wt())}function Zo(n,e){return tr(n,v(e))}function ni(n){return tr(n,y)}function ei(n,e,t){var r=e.aria;r.update(n,r,t.get())}function ti(e,n,t){n.toggleClass.each(function(n){t.get()?ro(e.element(),n):io(e.element(),n)})}function ri(n,e,t){Ei(n,e,t,!t.get())}function oi(n,e,t){t.set(!0),ti(n,e,t),ei(n,e,t)}function ii(n,e,t){t.set(!1),ti(n,e,t),ei(n,e,t)}function ui(n,e,t){Ei(n,e,t,e.selected)}function ci(n,e){e.ignore||(ao(n.element()),e.onFocus(n))}function ai(n){return n.style!==undefined&&ve(n.style.getPropertyValue)}function fi(n,e,t){if(!me(t))throw d.console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);ai(n)&&n.style.setProperty(e,t)}function si(n,e){var t=n.dom();Bn(e,function(n,e){fi(t,e,n)})}function li(n,e){var t=n.dom(),r=d.window.getComputedStyle(t).getPropertyValue(e),o=""!==r||q(n)?r:Li(t,e);return null===o?undefined:o}function di(n,e){var t=n.dom(),r=Li(t,e);return Rn.from(r).filter(function(n){return 0<n.length})}function mi(n,e){!function(n,e){ai(n)&&n.style.removeProperty(e)}(n.dom(),e),Jr(n,"style")&&""===function(n){return n.replace(/^\s+|\s+$/g,"")}(Kr(n,"style"))&&Qr(n,"style")}function gi(n){return n.dom().offsetWidth}var pi,hi=Ho({}),vi=["alloy/data/Fields","alloy/debugging/Debugging"],yi=v({logEventCut:x,logEventStopped:x,logNoParent:x,logEventNoHandlers:x,logEventResponse:x,write:x}),bi=v([Xt("menu"),Xt("selectedMenu")]),xi=v([Xt("item"),Xt("selectedItem")]),wi=(v(Sr(xi().concat(bi()))),v(Sr(xi()))),Si=Yt("initSize",[Xt("numColumns"),Xt("numRows")]),Ti=v(Si),Oi=[qt("channels",Lt(pt.value,jt([Jo("onReceive"),nr("schema",Dr())])))],ki=Wr({fields:Oi,name:"receiving",active:Uo}),Ei=function(n,e,t,r){(r?oi:ii)(n,e,t)},Ci=/* */Object.freeze({onLoad:ui,toggle:ri,isOn:function(n,e,t){return t.get()},on:oi,off:ii,set:Ei}),Di=/* */Object.freeze({exhibit:function(n,e,t){return Lr({})},events:function(n,e){var t=function(e,t,r){return Co(function(n){r(n,e,t)})}(n,e,ri),r=Gr(n,e,ui);return Br(B([n.toggleOnExecute?[t]:[],[r]]))}}),Mi=function(n,e,t){qr(n.element(),"aria-expanded",t)},Ii=[nr("selected",!1),Kt("toggleClass"),nr("toggleOnExecute",!0),er("aria",{mode:"none"},Wt("mode",{pressed:[nr("syncWithExpanded",!1),Zo("update",function(n,e,t){qr(n.element(),"aria-pressed",t),e.syncWithExpanded&&Mi(n,e,t)})],checked:[Zo("update",function(n,e,t){qr(n.element(),"aria-checked",t)})],expanded:[Zo("update",Mi)],selected:[Zo("update",function(n,e,t){qr(n.element(),"aria-selected",t)})],none:[Zo("update",x)]}))],Ri=Wr({fields:Ii,name:"toggling",active:Di,apis:Ci,state:(pi=!1,{init:function(){var e=Ho(pi);return{get:function(){return e.get()},set:function(n){return e.set(n)},clear:function(){return e.set(pi)},readState:function(){return e.get()}}}})}),Ai=function(t,r){return ki.config({channels:On(Go.formatChanged(),{onReceive:function(n,e){e.command===t&&r(n,e.state)}})})},Fi=function(n){return ki.config({channels:On(Go.orientationChanged(),{onReceive:n})})},Bi=function(n,e){return{key:n,value:{onReceive:e}}},Vi="tinymce-mobile",Ni={resolve:function(n){return Vi+"-"+n},prefix:v(Vi)},ji=/* */Object.freeze({focus:ci,blur:function(n,e){e.ignore||fo(n.element())},isFocused:function(n){return function(n){var e=un(n).dom();return n.dom()===e.activeElement}(n.element())}}),_i=/* */Object.freeze({exhibit:function(n,e){var t=e.ignore?{}:{attributes:{tabindex:"-1"}};return Lr(t)},events:function(t){return Br([Nr(Ae(),function(n,e){ci(n,t),e.stop()})].concat(t.stopMousedown?[Nr(Pn(),function(n,e){e.event().prevent()})]:[]))}}),Hi=[Yo("onFocus"),nr("stopMousedown",!1),nr("ignore",!1)],Pi=Wr({fields:Hi,name:"focusing",active:_i,apis:ji}),zi=function(n,e,t){var r=n.dom();fi(r,e,t)},Li=function(n,e){return ai(n)?n.style.getPropertyValue(e):""};function Gi(r,o){function n(n){var e=o(n);if(e<=0||null===e){var t=li(n,r);return parseFloat(t)||0}return e}function i(o,n){return R(n,function(n,e){var t=li(o,e),r=t===undefined?0:parseInt(t,10);return isNaN(r)?n:n+r},0)}return{set:function(n,e){if(!ye(e)&&!e.match(/^[0-9]+$/))throw new Error(r+".set accepts only positive integer values. Value was "+e);var t=n.dom();ai(t)&&(t.style[r]=e+"px")},get:n,getOuter:n,aggregate:i,max:function(n,e,t){var r=i(n,t);return r<e?e-r:0}}}function Ui(n){return hu.get(n)}function $i(n,e,t){return M(function(n,e){for(var t=ve(e)?e:c,r=n.dom(),o=[];null!==r.parentNode&&r.parentNode!==undefined;){var i=r.parentNode,u=Ye.fromDom(i);if(o.push(u),!0===t(u))break;r=i}return o}(n,t),e)}function Wi(n,e){return M(function(e){return cn(e).map(ut).map(function(n){return M(n,function(n){return!on(e,n)})}).getOr([])}(n),e)}function Xi(n,e){return tn(e,n)}function qi(n){return rn(n)}function Yi(n,e,t){return Rr(n,function(n){return nn(n,e)},t)}function Ki(n,e){return rn(e,n)}function Ji(n,e,t){return Ir(nn,Yi,n,e,t)}function Qi(n,e,t){var r=j(n.slice(0,e)),o=j(n.slice(e+1));return A(r.concat(o),t)}function Zi(n,e,t){var r=j(n.slice(0,e));return A(r,t)}function nu(n,e,t){var r=n.slice(0,e),o=n.slice(e+1);return A(o.concat(r),t)}function eu(n,e,t){var r=n.slice(e+1);return A(r,t)}function tu(t){return function(n){var e=n.raw();return E(t,e.which)}}function ru(n){return function(e){return N(n,function(n){return n(e)})}}function ou(n){return!0===n.raw().shiftKey}function iu(n){return!0===n.raw().ctrlKey}function uu(n,e){return{matches:n,classification:e}}function cu(n,e,t,r){var o=n+e;return r<o?t:o<t?r:o}function au(n,e,t){return n<=e?e:t<=n?t:n}function fu(t,r,n,o){var e=Xi(t.element(),"."+r.highlightClass);D(e,function(e){C(o,function(n){return n.element()===e})||(io(e,r.highlightClass),t.getSystem().getByDom(e).each(function(n){r.onDehighlight(t,n),L(n,We())}))})}function su(n,e,t,r){fu(n,e,0,[r]),yu(n,e,t,r)||(ro(r.element(),e.highlightClass),e.onHighlight(n,r),L(r,$e()))}function lu(t,e,n,r){var o=Xi(t.element(),"."+e.itemClass);return F(o,function(n){return uo(n,e.highlightClass)}).bind(function(n){var e=cu(n,r,0,o.length-1);return t.getSystem().getByDom(o[e]).toOption()})}function du(n,e,t){e.exists(function(e){return t.exists(function(n){return on(n,e)})})||G(n,Ue(),{prevFocus:e,newFocus:t})}function mu(){function o(n){return lo(n.element())}return{get:o,set:function(n,e){var t=o(n);n.getSystem().triggerFocus(e,n.element());var r=o(n);du(n,t,r)}}}var gu,pu,hu=Gi("height",function(n){var e=n.dom();return q(n)?e.getBoundingClientRect().height:e.offsetHeight}),vu=m(ou),yu=function(n,e,t,r){return uo(r.element(),e.highlightClass)},bu=function(n,e,t,r){var o=Xi(n.element(),"."+e.itemClass);return Rn.from(o[r]).fold(function(){return pt.error("No element found with index "+r)},n.getSystem().getByDom)},xu=function(e,n,t){return Ki(e.element(),"."+n.itemClass).bind(function(n){return e.getSystem().getByDom(n).toOption()})},wu=function(e,n,t){var r=Xi(e.element(),"."+n.itemClass);return(0<r.length?Rn.some(r[r.length-1]):Rn.none()).bind(function(n){return e.getSystem().getByDom(n).toOption()})},Su=function(e,n,t){var r=Xi(e.element(),"."+n.itemClass);return yo(Se(r,function(n){return e.getSystem().getByDom(n).toOption()}))},Tu=/* */Object.freeze({dehighlightAll:function(n,e,t){return fu(n,e,0,[])},dehighlight:function(n,e,t,r){yu(n,e,t,r)&&(io(r.element(),e.highlightClass),e.onDehighlight(n,r),L(r,We()))},highlight:su,highlightFirst:function(e,t,r){xu(e,t).each(function(n){su(e,t,r,n)})},highlightLast:function(e,t,r){wu(e,t).each(function(n){su(e,t,r,n)})},highlightAt:function(e,t,r,n){bu(e,t,r,n).fold(function(n){throw new Error(n)},function(n){su(e,t,r,n)})},highlightBy:function(e,t,r,n){var o=Su(e,t);A(o,n).each(function(n){su(e,t,r,n)})},isHighlighted:yu,getHighlighted:function(e,n,t){return Ki(e.element(),"."+n.highlightClass).bind(function(n){return e.getSystem().getByDom(n).toOption()})},getFirst:xu,getLast:wu,getPrevious:function(n,e,t){return lu(n,e,0,-1)},getNext:function(n,e,t){return lu(n,e,0,1)},getCandidates:Su}),Ou=[Xt("highlightClass"),Xt("itemClass"),Yo("onHighlight"),Yo("onDehighlight")],ku=Wr({fields:Ou,name:"highlighting",apis:Tu});(pu=gu=gu||{}).OnFocusMode="onFocus",pu.OnEnterOrSpaceMode="onEnterOrSpace",pu.OnApiMode="onApi";function Eu(n,e,t,i,u){function c(e,t,n,r,o){return function(n,e){return A(n,function(n){return n.matches(e)}).map(function(n){return n.classification})}(n(e,t,r,o),t.event()).bind(function(n){return n(e,t,r,o)})}var r={schema:function(){return n.concat([nr("focusManager",mu()),er("focusInside","onFocus",zt(function(n){return E(["onFocus","onEnterOrSpace","onApi"],n)?pt.value(n):pt.error("Invalid value for focusInside")})),Zo("handler",r),Zo("state",e),Zo("sendFocusIn",u)])},processKey:c,toEvents:function(r,o){var n=r.focusInside!==gu.OnFocusMode?Rn.none():u(r).map(function(t){return Nr(Ae(),function(n,e){t(n,r,o),e.stop()})});return Br(n.toArray().concat([Nr(Un(),function(n,e){c(n,e,t,r,o).fold(function(){!function(e,t){var n=tu([32].concat([13]))(t.event());r.focusInside===gu.OnEnterOrSpaceMode&&n&&rr(e,t)&&u(r).each(function(n){n(e,r,o),t.stop()})}(n,e)},function(n){e.stop()})}),Nr($n(),function(n,e){c(n,e,i,r,o).each(function(n){e.stop()})})]))}};return r}function Cu(n){function i(n,e){var t=n.visibilitySelector.bind(function(n){return Ji(e,n)}).getOr(e);return 0<Ui(t)}function e(e,t){(function(n,e){var t=Xi(n.element(),e.selector),r=M(t,function(n){return i(e,n)});return Rn.from(r[e.firstTabstop])})(e,t).each(function(n){t.focusManager.set(e,n)})}function u(e,n,t,r,o){return o(n,t,function(n){return function(n,e){return i(n,e)&&n.useTabstopAt(e)}(r,n)}).fold(function(){return r.cyclic?Rn.some(!0):Rn.none()},function(n){return r.focusManager.set(e,n),Rn.some(!0)})}function c(e,n,t,r){var o=Xi(e.element(),t.selector);return function(n,e){return e.focusManager.get(n).bind(function(n){return Ji(n,e.selector)})}(e,t).bind(function(n){return F(o,l(on,n)).bind(function(n){return u(e,o,n,t,r)})})}var t=[Kt("onEscape"),Kt("onEnter"),nr("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),nr("firstTabstop",0),nr("useTabstopAt",v(!0)),Kt("visibilitySelector")].concat([n]),r=v([uu(ru([ou,tu([9])]),function(n,e,t,r){var o=t.cyclic?Qi:Zi;return c(n,0,t,o)}),uu(tu([9]),function(n,e,t,r){var o=t.cyclic?nu:eu;return c(n,0,t,o)}),uu(tu([27]),function(e,t,n,r){return n.onEscape.bind(function(n){return n(e,t)})}),uu(ru([vu,tu([13])]),function(e,t,n,r){return n.onEnter.bind(function(n){return n(e,t)})})]),o=v([]);return Eu(t,Io.init,r,o,function(){return Rn.some(e)})}function Du(n){return"input"===W(n)&&"radio"!==Kr(n,"type")||"textarea"===W(n)}function Mu(n,e,t){return Du(t)&&tu([32])(e.event())?Rn.none():function(n,e,t){return $(n,t,Ne()),Rn.some(!0)}(n,0,t)}function Iu(n,e){return Rn.some(!0)}function Ru(n,e,t){return t.execute(n,e,n.element())}function Au(n){var t=Ho(Rn.none());return Ro({readState:function(){return t.get().map(function(n){return{numRows:n.numRows(),numColumns:n.numColumns()}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set(Rn.some({numRows:v(n),numColumns:v(e)}))},getNumRows:function(){return t.get().map(function(n){return n.numRows()})},getNumColumns:function(){return t.get().map(function(n){return n.numColumns()})}})}function Fu(e,t){return function(n){return"rtl"===Xc(n)?t:e}}function Bu(i){return function(n,e,t,r){var o=i(n.element());return qc(o,n,e,t,r)}}function Vu(n,e){var t=Fu(n,e);return Bu(t)}function Nu(n,e){var t=Fu(e,n);return Bu(t)}function ju(o){return function(n,e,t,r){return qc(o,n,e,t,r)}}function _u(n){return!function(n){return n.offsetWidth<=0&&n.offsetHeight<=0}(n.dom())}function Hu(n,e,t){var r=l(on,e),o=Xi(n,t);return function(e,n){return F(e,n).map(function(n){return Qc({index:n,candidates:e})})}(M(o,_u),r)}function Pu(n,e){return F(n,function(n){return on(e,n)})}function zu(t,n,r,e){return e(Math.floor(n/r),n%r).bind(function(n){var e=n.row()*r+n.column();return 0<=e&&e<t.length?Rn.some(t[e]):Rn.none()})}function Lu(o,n,i,u,c){return zu(o,n,u,function(n,e){var t=n===i-1?o.length-n*u:u,r=cu(e,c,0,t-1);return Rn.some({row:v(n),column:v(r)})})}function Gu(i,n,u,c,a){return zu(i,n,c,function(n,e){var t=cu(n,a,0,u-1),r=t===u-1?i.length-t*c:c,o=au(e,0,r-1);return Rn.some({row:v(t),column:v(o)})})}function Uu(e,t,n){Ki(e.element(),t.selector).each(function(n){t.focusManager.set(e,n)})}function $u(o){return function(n,e,t,r){return Hu(n,e,t.selector).bind(function(n){return o(n.candidates(),n.index(),r.getNumRows().getOr(t.initSize.numRows),r.getNumColumns().getOr(t.initSize.numColumns))})}}function Wu(n,e,t,r){return t.captureTab?Rn.some(!0):Rn.none()}function Xu(n,e,t,o){var i=function(n,e,t){var r=cu(e,o,0,t.length-1);return r===n?Rn.none():function(n){return"button"===W(n)&&"disabled"===Kr(n,"disabled")}(t[r])?i(n,r,t):Rn.from(t[r])};return Hu(n,t,e).bind(function(n){var e=n.index(),t=n.candidates();return i(e,e,t)})}function qu(e,t,r){return function(n,e){return e.focusManager.get(n).bind(function(n){return Ji(n,e.selector)})}(e,r).bind(function(n){return r.execute(e,t,n)})}function Yu(e,t){t.getInitial(e).orThunk(function(){return Ki(e.element(),t.selector)}).each(function(n){t.focusManager.set(e,n)})}function Ku(n,e,t){return Xu(n,t.selector,e,-1)}function Ju(n,e,t){return Xu(n,t.selector,e,1)}function Qu(r){return function(n,e,t){return r(n,e,t).bind(function(){return t.executeOnMove?qu(n,e,t):Rn.some(!0)})}}function Zu(n,e,t,r){return t.onEscape(n,e)}function nc(n,e,t){return Rn.from(n[e]).bind(function(n){return Rn.from(n[t]).map(function(n){return sa({rowIndex:e,columnIndex:t,cell:n})})})}function ec(n,e,t,r){var o=n[e].length,i=cu(t,r,0,o-1);return nc(n,e,i)}function tc(n,e,t,r){var o=cu(t,r,0,n.length-1),i=n[o].length,u=au(e,0,i-1);return nc(n,o,u)}function rc(n,e,t,r){var o=n[e].length,i=au(t+r,0,o-1);return nc(n,e,i)}function oc(n,e,t,r){var o=au(t+r,0,n.length-1),i=n[o].length,u=au(e,0,i-1);return nc(n,o,u)}function ic(e,t){t.previousSelector(e).orThunk(function(){var n=t.selectors;return Ki(e.element(),n.cell)}).each(function(n){t.focusManager.set(e,n)})}function uc(n,e){return function(o,t,i){var u=i.cycles?n:e;return Ji(t,i.selectors.row).bind(function(n){var e=Xi(n,i.selectors.cell);return Pu(e,t).bind(function(t){var r=Xi(o,i.selectors.row);return Pu(r,n).bind(function(n){var e=function(n,e){return Se(n,function(n){return Xi(n,e.selectors.cell)})}(r,i);return u(e,n,t).map(function(n){return n.cell()})})})})}}function cc(e,t,r){return r.focusManager.get(e).bind(function(n){return r.execute(e,t,n)})}function ac(e,t){Ki(e.element(),t.selector).each(function(n){t.focusManager.set(e,n)})}function fc(n,e,t){return Xu(n,t.selector,e,-1)}function sc(n,e,t){return Xu(n,t.selector,e,1)}function lc(e,n){return function(n,e,t){return er(n,e,Sr(t))}(e,{},Se(n,function(n){return function(e,t){return kr(e,e,St(),Nt(function(n){return dr("The field: "+e+" is forbidden. "+t)}))}(n.name(),"Cannot configure "+n.name()+" for "+e)}).concat([tr("dump",y)]))}function dc(n){return n.dump}function mc(n,e){return b(b({},n.dump),Ao(e))}function gc(n,e,t,r){return t.uiType===Na?function(n,e,t,r){return n.exists(function(n){return n!==t.owner})?ja.single(!0,v(t)):Et(r,t.name).fold(function(){throw new Error("Unknown placeholder component: "+t.name+"\nKnown: ["+An(r)+"]\nNamespace: "+n.getOr("none")+"\nSpec: "+JSON.stringify(t,null,2))},function(n){return n.replace()})}(n,0,t,r):ja.single(!1,v(t))}function pc(e,t,n,r){var o=w(r,function(n,e){return function(n,e){var t=!1;return{name:v(n),required:function(){return e.fold(function(n,e){return n},function(n,e){return n})},used:function(){return t},replace:function(){if(!0===t)throw new Error("Trying to use the same placeholder more than once: "+n);return t=!0,e}}}(e,n)}),i=function(e,t,n,r){return V(n,function(n){return _a(e,t,n,r)})}(e,t,n,o);return Bn(o,function(n){if(!1===n.used()&&n.required())throw new Error("Placeholder: "+n.name()+" was not found in components list\nNamespace: "+e.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))}),i}function hc(n){var e=(new Date).getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++La+String(e)}function vc(n){function e(n){return n.name}return n.fold(e,e,e,e)}function yc(t,r){return function(n){var e=$t("Converting part type",r,n);return t(e)}}function bc(n,e,t,r){return yt(e.defaults(n,t,r),t,{uid:n.partUids[e.name]},e.overrides(n,t,r))}function xc(o,n){var e={};return D(n,function(n){(function(n){return n.fold(Rn.some,Rn.none,Rn.some,Rn.some)})(n).each(function(t){var r=of(o,t.pname);e[t.name]=function(n){var e=$t("Part: "+t.name+" in "+o,Sr(t.schema),n);return b(b({},r),{config:n,validated:e})}})}),e}function wc(n,e,t){return function(n,t,e){var i={},r={};return D(e,function(n){n.fold(function(r){i[r.pname]=Ha(!0,function(n,e,t){return r.factory.sketch(bc(n,r,e,t))})},function(n){var e=t.parts[n.name];r[n.name]=v(n.factory.sketch(bc(t,n,e[rf()]),e))},function(r){i[r.pname]=Ha(!1,function(n,e,t){return r.factory.sketch(bc(n,r,e,t))})},function(o){i[o.pname]=Pa(!0,function(e,n,t){var r=e[o.name];return Se(r,function(n){return o.factory.sketch(yt(o.defaults(e,n,t),n,o.overrides(e,n)))})})})}),{internals:v(i),externals:v(r)}}(0,e,t)}function Sc(n,e,t){return pc(Rn.some(n),e,e.components,t)}function Tc(n,e,t){var r=e.partUids[t];return n.getSystem().getByUid(r).toOption()}function Oc(n,e,t){return Tc(n,e,t).getOrDie("Could not find part: "+t)}function kc(e,n){var t=function(n){return Se(n,vc)}(n);return kn(Se(t,function(n){return{key:n,value:e+"-"+n}}))}function Ec(e){return kr("partUids","partUids",Ot(function(n){return kc(n.uid,e)}),Dr())}function Cc(n){return On(uf,n)}function Dc(r){return function(n,e){var t=e.toString(),r=t.indexOf(")")+1,o=t.indexOf("("),i=t.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:Do(i.slice(1))}},n}(function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return r.apply(undefined,[n.getApis()].concat([n].concat(e)))},r)}function Mc(n){return hc(n)}function Ic(n,e,t,r,o){var i=function(n,e){return(0<n.length?[Yt("parts",n)]:[]).concat([Xt("uid"),nr("dom",{}),nr("components",[]),ni("originalSpec"),nr("debug.sketcher",{})]).concat(e)}(r,o);return $t(n+" [SpecSchema]",jt(i.concat(e)),t)}function Rc(n,e,t,r,o){var i=mf(o),u=function(n){return V(n,function(n){return n.fold(Rn.none,Rn.some,Rn.none,Rn.none).map(function(n){return Yt(n.name,n.schema.concat([ni(rf())]))}).toArray()})}(t),c=Ec(t),a=Ic(n,e,i,u,[c]),f=wc(0,a,t);return r(a,Sc(n,a,f.internals()),i,f.externals())}var Ac,Fc,Bc,Vc,Nc,jc,_c,Hc,Pc,zc,Lc=Cu(tr("cyclic",v(!1))),Gc=Cu(tr("cyclic",v(!0))),Uc=[nr("execute",Mu),nr("useSpace",!1),nr("useEnter",!0),nr("useControlEnter",!1),nr("useDown",!1)],$c=Eu(Uc,Io.init,function(n,e,t,r){var o=t.useSpace&&!Du(n.element())?[32]:[],i=t.useEnter?[13]:[],u=t.useDown?[40]:[],c=o.concat(i).concat(u);return[uu(tu(c),Ru)].concat(t.useControlEnter?[uu(ru([iu,tu([13])]),Ru)]:[])},function(n,e,t,r){return t.useSpace&&!Du(n.element())?[uu(tu([32]),Iu)]:[]},function(){return Rn.none()}),Wc=/* */Object.freeze({flatgrid:Au,init:function(n){return n.state(n)}}),Xc=function(n){return"rtl"===li(n,"direction")?"rtl":"ltr"},qc=function(e,t,n,r,o){return r.focusManager.get(t).bind(function(n){return e(t.element(),n,r,o)}).map(function(n){return r.focusManager.set(t,n),!0})},Yc=ju,Kc=ju,Jc=ju,Qc=Q(["index","candidates"],[]),Zc=[Xt("selector"),nr("execute",Mu),Ko("onEscape"),nr("captureTab",!1),Ti()],na=$u(function(n,e,t,r){return Lu(n,e,t,r,-1)}),ea=$u(function(n,e,t,r){return Lu(n,e,t,r,1)}),ta=$u(function(n,e,t,r){return Gu(n,e,t,r,-1)}),ra=$u(function(n,e,t,r){return Gu(n,e,t,r,1)}),oa=v([uu(tu([37]),Vu(na,ea)),uu(tu([39]),Nu(na,ea)),uu(tu([38]),Yc(ta)),uu(tu([40]),Kc(ra)),uu(ru([ou,tu([9])]),Wu),uu(ru([vu,tu([9])]),Wu),uu(tu([27]),function(n,e,t,r){return t.onEscape(n,e)}),uu(tu([32].concat([13])),function(e,t,r,n){return function(n,e){return e.focusManager.get(n).bind(function(n){return Ji(n,e.selector)})}(e,r).bind(function(n){return r.execute(e,t,n)})})]),ia=v([uu(tu([32]),Iu)]),ua=Eu(Zc,Au,oa,ia,function(){return Rn.some(Uu)}),ca=[Xt("selector"),nr("getInitial",Rn.none),nr("execute",Mu),Ko("onEscape"),nr("executeOnMove",!1),nr("allowVertical",!0)],aa=v([uu(tu([32]),Iu)]),fa=Eu(ca,Io.init,function(n,e,t,r){var o=[37].concat(t.allowVertical?[38]:[]),i=[39].concat(t.allowVertical?[40]:[]);return[uu(tu(o),Qu(Vu(Ku,Ju))),uu(tu(i),Qu(Nu(Ku,Ju))),uu(tu([13]),qu),uu(tu([32]),qu),uu(tu([27]),Zu)]},aa,function(){return Rn.some(Yu)}),sa=Q(["rowIndex","columnIndex","cell"],[]),la=[Yt("selectors",[Xt("row"),Xt("cell")]),nr("cycles",!0),nr("previousSelector",Rn.none),nr("execute",Mu)],da=uc(function(n,e,t){return ec(n,e,t,-1)},function(n,e,t){return rc(n,e,t,-1)}),ma=uc(function(n,e,t){return ec(n,e,t,1)},function(n,e,t){return rc(n,e,t,1)}),ga=uc(function(n,e,t){return tc(n,t,e,-1)},function(n,e,t){return oc(n,t,e,-1)}),pa=uc(function(n,e,t){return tc(n,t,e,1)},function(n,e,t){return oc(n,t,e,1)}),ha=v([uu(tu([37]),Vu(da,ma)),uu(tu([39]),Nu(da,ma)),uu(tu([38]),Yc(ga)),uu(tu([40]),Kc(pa)),uu(tu([32].concat([13])),function(e,t,r){return lo(e.element()).bind(function(n){return r.execute(e,t,n)})})]),va=v([uu(tu([32]),Iu)]),ya=Eu(la,Io.init,ha,va,function(){return Rn.some(ic)}),ba=[Xt("selector"),nr("execute",Mu),nr("moveOnTab",!1)],xa=v([uu(tu([38]),Jc(fc)),uu(tu([40]),Jc(sc)),uu(ru([ou,tu([9])]),function(n,e,t){return t.moveOnTab?Jc(fc)(n,e,t):Rn.none()}),uu(ru([vu,tu([9])]),function(n,e,t){return t.moveOnTab?Jc(sc)(n,e,t):Rn.none()}),uu(tu([13]),cc),uu(tu([32]),cc)]),wa=v([uu(tu([32]),Iu)]),Sa=Eu(ba,Io.init,xa,wa,function(){return Rn.some(ac)}),Ta=[Ko("onSpace"),Ko("onEnter"),Ko("onShiftEnter"),Ko("onLeft"),Ko("onRight"),Ko("onTab"),Ko("onShiftTab"),Ko("onUp"),Ko("onDown"),Ko("onEscape"),nr("stopSpaceKeyup",!1),Kt("focusIn")],Oa=Eu(Ta,Io.init,function(n,e,t){return[uu(tu([32]),t.onSpace),uu(ru([vu,tu([13])]),t.onEnter),uu(ru([ou,tu([13])]),t.onShiftEnter),uu(ru([ou,tu([9])]),t.onShiftTab),uu(ru([vu,tu([9])]),t.onTab),uu(tu([38]),t.onUp),uu(tu([40]),t.onDown),uu(tu([37]),t.onLeft),uu(tu([39]),t.onRight),uu(tu([32]),t.onSpace),uu(tu([27]),t.onEscape)]},function(n,e,t){return t.stopSpaceKeyup?[uu(tu([32]),Iu)]:[]},function(n){return n.focusIn}),ka=Lc.schema(),Ea=Gc.schema(),Ca=fa.schema(),Da=ua.schema(),Ma=ya.schema(),Ia=$c.schema(),Ra=Sa.schema(),Aa=Oa.schema(),Fa=(zc=$t("Creating behaviour: "+(Pc={branchKey:"mode",branches:/* */Object.freeze({acyclic:ka,cyclic:Ea,flow:Ca,flatgrid:Da,matrix:Ma,execution:Ia,menu:Ra,special:Aa}),name:"keying",active:{events:function(n,e){return n.handler.toEvents(n,e)}},apis:{focusIn:function(e,t,r){t.sendFocusIn(t).fold(function(){e.getSystem().triggerFocus(e.element(),e.element())},function(n){n(e,t,r)})},setGridSize:function(n,e,t,r,o){Cn(t,"setGridSize")?t.setGridSize(r,o):d.console.error("Layout does not support setGridSize")}},state:Wc}).name,Bo,Pc),Ac=Wt(zc.branchKey,zc.branches),Fc=zc.name,Bc=zc.active,Vc=zc.apis,Nc=zc.extra,jc=zc.state,Hc=Qt(Fc,[Jt("config",_c=Ac)]),Mo(_c,Hc,Fc,Bc,Vc,Nc,jc)),Ba=lc,Va=mc,Na="placeholder",ja=ht([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),_a=function(i,u,c,a){return gc(i,0,c,a).fold(function(n,e){var t=e(u,c.config,c.validated),r=Et(t,"components").getOr([]),o=V(r,function(n){return _a(i,u,n,a)});return[b(b({},t),{components:o})]},function(n,e){var t=e(u,c.config,c.validated);return c.validated.preprocess.getOr(y)(t)})},Ha=ja.single,Pa=ja.multiple,za=v(Na),La=0,Ga=ht([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Ua=nr("factory",{sketch:y}),$a=nr("schema",[]),Wa=Xt("name"),Xa=kr("pname","pname",Tt(function(n){return"<alloy."+hc(n.name)+">"}),Dr()),qa=tr("schema",function(){return[Kt("preprocess")]}),Ya=nr("defaults",v({})),Ka=nr("overrides",v({})),Ja=Sr([Ua,$a,Wa,Xa,Ya,Ka]),Qa=Sr([Ua,$a,Wa,Xa,Ya,Ka]),Za=Sr([Ua,qa,Wa,Xt("unit"),Xa,Ya,Ka]),nf=yc(Ga.required,Ja),ef=yc(Ga.optional,Qa),tf=yc(Ga.group,Za),rf=v("entirety"),of=function(n,e){return{uiType:za(),owner:n,name:e}},uf=hc("alloy-premade"),cf=v("alloy-id-"),af=v("data-alloy-id"),ff=cf(),sf=af(),lf=function(n,e){Object.defineProperty(n.dom(),sf,{value:e,writable:!0})},df=function(n){var e=Ze(n)?n.dom()[sf]:null;return Rn.from(e)},mf=function(n){return n.hasOwnProperty("uid")?n:b(b({},n),{uid:Mc("uid")})};function gf(n){var e=$t("Sketcher for "+n.name,_s,n),t=w(e.apis,Dc),r=w(e.extraApis,function(n,e){return zr(n,e)});return b(b({name:v(e.name),partFields:v([]),configFields:v(e.configFields),sketch:function(n){return function(n,e,t,r){var o=mf(r);return t(Ic(n,e,o,[],[]),o)}(e.name,e.configFields,e.factory,n)}},t),r)}function pf(n){var e=$t("Sketcher for "+n.name,Hs,n),t=xc(e.name,e.partFields),r=w(e.apis,Dc),o=w(e.extraApis,function(n,e){return zr(n,e)});return b(b({name:v(e.name),partFields:v(e.partFields),configFields:v(e.configFields),sketch:function(n){return Rc(e.name,e.configFields,e.partFields,e.factory,n)},parts:v(t)},r),o)}function hf(n){var e=Ye.fromHtml(n),t=ut(e),r=function(n){var e=n.dom().attributes!==undefined?n.dom().attributes:[];return R(e,function(n,e){var t;return"class"===e.name?n:b(b({},n),((t={})[e.name]=e.value,t))},{})}(e),o=function(n){return Array.prototype.slice.call(n.dom().classList,0)}(e),i=0===t.length?{}:{innerHtml:mo(e)};return b({tag:W(e),classes:o,attributes:r},i)}function vf(n){return{dom:Ls(n)}}function yf(n){return Ao([Ri.config({toggleClass:Ni.resolve("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),Ai(n,function(n,e){(e?Ri.on:Ri.off)(n)})])}function bf(n,e){var t=e.ui.registry.getAll().icons;return Rn.from(t[n]).fold(function(){return Ls('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item ${prefix}-icon-'+n+' ${prefix}-icon"></span>')},function(n){return Ls('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item">'+n+"</span>")})}function xf(n){return ef({name:n+"-edge",overrides:function(r){return r.model.manager.edgeActions[n].fold(function(){return{}},function(t){var n=Br([jr(jn(),t,[r])]),e=Br([jr(Pn(),t,[r]),jr(zn(),function(n,e){e.mouseIsDown.get()&&t(n,e)},[r])]);return{events:$s?n:e}})}})}function wf(n,e,t){e.store.manager.onLoad(n,e,t)}function Sf(n,e,t){e.store.manager.onUnload(n,e,t)}function Tf(){var n=Ho(null);return Ro({set:n.set,get:n.get,isNotSet:function(){return null===n.get()},clear:function(){n.set(null)},readState:function(){return{mode:"memory",value:n.get()}}})}function Of(){var i=Ho({}),u=Ho({});return Ro({readState:function(){return{mode:"dataset",dataByValue:i.get(),dataByText:u.get()}},lookup:function(n){return Et(i.get(),n).orThunk(function(){return Et(u.get(),n)})},update:function(n){var e=i.get(),t=u.get(),r={},o={};D(n,function(e){r[e.value]=e,Et(e,"meta").each(function(n){Et(n,"text").each(function(n){o[n]=e})})}),i.set(b(b({},e),r)),u.set(b(b({},t),o))},clear:function(){i.set({}),u.set({})}})}function kf(n,e,t,r){var o=e.store;t.update([r]),o.setValue(n,r),e.onSetValue(n,r)}function Ef(n,e){fl.set(n,e)}function Cf(n){return fl.get(n)}function Df(n){var e=n.event().raw();if(dl){var t=e;return t.touches!==undefined&&1===t.touches.length?Rn.some(t.touches[0]).map(function(n){return ll(n.clientX,n.clientY)}):Rn.none()}var r=e;return r.clientX!==undefined?Rn.some(r).map(function(n){return ll(n.clientX,n.clientY)}):Rn.none()}function Mf(n){return n.model.minX}function If(n){return n.model.minY}function Rf(n){return n.model.minX-1}function Af(n){return n.model.minY-1}function Ff(n){return n.model.maxX}function Bf(n){return n.model.maxY}function Vf(n){return n.model.maxX+1}function Nf(n){return n.model.maxY+1}function jf(n,e,t){return e(n)-t(n)}function _f(n){return jf(n,Ff,Mf)}function Hf(n){return jf(n,Bf,If)}function Pf(n){return _f(n)/2}function zf(n){return Hf(n)/2}function Lf(n){return n.stepSize}function Gf(n){return n.snapToGrid}function Uf(n){return n.snapStart}function $f(n){return n.rounded}function Wf(n,e){return n[e+"-edge"]!==undefined}function Xf(n){return Wf(n,"left")}function qf(n){return Wf(n,"right")}function Yf(n){return Wf(n,"top")}function Kf(n){return Wf(n,"bottom")}function Jf(n){return n.model.value.get()}function Qf(n){return{x:v(n)}}function Zf(n){return{y:v(n)}}function ns(n,e){return{x:v(n),y:v(e)}}function es(n,e){G(n,ml(),{value:e})}function ts(n,e,t,r){return n<e?n:t<n?t:n===e?e-1:Math.max(e,n-r)}function rs(n,e,t,r){return t<n?n:n<e?e:n===t?t+1:Math.min(t,n+r)}function os(n,e,t){return Math.max(e,Math.min(t,n))}function is(n){var e=n.min,t=n.max,r=n.range,o=n.value,i=n.step,u=n.snap,c=n.snapStart,a=n.rounded,f=n.hasMinEdge,s=n.hasMaxEdge,l=n.minBound,d=n.maxBound,m=n.screenRange,g=f?e-1:e,p=s?t+1:t;if(o<l)return g;if(d<o)return p;var h=function(n,e,t){return Math.min(t,Math.max(n,e))-e}(o,l,d),v=os(h/m*r+e,g,p);return u&&e<=v&&v<=t?function(u,t,c,a,n){return n.fold(function(){var n=u-t,e=Math.round(n/a)*a;return os(t+e,t-1,c+1)},function(n){var e=(u-n)%a,t=Math.round(e/a),r=Math.floor((u-n)/a),o=Math.floor((c-n)/a),i=n+Math.min(o,r+t)*a;return Math.max(n,i)})}(v,e,t,i,c):a?Math.round(v):v}function us(n){var e=n.min,t=n.max,r=n.range,o=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,c=n.maxBound,a=n.maxOffset,f=n.centerMinEdge,s=n.centerMaxEdge;return o<e?i?0:f:t<o?u?c:s:(o-e)/r*a}function cs(n){return n.element().dom().getBoundingClientRect()}function as(n,e){return n[e]}function fs(n){var e=cs(n);return as(e,gl)}function ss(n){var e=cs(n);return as(e,"right")}function ls(n){var e=cs(n);return as(e,"top")}function ds(n){var e=cs(n);return as(e,"bottom")}function ms(n){var e=cs(n);return as(e,"width")}function gs(n){var e=cs(n);return as(e,"height")}function ps(n,e,t){return(n+e)/2-t}function hs(n,e){var t=cs(n),r=cs(e),o=as(t,gl),i=as(t,"right"),u=as(r,gl);return ps(o,i,u)}function vs(n,e){var t=cs(n),r=cs(e),o=as(t,"top"),i=as(t,"bottom"),u=as(r,"top");return ps(o,i,u)}function ys(n,e){G(n,ml(),{value:e})}function bs(n){return{x:v(n)}}function xs(n,e,t){var r={min:Mf(e),max:Ff(e),range:_f(e),value:t,step:Lf(e),snap:Gf(e),snapStart:Uf(e),rounded:$f(e),hasMinEdge:Xf(e),hasMaxEdge:qf(e),minBound:fs(n),maxBound:ss(n),screenRange:ms(n)};return is(r)}function ws(t){return function(n,e){return function(n,e,t){var r=(0<n?rs:ts)(Jf(t).x(),Mf(t),Ff(t),Lf(t));return ys(e,bs(r)),Rn.some(r)}(t,n,e).map(function(){return!0})}}function Ss(n,e,t,r,o,i){var u=function(e,n,t,r,o){var i=ms(e),u=r.bind(function(n){return Rn.some(hs(n,e))}).getOr(0),c=o.bind(function(n){return Rn.some(hs(n,e))}).getOr(i),a={min:Mf(n),max:Ff(n),range:_f(n),value:t,hasMinEdge:Xf(n),hasMaxEdge:qf(n),minBound:fs(e),minOffset:0,maxBound:ss(e),maxOffset:i,centerMinEdge:u,centerMaxEdge:c};return us(a)}(e,i,t,r,o);return fs(e)-fs(n)+u}function Ts(n,e){G(n,ml(),{value:e})}function Os(n){return{y:v(n)}}function ks(n,e,t){var r={min:If(e),max:Bf(e),range:Hf(e),value:t,step:Lf(e),snap:Gf(e),snapStart:Uf(e),rounded:$f(e),hasMinEdge:Yf(e),hasMaxEdge:Kf(e),minBound:ls(n),maxBound:ds(n),screenRange:gs(n)};return is(r)}function Es(t){return function(n,e){return function(n,e,t){var r=(0<n?rs:ts)(Jf(t).y(),If(t),Bf(t),Lf(t));return Ts(e,Os(r)),Rn.some(r)}(t,n,e).map(function(){return!0})}}function Cs(n,e,t,r,o,i){var u=function(e,n,t,r,o){var i=gs(e),u=r.bind(function(n){return Rn.some(vs(n,e))}).getOr(0),c=o.bind(function(n){return Rn.some(vs(n,e))}).getOr(i),a={min:If(n),max:Bf(n),range:Hf(n),value:t,hasMinEdge:Yf(n),hasMaxEdge:Kf(n),minBound:ls(e),minOffset:0,maxBound:ds(e),maxOffset:i,centerMinEdge:u,centerMaxEdge:c};return us(a)}(e,i,t,r,o);return ls(e)-ls(n)+u}function Ds(n,e){G(n,ml(),{value:e})}function Ms(n,e){return{x:v(n),y:v(e)}}function Is(t,r){return function(n,e){return function(n,e,t,r){var o=0<n?rs:ts,i=e?Jf(r).x():o(Jf(r).x(),Mf(r),Ff(r),Lf(r)),u=e?o(Jf(r).y(),If(r),Bf(r),Lf(r)):Jf(r).y();return Ds(t,Ms(i,u)),Rn.some(i)}(t,r,n,e).map(function(){return!0})}}function Rs(e,t,r,n){return Us.forToolbar(t,function(){var n=r();e.setContextToolbar([{label:t+" group",items:n}])},{},n)}function As(n){return[function(o){function i(n){return n<0?"black":360<n?"white":"hsl("+n+", 100%, 50%)"}return Nl.sketch({dom:Ls('<div class="${prefix}-slider ${prefix}-hue-slider-container"></div>'),components:[Nl.parts()["left-edge"](vf('<div class="${prefix}-hue-slider-black"></div>')),Nl.parts().spectrum({dom:Ls('<div class="${prefix}-slider-gradient-container"></div>'),components:[vf('<div class="${prefix}-slider-gradient"></div>')],behaviours:Ao([Ri.config({toggleClass:Ni.resolve("thumb-active")})])}),Nl.parts()["right-edge"](vf('<div class="${prefix}-hue-slider-white"></div>')),Nl.parts().thumb({dom:Ls('<div class="${prefix}-slider-thumb"></div>'),behaviours:Ao([Ri.config({toggleClass:Ni.resolve("thumb-active")})])})],onChange:function(n,e,t){var r=i(t.x());zi(e.element(),"background-color",r),o.onChange(n,e,r)},onDragStart:function(n,e){Ri.on(e)},onDragEnd:function(n,e){Ri.off(e)},onInit:function(n,e,t,r){var o=i(r.x());zi(e.element(),"background-color",o)},stepSize:10,model:{mode:"x",minX:0,maxX:360,getInitialValue:function(){return{x:function(){return o.getInitialValue()}}}},sliderBehaviours:Ao([Fi(Nl.refresh)])})}(n)]}function Fs(n){var e=n.selection.getStart(),t=Ye.fromDom(e),r=Ye.fromDom(n.getBody()),o=function(e,n){return(Ze(n)?Rn.some(n):cn(n).filter(Ze)).map(function(n){return Ar(n,function(n){return di(n,"font-size").isSome()},e).bind(function(n){return di(n,"font-size")}).getOrThunk(function(){return li(n,"font-size")})}).getOr("")}(function(n){return on(r,n)},t);return A(Pl,function(n){return o===n}).getOr("medium")}function Bs(n){return[vf('<span class="${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon"></span>'),function(n){return Hl({onChange:n.onChange,sizes:Ll,category:"font",getInitialValue:n.getInitialValue})}(n),vf('<span class="${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon"></span>')]}function Vs(n){var e=function t(n){return n.uid!==undefined}(n)&&Cn(n,"uid")?n.uid:Mc("memento");return{get:function(n){return n.getSystem().getByUid(e).getOrDie()},getOpt:function(n){return n.getSystem().getByUid(e).toOption()},asSpec:function(){return b(b({},n),{uid:e})}}}var Ns,js,_s=jt([Xt("name"),Xt("factory"),Xt("configFields"),nr("apis",{}),nr("extraApis",{})]),Hs=jt([Xt("name"),Xt("factory"),Xt("configFields"),Xt("partFields"),nr("apis",{}),nr("extraApis",{})]),Ps=gf({name:"Button",factory:function(n){function t(e){return Et(n.dom,"attributes").bind(function(n){return Et(n,e)})}var e=function(n){function e(n,e){e.stop(),U(n)}var t=Ie.detect().deviceType.isTouch()?[Nr(_e(),e)]:[Nr(qn(),e),Nr(Pn(),function(n,e){e.cut()})];return Br(B([n.map(function(t){return Nr(Ne(),function(n,e){t(n),e.stop()})}).toArray(),t]))}(n.action),r=n.dom.tag;return{uid:n.uid,dom:n.dom,components:n.components,events:e,behaviours:Va(n.buttonBehaviours,[Pi.config({}),Fa.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==r)return{role:t("role").getOr("button")};var n=t("type").getOr("button"),e=t("role").map(function(n){return{role:n}}).getOr({});return b({type:n},e)}()},eventOrder:n.eventOrder}},configFields:[nr("uid",undefined),Xt("dom"),nr("components",[]),Ba("buttonBehaviours",[Pi,Fa]),Kt("action"),Kt("role"),nr("eventOrder",{})]}),zs=Wr({fields:[],name:"unselecting",active:/* */Object.freeze({events:function(n){return Br([Vr(Kn(),v(!0))])},exhibit:function(n,e){return Lr({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),Ls=function(n){var e=function(n,r){return n.replace(/\$\{([^{}]*)\}/g,function(n,e){var t=r[e];return function(n){var e=typeof n;return"string"==e||"number"==e}(t)?t.toString():n})}(n,{prefix:Ni.prefix()});return hf(e)},Gs=function(n,e,t,r){return Ps.sketch({dom:bf(n,r),action:e,buttonBehaviours:yt(Ao([zs.config({})]),t)})},Us={forToolbar:Gs,forToolbarCommand:function(n,e){return Gs(e,function(){n.execCommand(e)},{},n)},forToolbarStateAction:function(n,e,t,r){var o=yf(t);return Gs(e,r,o,n)},forToolbarStateCommand:function(n,e){var t=yf(e);return Gs(e,function(){n.execCommand(e)},t,n)},getToolbarIconButton:bf},$s=Ie.detect().deviceType.isTouch(),Ws=ef({schema:[Xt("dom")],name:"label"}),Xs=xf("top-left"),qs=xf("top"),Ys=xf("top-right"),Ks=xf("right"),Js=xf("bottom-right"),Qs=xf("bottom"),Zs=xf("bottom-left"),nl=[Ws,xf("left"),Ks,qs,Qs,Xs,Ys,Zs,Js,nf({name:"thumb",defaults:v({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:Br([Hr(jn(),n,"spectrum"),Hr(_n(),n,"spectrum"),Hr(Hn(),n,"spectrum"),Hr(Pn(),n,"spectrum"),Hr(zn(),n,"spectrum"),Hr(Ln(),n,"spectrum")])}}}),nf({schema:[tr("mouseIsDown",function(){return Ho(!1)})],name:"spectrum",overrides:function(t){function r(e,n){return o.getValueFromEvent(n).map(function(n){return o.setValueFrom(e,t,n)})}var o=t.model.manager,n=Br([Nr(jn(),r),Nr(_n(),r)]),e=Br([Nr(Pn(),r),Nr(zn(),function(n,e){t.mouseIsDown.get()&&r(n,e)})]);return{behaviours:Ao($s?[]:[Fa.config({mode:"special",onLeft:function(n){return o.onLeft(n,t)},onRight:function(n){return o.onRight(n,t)},onUp:function(n){return o.onUp(n,t)},onDown:function(n){return o.onDown(n,t)}}),Pi.config({})]),events:$s?n:e}}})],el=/* */Object.freeze({onLoad:wf,onUnload:Sf,setValue:function(n,e,t,r){e.store.manager.setValue(n,e,t,r)},getValue:function(n,e,t){return e.store.manager.getValue(n,e,t)},getState:function(n,e,t){return t}}),tl=/* */Object.freeze({events:function(t,r){var n=t.resetOnDom?[Oo(function(n,e){wf(n,t,r)}),ko(function(n,e){Sf(n,t,r)})]:[Gr(t,r,wf)];return Br(n)}}),rl=/* */Object.freeze({memory:Tf,dataset:Of,manual:function(){return Ro({readState:function(){}})},init:function(n){return n.store.manager.state(n)}}),ol=[Kt("initialValue"),Xt("getFallbackEntry"),Xt("getDataKey"),Xt("setValue"),Zo("manager",{setValue:kf,getValue:function(n,e,t){var r=e.store,o=r.getDataKey(n);return t.lookup(o).fold(function(){return r.getFallbackEntry(o)},function(n){return n})},onLoad:function(e,t,r){t.store.initialValue.each(function(n){kf(e,t,r,n)})},onUnload:function(n,e,t){t.clear()},state:Of})],il=[Xt("getValue"),nr("setValue",x),Kt("initialValue"),Zo("manager",{setValue:function(n,e,t,r){e.store.setValue(n,r),e.onSetValue(n,r)},getValue:function(n,e,t){return e.store.getValue(n)},onLoad:function(e,t,n){t.store.initialValue.each(function(n){t.store.setValue(e,n)})},onUnload:x,state:Io.init})],ul=[Kt("initialValue"),Zo("manager",{setValue:function(n,e,t,r){t.set(r),e.onSetValue(n,r)},getValue:function(n,e,t){return t.get()},onLoad:function(n,e,t){e.store.initialValue.each(function(n){t.isNotSet()&&t.set(n)})},onUnload:function(n,e,t){t.clear()},state:Tf})],cl=[er("store",{mode:"memory"},Wt("mode",{memory:ul,manual:il,dataset:ol})),Yo("onSetValue"),nr("resetOnDom",!1)],al=Wr({fields:cl,name:"representing",active:tl,apis:el,extra:{setValueFrom:function(n,e){var t=al.getValue(e);al.setValue(n,t)}},state:rl}),fl=Gi("width",function(n){return n.dom().offsetWidth}),sl=function(t,r){return{left:v(t),top:v(r),translate:function(n,e){return sl(t+n,r+e)}}},ll=sl,dl=Ie.detect().deviceType.isTouch(),ml=v("slider.change.value"),gl="left",pl=ws(-1),hl=ws(1),vl=Rn.none,yl=Rn.none,bl={"top-left":Rn.none(),top:Rn.none(),"top-right":Rn.none(),right:Rn.some(function(n,e){es(n,Qf(Vf(e)))}),"bottom-right":Rn.none(),bottom:Rn.none(),"bottom-left":Rn.none(),left:Rn.some(function(n,e){es(n,Qf(Rf(e)))})},xl=/* */Object.freeze({setValueFrom:function(n,e,t){var r=xs(n,e,t),o=bs(r);return ys(n,o),r},setToMin:function(n,e){var t=Mf(e);ys(n,bs(t))},setToMax:function(n,e){var t=Ff(e);ys(n,bs(t))},findValueOfOffset:xs,getValueFromEvent:function(n){return Df(n).map(function(n){return n.left()})},findPositionOfValue:Ss,setPositionFromValue:function(n,e,t,r){var o=Jf(t),i=Ss(n,r.getSpectrum(n),o.x(),r.getLeftEdge(n),r.getRightEdge(n),t),u=Cf(e.element())/2;zi(e.element(),"left",i-u+"px")},onLeft:pl,onRight:hl,onUp:vl,onDown:yl,edgeActions:bl}),wl=Rn.none,Sl=Rn.none,Tl=Es(-1),Ol=Es(1),kl={"top-left":Rn.none(),top:Rn.some(function(n,e){es(n,Zf(Af(e)))}),"top-right":Rn.none(),right:Rn.none(),"bottom-right":Rn.none(),bottom:Rn.some(function(n,e){es(n,Zf(Nf(e)))}),"bottom-left":Rn.none(),left:Rn.none()},El=/* */Object.freeze({setValueFrom:function(n,e,t){var r=ks(n,e,t),o=Os(r);return Ts(n,o),r},setToMin:function(n,e){var t=If(e);Ts(n,Os(t))},setToMax:function(n,e){var t=Bf(e);Ts(n,Os(t))},findValueOfOffset:ks,getValueFromEvent:function(n){return Df(n).map(function(n){return n.top()})},findPositionOfValue:Cs,setPositionFromValue:function(n,e,t,r){var o=Jf(t),i=Cs(n,r.getSpectrum(n),o.y(),r.getTopEdge(n),r.getBottomEdge(n),t),u=Ui(e.element())/2;zi(e.element(),"top",i-u+"px")},onLeft:wl,onRight:Sl,onUp:Tl,onDown:Ol,edgeActions:kl}),Cl=Is(-1,!1),Dl=Is(1,!1),Ml=Is(-1,!0),Il=Is(1,!0),Rl={"top-left":Rn.some(function(n,e){es(n,ns(Rf(e),Af(e)))}),top:Rn.some(function(n,e){es(n,ns(Pf(e),Af(e)))}),"top-right":Rn.some(function(n,e){es(n,ns(Vf(e),Af(e)))}),right:Rn.some(function(n,e){es(n,ns(Vf(e),zf(e)))}),"bottom-right":Rn.some(function(n,e){es(n,ns(Vf(e),Nf(e)))}),bottom:Rn.some(function(n,e){es(n,ns(Pf(e),Nf(e)))}),"bottom-left":Rn.some(function(n,e){es(n,ns(Rf(e),Nf(e)))}),left:Rn.some(function(n,e){es(n,ns(Rf(e),zf(e)))})},Al=/* */Object.freeze({setValueFrom:function(n,e,t){var r=xs(n,e,t.left()),o=ks(n,e,t.top()),i=Ms(r,o);return Ds(n,i),i},setToMin:function(n,e){var t=Mf(e),r=If(e);Ds(n,Ms(t,r))},setToMax:function(n,e){var t=Ff(e),r=Bf(e);Ds(n,Ms(t,r))},getValueFromEvent:function(n){return Df(n)},setPositionFromValue:function(n,e,t,r){var o=Jf(t),i=Ss(n,r.getSpectrum(n),o.x(),r.getLeftEdge(n),r.getRightEdge(n),t),u=Cs(n,r.getSpectrum(n),o.y(),r.getTopEdge(n),r.getBottomEdge(n),t),c=Cf(e.element())/2,a=Ui(e.element())/2;zi(e.element(),"left",i-c+"px"),zi(e.element(),"top",u-a+"px")},onLeft:Cl,onRight:Dl,onUp:Ml,onDown:Il,edgeActions:Rl}),Fl=Ie.detect().deviceType.isTouch(),Bl=[nr("stepSize",1),nr("onChange",x),nr("onChoose",x),nr("onInit",x),nr("onDragStart",x),nr("onDragEnd",x),nr("snapToGrid",!1),nr("rounded",!0),Kt("snapStart"),qt("model",Wt("mode",{x:[nr("minX",0),nr("maxX",100),tr("value",function(n){return Ho(n.mode.minX)}),Xt("getInitialValue"),Zo("manager",xl)],y:[nr("minY",0),nr("maxY",100),tr("value",function(n){return Ho(n.mode.minY)}),Xt("getInitialValue"),Zo("manager",El)],xy:[nr("minX",0),nr("maxX",100),nr("minY",0),nr("maxY",100),tr("value",function(n){return Ho({x:v(n.mode.minX),y:v(n.mode.minY)})}),Xt("getInitialValue"),Zo("manager",Al)]})),lc("sliderBehaviours",[Fa,al])].concat(Fl?[]:[tr("mouseIsDown",function(){return Ho(!1)})]),Vl=Ie.detect().deviceType.isTouch(),Nl=pf({name:"Slider",configFields:Bl,partFields:nl,factory:function(i,n,e,t){function u(n){return Oc(n,i,"thumb")}function c(n){return Oc(n,i,"spectrum")}function r(n){return Tc(n,i,"left-edge")}function o(n){return Tc(n,i,"right-edge")}function a(n){return Tc(n,i,"top-edge")}function f(n){return Tc(n,i,"bottom-edge")}function s(n,e){m.setPositionFromValue(n,e,i,{getLeftEdge:r,getRightEdge:o,getTopEdge:a,getBottomEdge:f,getSpectrum:c})}function l(n,e){d.value.set(e);var t=u(n);return s(n,t),i.onChange(n,t,e),Rn.some(!0)}var d=i.model,m=d.manager,g=[Nr(jn(),function(n,e){i.onDragStart(n,u(n))}),Nr(Hn(),function(n,e){i.onDragEnd(n,u(n))})],p=[Nr(Pn(),function(n,e){e.stop(),i.onDragStart(n,u(n)),i.mouseIsDown.set(!0)}),Nr(Ln(),function(n,e){i.onDragEnd(n,u(n))})],h=Vl?g:p;return{uid:i.uid,dom:i.dom,components:n,behaviours:mc(i.sliderBehaviours,B([Vl?[]:[Fa.config({mode:"special",focusIn:function(n){return Tc(n,i,"spectrum").map(Fa.focusIn).map(v(!0))}})],[al.config({store:{mode:"manual",getValue:function(n){return d.value.get()}}}),ki.config({channels:{"mouse.released":{onReceive:function(t,n){var e=i.mouseIsDown.get();i.mouseIsDown.set(!1),e&&Tc(t,i,"thumb").each(function(n){var e=d.value.get();i.onChoose(t,n,e)})}}}})]])),events:Br([Nr(ml(),function(n,e){l(n,e.event().value())}),Oo(function(n,e){var t=d.getInitialValue();d.value.set(t);var r=u(n);s(n,r);var o=c(n);i.onInit(n,r,o,d.value.get())})].concat(h)),apis:{resetToMin:function(n){m.setToMin(n,i)},resetToMax:function(n){m.setToMax(n,i)},changeValue:l,refresh:s},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(n,e){n.resetToMin(e)},resetToMax:function(n,e){n.resetToMax(e)},refresh:function(n,e){n.refresh(e)}}}),jl=function(n,r){var e={onChange:function(n,e,t){r.undoManager.transact(function(){r.formatter.apply("forecolor",{value:t}),r.nodeChanged()})},getInitialValue:function(){return-1}};return Rs(n,"color-levels",function(){return As(e)},r)},_l=jt([Xt("getInitialValue"),Xt("onChange"),Xt("category"),Xt("sizes")]),Hl=function(n){var o=$t("SizeSlider",_l,n);return Nl.sketch({dom:{tag:"div",classes:[Ni.resolve("slider-"+o.category+"-size-container"),Ni.resolve("slider"),Ni.resolve("slider-size-container")]},onChange:function(n,e,t){var r=t.x();!function(n){return 0<=n&&n<o.sizes.length}(r)||o.onChange(r)},onDragStart:function(n,e){Ri.on(e)},onDragEnd:function(n,e){Ri.off(e)},model:{mode:"x",minX:0,maxX:o.sizes.length-1,getInitialValue:function(){return{x:function(){return o.getInitialValue()}}}},stepSize:1,snapToGrid:!0,sliderBehaviours:Ao([Fi(Nl.refresh)]),components:[Nl.parts().spectrum({dom:Ls('<div class="${prefix}-slider-size-container"></div>'),components:[vf('<div class="${prefix}-slider-size-line"></div>')]}),Nl.parts().thumb({dom:Ls('<div class="${prefix}-slider-thumb"></div>'),behaviours:Ao([Ri.config({toggleClass:Ni.resolve("thumb-active")})])})]})},Pl=["9px","10px","11px","12px","14px","16px","18px","20px","24px","32px","36px"],zl={candidates:v(Pl),get:function(n){return function(e){return F(Pl,function(n){return n===e})}(Fs(n)).getOr(2)},apply:function(e,n){(function(n){return Rn.from(Pl[n])})(n).each(function(n){!function(n,e){Fs(n)!==e&&n.execCommand("fontSize",!1,e)}(e,n)})}},Ll=zl.candidates(),Gl=window.Promise?window.Promise:(Ns=Ul.immediateFn||"function"==typeof window.setImmediate&&window.setImmediate||function(n){d.setTimeout(n,1)},js=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)},Ul.prototype["catch"]=function(n){return this.then(null,n)},Ul.prototype.then=function(t,r){var o=this;return new Ul(function(n,e){Wl.call(o,new Kl(t,r,n,e))})},Ul.all=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var a=Array.prototype.slice.call(1===n.length&&js(n[0])?n[0]:n);return new Ul(function(o,i){if(0===a.length)return o([]);var u=a.length;function c(e,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if("function"==typeof t)return void t.call(n,function(n){c(e,n)},i)}a[e]=n,0==--u&&o(a)}catch(r){i(r)}}for(var n=0;n<a.length;n++)c(n,a[n])})},Ul.resolve=function(e){return e&&"object"==typeof e&&e.constructor===Ul?e:new Ul(function(n){n(e)})},Ul.reject=function(t){return new Ul(function(n,e){e(t)})},Ul.race=function(o){return new Ul(function(n,e){for(var t=0,r=o;t<r.length;t++)r[t].then(n,e)})},Ul);function Ul(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],Jl(n,$l(Xl,this),$l(ql,this))}function $l(n,e){return function(){return n.apply(e,arguments)}}function Wl(r){var o=this;null!==this._state?Ns(function(){var n=o._state?r.onFulfilled:r.onRejected;if(null!==n){var e;try{e=n(o._value)}catch(t){return void r.reject(t)}r.resolve(e)}else(o._state?r.resolve:r.reject)(o._value)}):this._deferreds.push(r)}function Xl(n){try{if(n===this)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if("function"==typeof e)return void Jl($l(e,n),$l(Xl,this),$l(ql,this))}this._state=!0,this._value=n,Yl.call(this)}catch(t){ql.call(this,t)}}function ql(n){this._state=!1,this._value=n,Yl.call(this)}function Yl(){for(var n=0,e=this._deferreds;n<e.length;n++){var t=e[n];Wl.call(this,t)}this._deferreds=[]}function Kl(n,e,t,r){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.resolve=t,this.reject=r}function Jl(n,e,t){var r=!1;try{n(function(n){r||(r=!0,e(n))},function(n){r||(r=!0,t(n))})}catch(o){if(r)return;r=!0,t(o)}}function Ql(n){return function e(t){return new Gl(function(n){var e=new d.FileReader;e.onloadend=function(){n(e.result)},e.readAsDataURL(t)})}(n).then(function(n){return n.split(",")[1]})}function Zl(o,i){(function(n){return Ql(n)})(i).then(function(r){o.undoManager.transact(function(){var n=o.editorUpload.blobCache,e=n.create(hc("mceu"),i,r);n.add(e);var t=o.dom.createHTML("img",{src:e.blobUri()});o.insertContent(t)})})}function nd(t){var e=Vs({dom:{tag:"input",attributes:{accept:"image/*",type:"file",title:""},styles:{visibility:"hidden",position:"absolute"}},events:Br([Pr(qn()),Nr(Xn(),function(n,e){(function(n){var e=n.event(),t=e.raw().target.files||e.raw().dataTransfer.files;return Rn.from(t[0])})(e).each(function(n){Zl(t,n)})})])});return Ps.sketch({dom:Us.getToolbarIconButton("image",t),components:[e.asSpec()],action:function(n){e.get(n).element().dom().click()}})}function ed(n){return n.dom().textContent}function td(n){return 0<n.length}function rd(n){return n===undefined||null===n?"":n}function od(n,e,t){return t.text.toOption().filter(td).fold(function(){return function(n){return Kr(n,"href")===ed(n)}(n)?Rn.some(e):Rn.none()},Rn.some)}function id(n,e){var t=e.selection.getRng();n(),e.selection.setRng(t)}function ud(n){return n.dom().value}function cd(n,e){if(e===undefined)throw new Error("Value.set was undefined");n.dom().value=e}function ad(n){return b(b({},function(n){return Ao([Pi.config({onFocus:!1===n.selectOnFocus?x:function(n){var e=n.element(),t=ud(e);e.dom().setSelectionRange(0,t.length)}})])}(n)),mc(n.inputBehaviours,[al.config({store:{mode:"manual",initialValue:n.data.getOr(undefined),getValue:function(n){return ud(n.element())},setValue:function(n,e){ud(n.element())!==e&&cd(n.element(),e)}},onSetValue:n.onSetValue})]))}function fd(n,e){var t=Vs(hm.sketch({inputAttributes:{placeholder:xm.translate(e)},onSetValue:function(n,e){L(n,Wn())},inputBehaviours:Ao([dm.config({find:Rn.some}),bm.config({}),Fa.config({mode:"execution"})]),selectOnFocus:!1})),r=Vs(Ps.sketch({dom:Ls('<button class="${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon"></button>'),action:function(n){var e=t.get(n);al.setValue(e,"")}}));return{name:n,spec:mm.sketch({dom:Ls('<div class="${prefix}-input-container"></div>'),components:[t.asSpec(),r.asSpec()],containerBehaviours:Ao([Ri.config({toggleClass:Ni.resolve("input-container-empty")}),dm.config({find:function(n){return Rn.some(t.get(n))}}),fm("input-clearing",[Nr(Wn(),function(n){var e=t.get(n);(0<al.getValue(e).length?Ri.off:Ri.on)(n)})])])})}}function sd(n,e,t){e.disabled&&Sm(n,e)}function ld(n,e){return!0===e.useNative&&E(wm,W(n.element()))}function dd(n){qr(n.element(),"disabled","disabled")}function md(n){Qr(n.element(),"disabled")}function gd(n){qr(n.element(),"aria-disabled","true")}function pd(n){qr(n.element(),"aria-disabled","false")}function hd(e,n,t){n.disableClass.each(function(n){io(e.element(),n)}),(ld(e,n)?md:pd)(e),n.onEnabled(e)}function vd(n,e){return ld(n,e)?function(n){return Jr(n.element(),"disabled")}(n):function(n){return"true"===Kr(n.element(),"aria-disabled")}(n)}function yd(n){return"<alloy.field."+n+">"}function bd(){function e(){t.get().each(function(n){n.destroy()})}var t=Ho(Rn.none());return{clear:function(){e(),t.set(Rn.none())},isSet:function(){return t.get().isSome()},set:function(n){e(),t.set(Rn.some(n))},run:function(n){t.get().each(n)}}}function xd(){var e=Ho(Rn.none());return{clear:function(){e.set(Rn.none())},set:function(n){e.set(Rn.some(n))},isSet:function(){return e.get().isSome()},on:function(n){e.get().each(n)}}}function wd(n){function r(e,n,t){return Ps.sketch({dom:Ls('<span class="${prefix}-icon-'+n+' ${prefix}-icon"></span>'),action:function(n){G(n,u,{direction:e})},buttonBehaviours:Ao([Em.config({disableClass:Ni.resolve("toolbar-navigation-disabled"),disabled:!t})])})}function o(n,o){var i=Xi(n.element(),"."+Ni.resolve("serialised-dialog-screen"));Ki(n.element(),"."+Ni.resolve("serialised-dialog-chain")).each(function(r){0<=c.state.currentScreen.get()+o&&c.state.currentScreen.get()+o<i.length&&(di(r,"left").each(function(n){var e=parseInt(n,10),t=Cf(i[0]);zi(r,"left",e-o*t+"px")}),c.state.currentScreen.set(c.state.currentScreen.get()+o))})}function i(e){var n=Xi(e.element(),"input");Rn.from(n[c.state.currentScreen.get()]).each(function(n){e.getSystem().getByDom(n).each(function(n){!function(n,e){n.getSystem().triggerFocus(e,n.element())}(e,n.element())})});var t=f.get(e);ku.highlightAt(t,c.state.currentScreen.get())}var u="navigateEvent",e=Sr([Xt("fields"),nr("maxFieldIndex",n.fields.length-1),Xt("onExecute"),Xt("getInitialValue"),tr("state",function(){return{dialogSwipeState:xd(),currentScreen:Ho(0)}})]),c=$t("SerialisedDialog",e,n),a=Vs(Mm(function(t){return{dom:Ls('<div class="${prefix}-serialised-dialog"></div>'),components:[mm.sketch({dom:Ls('<div class="${prefix}-serialised-dialog-chain" style="left: 0px; position: absolute;"></div>'),components:Se(c.fields,function(n,e){return e<=c.maxFieldIndex?mm.sketch({dom:Ls('<div class="${prefix}-serialised-dialog-screen"></div>'),components:[r(-1,"previous",0<e),t.field(n.name,n.spec),r(1,"next",e<c.maxFieldIndex)]}):t.field(n.name,n.spec)})})],formBehaviours:Ao([Fi(function(n,e){!function(n,e){Ki(n.element(),"."+Ni.resolve("serialised-dialog-chain")).each(function(n){zi(n,"left",-c.state.currentScreen.get()*e.width+"px")})}(n,e)}),Fa.config({mode:"special",focusIn:function(n){i(n)},onTab:function(n){return o(n,1),Rn.some(!0)},onShiftTab:function(n){return o(n,-1),Rn.some(!0)}}),fm("form-events",[Oo(function(e,n){c.state.currentScreen.set(0),c.state.dialogSwipeState.clear();var t=f.get(e);ku.highlightFirst(t),c.getInitialValue(e).each(function(n){al.setValue(e,n)})}),Co(c.onExecute),Nr(Yn(),function(n,e){"left"===e.event().raw().propertyName&&i(n)}),Nr(u,function(n,e){var t=e.event().direction();o(n,t)})])])}})),f=Vs({dom:Ls('<div class="${prefix}-dot-container"></div>'),behaviours:Ao([ku.config({highlightClass:Ni.resolve("dot-active"),itemClass:Ni.resolve("dot-item")})]),components:V(c.fields,function(n,e){return e<=c.maxFieldIndex?[vf('<div class="${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon"></div>')]:[]})});return{dom:Ls('<div class="${prefix}-serializer-wrapper"></div>'),components:[a.asSpec(),f.asSpec()],behaviours:Ao([Fa.config({mode:"special",focusIn:function(n){var e=a.get(n);Fa.focusIn(e)}}),fm("serializer-wrapper-events",[Nr(jn(),function(n,e){var t=e.event();c.state.dialogSwipeState.set(Im(t.raw().touches[0].clientX))}),Nr(_n(),function(n,e){var t=e.event();c.state.dialogSwipeState.on(function(n){e.event().prevent(),c.state.dialogSwipeState.set(Rm(n,t.raw().touches[0].clientX))})}),Nr(Hn(),function(r){c.state.dialogSwipeState.on(function(n){var e=a.get(r),t=-1*Am(n);o(e,t)})})])])}}function Sd(e){function n(n){return function(){throw new Error("The component must be in a context to send: "+n+"\n"+vo(e().element())+" is not in context.")}}return{debugInfo:v("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),build:n("build"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),isConnected:v(!1)}}function Td(n,o){var i={};return Bn(n,function(n,r){Bn(n,function(n,e){var t=Tn(e,[])(i);i[e]=t.concat([o(r,n)])})}),i}function Od(n){return n.cHandler}function kd(n,e){return{name:v(n),handler:v(e)}}function Ed(n,e,t){var r=b(b({},t),function(n,e){var t={};return D(n,function(n){t[n.name()]=n.handlers(e)}),t}(e,n));return Td(r,kd)}function Cd(n){var i=function(n){return ve(n)?{can:v(!0),abort:v(!1),run:n}:n}(n);return function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var o=[n,e].concat(t);i.abort.apply(undefined,o)?e.stop():i.can.apply(undefined,o)&&i.run.apply(undefined,o)}}function Dd(n,e,t){var r=e[t];return r?function(u,c,n,a){var e=n.slice(0);try{var t=e.sort(function(n,e){var t=n[c](),r=e[c](),o=a.indexOf(t),i=a.indexOf(r);if(-1===o)throw new Error("The ordering for "+u+" does not have an entry for "+t+".\nOrder specified: "+JSON.stringify(a,null,2));if(-1===i)throw new Error("The ordering for "+u+" does not have an entry for "+r+".\nOrder specified: "+JSON.stringify(a,null,2));return o<i?-1:i<o?1:0});return pt.value(t)}catch(r){return pt.error([r])}}("Event: "+t,"name",n,r).map(function(n){var e=Se(n,function(n){return n.handler()});return ir(e)}):function(n,e){return pt.error(["The event ("+n+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(Se(e,function(n){return n.name()}),null,2)])}(t,n)}function Md(n){return Gt("custom.definition",Sr([kr("dom","dom",wt(),Sr([Xt("tag"),nr("styles",{}),nr("classes",[]),nr("attributes",{}),Kt("value"),Kt("innerHtml")])),Xt("components"),Xt("uid"),nr("events",{}),nr("apis",{}),kr("eventOrder","eventOrder",function(n){return xt.mergeWithThunk(v(n))}({"alloy.execute":["disabling","alloy.base.behaviour","toggling","typeaheadevents"],"alloy.focus":["alloy.base.behaviour","focusing","keying"],"alloy.system.init":["alloy.base.behaviour","disabling","toggling","representing"],input:["alloy.base.behaviour","representing","streaming","invalidating"],"alloy.system.detached":["alloy.base.behaviour","representing","item-events","tooltipping"],mousedown:["focusing","alloy.base.behaviour","item-type-events"],mouseover:["item-type-events","tooltipping"]}),Dr()),Kt("domModification")]),n)}function Id(e,n){D(n,function(n){ro(e,n)})}function Rd(e,n){D(n,function(n){io(e,n)})}function Ad(n,e){return function(e,n){var t=Se(n,function(n){return Qt(n.name(),[Xt("config"),nr("state",Io)])}),r=Gt("component.behaviours",Sr(t),e.behaviours).fold(function(n){throw new Error(Cr(n)+"\nComplete spec:\n"+JSON.stringify(e,null,2))},function(n){return n});return{list:n,data:w(r,function(n){var e=n.map(function(n){return{config:n.config,state:n.state.init(n.config)}});return function(){return e}})}}(n,e)}function Fd(n){var e=function(n){var e=Tn("behaviours",{})(n),t=M(An(e),function(n){return e[n]!==undefined});return Se(t,function(n){return e[n].me})}(n);return Ad(n,e)}function Bd(n,e,t){var r=function(n){return b(b({},n.dom),{uid:n.uid,domChildren:Se(n.components,function(n){return n.element()})})}(n),o=function(n){return n.domModification.fold(function(){return Lr({})},Lr)}(n),i={"alloy.base.modification":o};return function(n,e){return b(b({},n),{attributes:b(b({},n.attributes),e.attributes),styles:b(b({},n.styles),e.styles),classes:n.classes.concat(e.classes)})}(r,0<e.length?function(e,n,t,r){var o=b({},n);D(t,function(n){o[n.name()]=n.exhibit(e,r)});function i(n){return I(n,function(n,e){return b(b({},e.modification),n)},{})}var u=Td(o,function(n,e){return{name:n,modification:e}}),c=I(u.classes,function(n,e){return e.modification.concat(n)},[]),a=i(u.attributes),f=i(u.styles);return Lr({classes:c,attributes:a,styles:f})}(t,i,e,r):o)}function Vd(n,e,t){var r={"alloy.base.behaviour":function(n){return n.events}(n)};return function(n,e,t,r){var o=Ed(n,t,r);return Pm(o,e)}(t,n.eventOrder,e,r).getOrDie()}function Nd(t){function n(){return s}var r=Ho(_m),e=Ut(Md(t)),o=Fd(t),i=function(n){return n.list}(o),u=function(n){return n.data}(o),c=function(n){var e=Ye.fromTag(n.tag);Yr(e,n.attributes),Id(e,n.classes),si(e,n.styles),n.innerHtml.each(function(n){return go(e,n)});var t=n.domChildren;return dn(e,t),n.value.each(function(n){cd(e,n)}),n.uid,lf(e,n.uid),e}(Bd(e,i,u)),a=Vd(e,i,u),f=Ho(e.components),s={getSystem:r.get,config:function(n){var e=u;return(ve(e[n.name()])?e[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+JSON.stringify(t,null,2))})()},hasConfigured:function(n){return ve(u[n.name()])},spec:v(t),readState:function(n){return u[n]().map(function(n){return n.state.readState()}).getOr("not enabled")},getApis:function(){return e.apis},connect:function(n){r.set(n)},disconnect:function(){r.set(Sd(n))},element:v(c),syncComponents:function(){var n=ut(c),e=V(n,function(n){return r.get().getByDom(n).fold(function(){return[]},function(n){return[n]})});f.set(e)},components:f.get,events:v(a)};return s}function jd(n){var e=jm(n),t=e.events,r=u(e,["events"]),o=function(n){var e=Tn("components",[])(n);return Se(e,Gm)}(r),i=b(b({},r),{events:b(b({},Nm),t),components:o});return pt.value(Nd(i))}function _d(n){var e=Ye.fromText(n);return zm({element:e})}function Hd(n){(lo(n.element()).isNone()||Pi.isFocused(n))&&(Pi.isFocused(n)||Pi.focus(n),G(n,$m,{item:n}))}function Pd(n){G(n,Wm,{item:n})}function zd(n,e,t,r){var o=n.getSystem().build(r);lt(n,o,t)}function Ld(n,e,t,r){var o=og(n);A(o,function(n){return on(r.element(),n.element())}).each(hn)}function Gd(e,n,t,r,o){var i=og(e);return Rn.from(i[r]).map(function(n){return Ld(e,0,0,n),o.each(function(n){zd(e,0,function(n,e){!function(n,e,t){an(n,t).fold(function(){ct(n,e)},function(n){fn(n,e)})}(n,e,r)},n)}),n})}function Ud(n,e){var t={};Bn(n,function(n,e){D(n,function(n){t[n]=e})});var r=e,o=function(n){return Vn(n,function(n,e){return{k:n,v:e}})}(e),i=w(o,function(n,e){return[e].concat(ug(t,r,o,e))});return w(t,function(n){return Et(i,n).getOr([n])})}function $d(n,e,t,r){return Et(e.routes,r.start).bind(function(n){return Et(n,r.destination)})}function Wd(t,r,n){(function(e,t,r){return lg(e,t).bind(function(n){return sg(e,t,r,n)})})(t,r,n).each(function(n){var e=n.transition;io(t.element(),e.transitionClass),Qr(t.element(),r.destinationAttr)})}function Xd(n,e,t,r){Wd(n,e,t),Jr(n.element(),e.stateAttr)&&Kr(n.element(),e.stateAttr)!==r&&e.onFinish(n,r),qr(n.element(),e.stateAttr,r)}function qd(n){return Et(n,"format").getOr(n.title)}function Yd(n){return Cn(n,"items")?function(n){var e=yt(Sn(n,["items"]),{menu:!0}),t=wg(n.items);return{item:e,menus:yt(t.menus,On(n.title,t.items)),expansions:yt(t.expansions,On(n.title,n.title))}}(n):{item:n,menus:{},expansions:{}}}function Kd(n){var e=n.replace(/\|/g," ").trim();return 0<e.length?e.split(/\s+/):[]}function Jd(n){var e=n.toolbar!==undefined?n.toolbar:kg;return pe(e)?Eg(e):Kd(e)}function Qd(u,c){return function(n){if(u(n)){var e=Ye.fromDom(n.target),t=function(){n.stopPropagation()},r=function(){n.preventDefault()},o=a(r,t),i=function(n,e,t,r,o,i,u){return{target:v(n),x:v(e),y:v(t),stop:r,prevent:o,kill:i,raw:v(u)}}(e,n.clientX,n.clientY,t,r,o,n);c(i)}}}function Zd(n,e,t,r,o){var i=Qd(t,r);return n.dom().addEventListener(e,i,o),{unbind:l(Mg,n,e,i,o)}}function nm(n,e,t){return function(n,e,t,r){return Zd(n,e,t,r,!1)}(n,e,Ig,t)}function em(n,e,t){return function(n,e,t,r){return Zd(n,e,t,r,!0)}(n,e,Ig,t)}function tm(n){var e=n.matchMedia("(orientation: portrait)").matches;return{isPortrait:v(e)}}var rm,om,im=function(n){var e=Ye.fromDom(n.selection.getStart());return Ji(e,"a")},um={getInfo:function(n){return im(n).fold(function(){return function(n){return{url:"",text:n.selection.getContent({format:"text"}),title:"",target:"",link:Rn.none()}}(n)},function(n){return function(n){var e=ed(n),t=Kr(n,"href"),r=Kr(n,"title"),o=Kr(n,"target");return{url:rd(t),text:e!==t?rd(e):"",title:rd(r),target:rd(o),link:Rn.some(n)}}(n)})},applyInfo:function(e,o){o.url.toOption().filter(td).fold(function(){!function(e,n){n.link.bind(y).each(function(n){e.execCommand("unlink")})}(e,o)},function(t){var r=function(n,e){var t={};return t.href=n,e.title.toOption().filter(td).each(function(n){t.title=n}),e.target.toOption().filter(td).each(function(n){t.target=n}),t}(t,o);o.link.bind(y).fold(function(){var n=o.text.toOption().filter(td).getOr(t);e.insertContent(e.dom.createHTML("a",r,e.dom.encode(n)))},function(e){var n=od(e,t,o);Yr(e,r),n.each(function(n){!function(n,e){n.dom().textContent=e}(e,n)})})})},query:im},cm=Ie.detect(),am=function(n,e){(cm.os.isAndroid()?id:t)(e,n)},fm=function(n,e){return{key:n,value:{config:{},me:function(n,e){var t=Br(e);return Wr({fields:[Xt("enabled")],name:n,active:{events:v(t)}})}(n,e),configAsRaw:v({}),initialConfig:{},state:Io}}},sm=/* */Object.freeze({getCurrent:function(n,e,t){return e.find(n)}}),lm=[Xt("find")],dm=Wr({fields:lm,name:"composing",apis:sm}),mm=gf({name:"Container",factory:function(n){var e=n.dom,t=e.attributes,r=u(e,["attributes"]);return{uid:n.uid,dom:b({tag:"div",attributes:b({role:"presentation"},t)},r),components:n.components,behaviours:dc(n.containerBehaviours),events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},configFields:[nr("components",[]),lc("containerBehaviours",[]),nr("events",{}),nr("domModification",{}),nr("eventOrder",{})]}),gm=gf({name:"DataField",factory:function(t){return{uid:t.uid,dom:t.dom,behaviours:Va(t.dataBehaviours,[al.config({store:{mode:"memory",initialValue:t.getInitialValue()}}),dm.config({find:Rn.some})]),events:Br([Oo(function(n,e){al.setValue(n,t.getInitialValue())})])}},configFields:[Xt("uid"),Xt("dom"),Xt("getInitialValue"),Ba("dataBehaviours",[al,dm])]}),pm=v([Kt("data"),nr("inputAttributes",{}),nr("inputStyles",{}),nr("tag","input"),nr("inputClasses",[]),Yo("onSetValue"),nr("styles",{}),nr("eventOrder",{}),lc("inputBehaviours",[al,Pi]),nr("selectOnFocus",!0)]),hm=gf({name:"Input",configFields:pm(),factory:function(n,e){return{uid:n.uid,dom:function(n){return{tag:n.tag,attributes:b({type:"text"},n.inputAttributes),styles:n.inputStyles,classes:n.inputClasses}}(n),components:[],behaviours:ad(n),eventOrder:n.eventOrder}}}),vm=/* */Object.freeze({exhibit:function(n,e){return Lr({attributes:kn([{key:e.tabAttr,value:"true"}])})}}),ym=[nr("tabAttr","data-alloy-tabstop")],bm=Wr({fields:ym,name:"tabstopping",active:vm}),xm=tinymce.util.Tools.resolve("tinymce.util.I18n"),wm=["input","button","textarea","select"],Sm=function(e,n,t){n.disableClass.each(function(n){ro(e.element(),n)}),(ld(e,n)?dd:gd)(e),n.onDisabled(e)},Tm=/* */Object.freeze({enable:hd,disable:Sm,isDisabled:vd,onLoad:sd,set:function(n,e,t,r){(r?Sm:hd)(n,e,t)}}),Om=/* */Object.freeze({exhibit:function(n,e,t){return Lr({classes:e.disabled?e.disableClass.map(_).getOr([]):[]})},events:function(t,n){return Br([Vr(Ne(),function(n,e){return vd(n,t)}),Gr(t,n,sd)])}}),km=[nr("disabled",!1),nr("useNative",!0),Kt("disableClass"),Yo("onDisabled"),Yo("onEnabled")],Em=Wr({fields:km,name:"disabling",active:Om,apis:Tm}),Cm=[lc("formBehaviours",[al])],Dm=function(r,n,e){return{uid:r.uid,dom:r.dom,components:n,behaviours:mc(r.formBehaviours,[al.config({store:{mode:"manual",getValue:function(n){var e=function(n,e){var t=n.getSystem();return w(e.partUids,function(n,e){return v(t.getByUid(n))})}(n,r);return w(e,function(n,e){return n().bind(function(n){return function(n,e){return n.fold(function(){return pt.error(e)},pt.value)}(dm.getCurrent(n),"missing current")}).map(al.getValue)})},setValue:function(t,n){Bn(n,function(e,n){Tc(t,r,n).each(function(n){dm.getCurrent(n).each(function(n){al.setValue(n,e)})})})}}})]),apis:{getField:function(n,e){return Tc(n,r,e).bind(dm.getCurrent)}}}},Mm=(Dc(function(n,e,t){return n.getField(e,t)}),function(n){var t,e=(t=[],{field:function(n,e){return t.push(n),function(n,e,t){return{uiType:za(),owner:n,name:e,config:t,validated:{}}}("form",yd(n),e)},record:function(){return t}}),r=n(e),o=e.record(),i=Se(o,function(n){return nf({name:n,pname:yd(n)})});return Rc("form",Cm,i,Dm,r)}),Im=function(n){return{xValue:n,points:[]}},Rm=function(n,e){if(e===n.xValue)return n;var t=0<e-n.xValue?1:-1,r={direction:t,xValue:e};return{xValue:e,points:(0===n.points.length?[]:n.points[n.points.length-1].direction===t?n.points.slice(0,n.points.length-1):n.points).concat([r])}},Am=function(n){if(0===n.points.length)return 0;var e=n.points[0].direction,t=n.points[n.points.length-1].direction;return-1===e&&-1===t?-1:1===e&&1===t?1:0},Fm=h(function(t,r){return[{label:"the link group",items:[wd({fields:[fd("url","Type or paste URL"),fd("text","Link text"),fd("title","Link title"),fd("target","Link target"),function(n){return{name:n,spec:gm.sketch({dom:{tag:"span",styles:{display:"none"}},getInitialValue:function(){return Rn.none()}})}}("link")],maxFieldIndex:["url","text","title","target"].length-1,getInitialValue:function(){return Rn.some(um.getInfo(r))},onExecute:function(n){var e=al.getValue(n);um.applyInfo(r,e),t.restoreToolbar(),r.focus()}})]}]}),Bm=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],Vm=Br([(rm=Ae(),om=function(n,e){var t=e.event().originator(),r=e.event().target();return!function(n,e,t){return on(e,n.element())&&!on(e,t)}(n,t,r)||(d.console.warn(Ae()+" did not get interpreted by the desired target. \nOriginator: "+vo(t)+"\nTarget: "+vo(r)+"\nCheck the "+Ae()+" event handlers"),!1)},{key:rm,value:or({can:om})})]),Nm=/* */Object.freeze({events:Vm}),jm=y,_m=Sd(),Hm=function(n,e){return function(n,e){return{cHandler:n,purpose:v(e)}}(l.apply(undefined,[n.handler].concat(e)),n.purpose())},Pm=function(n,i){var e=Nn(n,function(r,o){return(1===r.length?pt.value(r[0].handler()):Dd(r,i,o)).map(function(n){var e=Cd(n),t=1<r.length?M(i[o],function(e){return C(r,function(n){return n.name()===e})}).join(" > "):r[0].name();return On(o,function(n,e){return{handler:n,purpose:v(e)}}(e,t))})});return En(e,{})},zm=function(n){var e=$t("external.component",jt([Xt("element"),Kt("uid")]),n),t=Ho(Sd());e.uid.each(function(n){lf(e.element,n)});var r={getSystem:t.get,config:Rn.none,hasConfigured:v(!1),connect:function(n){t.set(n)},disconnect:function(){t.set(Sd(function(){return r}))},getApis:function(){return{}},element:v(e.element),spec:v(n),readState:v("No state"),syncComponents:x,components:v([]),events:v({})};return Cc(r)},Lm=Mc,Gm=function(e){return function(n){return Et(n,uf)}(e).fold(function(){var n=e.hasOwnProperty("uid")?e:b({uid:Lm("")},e);return jd(n).getOrDie()},function(n){return n})},Um=Cc,$m="alloy.item-hover",Wm="alloy.item-focus",Xm=v($m),qm=v(Wm),Ym=[Xt("data"),Xt("components"),Xt("dom"),nr("hasSubmenu",!1),Kt("toggling"),Ba("itemBehaviours",[Ri,Pi,Fa,al]),nr("ignoreFocus",!1),nr("domModification",{}),Zo("builder",function(n){return{dom:n.dom,domModification:b(b({},n.domModification),{attributes:b(b(b({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Va(n.itemBehaviours,[n.toggling.fold(Ri.revoke,function(n){return Ri.config(b({aria:{mode:"checked"}},n))}),Pi.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){Pd(n)}}),Fa.config({mode:"execution"}),al.config({store:{mode:"memory",initialValue:n.data}}),fm("item-type-events",[Nr(He(),U),Pr(Pn()),Nr(Gn(),Hd),Nr(je(),Pi.focus)])]),components:n.components,eventOrder:n.eventOrder}}),nr("eventOrder",{})],Km=[Xt("dom"),Xt("components"),Zo("builder",function(n){return{dom:n.dom,components:n.components,events:Br([function(n){return Nr(n,function(n,e){e.stop()})}(je())])}})],Jm=v([nf({name:"widget",overrides:function(e){return{behaviours:Ao([al.config({store:{mode:"manual",getValue:function(n){return e.data},setValue:function(){}}})])}}})]),Qm=[Xt("uid"),Xt("data"),Xt("components"),Xt("dom"),nr("autofocus",!1),nr("ignoreFocus",!1),Ba("widgetBehaviours",[al,Pi,Fa]),nr("domModification",{}),Ec(Jm()),Zo("builder",function(t){function r(n){return Tc(n,t,"widget").map(function(n){return Fa.focusIn(n),n})}function n(n,e){return Du(e.event().target())||t.autofocus&&e.setSource(n.element()),Rn.none()}var e=wc(0,t,Jm()),o=Sc("item-widget",t,e.internals());return{dom:t.dom,components:o,domModification:t.domModification,events:Br([Co(function(n,e){r(n).each(function(n){e.stop()})}),Nr(Gn(),Hd),Nr(je(),function(n,e){t.autofocus?r(n):Pi.focus(n)})]),behaviours:Va(t.widgetBehaviours,[al.config({store:{mode:"memory",initialValue:t.data}}),Pi.config({ignore:t.ignoreFocus,onFocus:function(n){Pd(n)}}),Fa.config({mode:"special",focusIn:t.autofocus?function(n){r(n)}:Vo(),onLeft:n,onRight:n,onEscape:function(n,e){return Pi.isFocused(n)||t.autofocus?(t.autofocus&&e.setSource(n.element()),Rn.none()):(Pi.focus(n),Rn.some(!0))}})])}})],Zm=Wt("type",{widget:Qm,item:Ym,separator:Km}),ng=v([tf({factory:{sketch:function(n){var e=$t("menu.spec item",Zm,n);return e.builder(e)}},name:"items",unit:"item",defaults:function(n,e){return e.hasOwnProperty("uid")?e:b(b({},e),{uid:Mc("item")})},overrides:function(n,e){return{type:e.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),eg=v([Xt("value"),Xt("items"),Xt("dom"),Xt("components"),nr("eventOrder",{}),lc("menuBehaviours",[ku,al,dm,Fa]),er("movement",{mode:"menu",moveOnTab:!0},Wt("mode",{grid:[Ti(),Zo("config",function(n,e){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:e.initSize.numColumns,numRows:e.initSize.numRows},focusManager:n.focusManager}})],matrix:[Zo("config",function(n,e){return{mode:"matrix",selectors:{row:e.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}}),Xt("rowSelector")],menu:[nr("moveOnTab",!0),Zo("config",function(n,e){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:e.moveOnTab,focusManager:n.focusManager}})]})),qt("markers",wi()),nr("fakeFocus",!1),nr("focusManager",mu()),Yo("onHighlight")]),tg=v("alloy.menu-focus"),rg=pf({name:"Menu",configFields:eg(),partFields:ng(),factory:function(n,e,t,r){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:mc(n.menuBehaviours,[ku.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),al.config({store:{mode:"memory",initialValue:n.value}}),dm.config({find:Rn.some}),Fa.config(n.movement.config(n,n.movement))]),events:Br([Nr(qm(),function(e,t){var n=t.event();e.getSystem().getByDom(n.target()).each(function(n){ku.highlight(e,n),t.stop(),G(e,tg(),{menu:e,item:n})})}),Nr(Xm(),function(n,e){var t=e.event().item();ku.highlight(n,t)})]),components:e,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),og=function(n,e){return n.components()},ig=Wr({fields:[],name:"replacing",apis:/* */Object.freeze({append:function(n,e,t,r){zd(n,0,ct,r)},prepend:function(n,e,t,r){zd(n,0,ln,r)},remove:Ld,replaceAt:Gd,replaceBy:function(e,n,t,r,o){var i=og(e);return F(i,r).bind(function(n){return Gd(e,0,0,n,o)})},set:function(e,n,t,r){!function(n){var e=n.components();D(e,pn),mn(n.element()),n.syncComponents()}(e),function(n,t){var r=un(t),e=so(r).bind(function(e){function n(n){return on(e,n)}return n(t)?Rn.some(t):Fr(t,n)}),o=n(t);e.each(function(e){so(r).filter(function(n){return on(n,e)}).fold(function(){ao(e)},x)})}(function(){var n=Se(r,e.getSystem().build);D(n,function(n){gn(e,n)})},e.element())},contents:og})}),ug=function(t,r,o,n){return Et(o,n).bind(function(n){return Et(t,n).bind(function(n){var e=ug(t,r,o,n);return Rn.some([n].concat(e))})}).getOr([])},cg=function(){function e(n){return Et(u.get(),n)}var i=Ho({}),u=Ho({}),c=Ho({}),a=Ho(Rn.none()),f=Ho({});return{setMenuBuilt:function(n,e){var t;u.set(b(b({},u.get()),((t={})[n]={type:"prepared",menu:e},t)))},setContents:function(n,e,t,r){a.set(Rn.some(n)),i.set(t),u.set(e),f.set(r);var o=Ud(r,t);c.set(o)},expand:function(t){return Et(i.get(),t).map(function(n){var e=Et(c.get(),t).getOr([]);return[n].concat(e)})},refresh:function(n){return Et(c.get(),n)},collapse:function(n){return Et(c.get(),n).bind(function(n){return 1<n.length?Rn.some(n.slice(1)):Rn.none()})},lookupMenu:e,otherMenus:function(n){var e=f.get();return function(n,e){return M(n,function(n){return!E(e,n)})}(An(e),n)},getPrimary:function(){return a.get().bind(function(n){return e(n).bind(function(n){return"prepared"===n.type?Rn.some(n.menu):Rn.none()})})},getMenus:function(){return u.get()},clear:function(){i.set({}),u.set({}),c.set({}),a.set(Rn.none())},isClear:function(){return a.get().isNone()}}},ag=v("collapse-item"),fg=gf({name:"TieredMenu",configFields:[Qo("onExecute"),Qo("onEscape"),Jo("onOpenMenu"),Jo("onOpenSubmenu"),Yo("onCollapseMenu"),nr("highlightImmediately",!0),Yt("data",[Xt("primary"),Xt("menus"),Xt("expansions")]),nr("fakeFocus",!1),Yo("onHighlight"),Yo("onHover"),Yt("markers",[Xt("backgroundMenu")].concat(bi()).concat(xi())),Xt("dom"),nr("navigateOnHover",!0),nr("stayInDom",!1),lc("tmenuBehaviours",[Fa,ku,dm,ig]),nr("eventOrder",{})],apis:{collapseMenu:function(n,e){n.collapseMenu(e)},highlightPrimary:function(n,e){n.highlightPrimary(e)}},factory:function(c,n){function r(r,o,n){return w(n,function(n,e){function t(){return rg.sketch(b(b({dom:n.dom},n),{value:e,items:n.items,markers:c.markers,fakeFocus:c.fakeFocus,onHighlight:c.onHighlight,focusManager:c.fakeFocus?function(){function o(n){return ku.getHighlighted(n).map(function(n){return n.element()})}return{get:o,set:function(e,n){var t=o(e);e.getSystem().getByDom(n).fold(x,function(n){ku.highlight(e,n)});var r=o(e);du(e,t,r)}}}():mu()}))}return e===o?{type:"prepared",menu:r.getSystem().build(t())}:{type:"notbuilt",nbMenu:t}})}function a(n){return al.getValue(n).value}function u(e,n){ku.highlight(e,n),ku.getHighlighted(n).orThunk(function(){return ku.getFirst(n)}).each(function(n){$(e,n.element(),je())})}function f(e,n){return yo(Se(n,function(n){return e.lookupMenu(n).bind(function(n){return"prepared"===n.type?Rn.some(n.menu):Rn.none()})}))}function s(e,n,t){var r=f(n,n.otherMenus(t));D(r,function(n){Rd(n.element(),[c.markers.backgroundMenu]),c.stayInDom||ig.remove(e,n)})}function l(n,r){var e=function(r){return o.get().getOrThunk(function(){var t={},n=Xi(r.element(),"."+c.markers.item),e=M(n,function(n){return"true"===Kr(n,"aria-haspopup")});return D(e,function(n){r.getSystem().getByDom(n).each(function(n){var e=a(n);t[e]=n})}),o.set(Rn.some(t)),t})}(n);Bn(e,function(n,e){var t=E(r,e);qr(n.element(),"aria-expanded",t)})}function d(r,o,i){return Rn.from(i[0]).bind(function(n){return o.lookupMenu(n).bind(function(n){if("notbuilt"===n.type)return Rn.none();var e=n.menu,t=f(o,i.slice(1));return D(t,function(n){ro(n.element(),c.markers.backgroundMenu)}),q(e.element())||ig.append(r,Um(e)),Rd(e.element(),[c.markers.backgroundMenu]),u(r,e),s(r,o,i),Rn.some(e)})})}var m,e,o=Ho(Rn.none()),g=cg(),i=function(n){return w(c.data.menus,function(n,e){return V(n.items,function(n){return"separator"===n.type?[]:[n.data.value]})})};(e=m=m||{})[e.HighlightSubmenu=0]="HighlightSubmenu",e[e.HighlightParent=1]="HighlightParent";function p(o,i,u){void 0===u&&(u=m.HighlightSubmenu);var n=a(i);return g.expand(n).bind(function(r){return l(o,r),Rn.from(r[0]).bind(function(t){return g.lookupMenu(t).bind(function(n){var e=function(n,e,t){if("notbuilt"!==t.type)return t.menu;var r=n.getSystem().build(t.nbMenu());return g.setMenuBuilt(e,r),r}(o,t,n);return q(e.element())||ig.append(o,Um(e)),c.onOpenSubmenu(o,i,e),u===m.HighlightSubmenu?(ku.highlightFirst(e),d(o,g,r)):(ku.dehighlightAll(e),Rn.some(i))})})})}function h(e,t){var n=a(t);return g.collapse(n).bind(function(n){return l(e,n),d(e,g,n).map(function(n){return c.onCollapseMenu(e,t,n),n})})}function t(t){return function(e,n){return Ji(n.getSource(),"."+c.markers.item).bind(function(n){return e.getSystem().getByDom(n).toOption().bind(function(n){return t(e,n).map(function(){return!0})})})}}var v=Br([Nr(tg(),function(e,n){var t=n.event().menu();ku.highlight(e,t);var r=a(n.event().item());g.refresh(r).each(function(n){return s(e,g,n)})}),Co(function(e,n){var t=n.event().target();e.getSystem().getByDom(t).each(function(n){0===a(n).indexOf("collapse-item")&&h(e,n),p(e,n,m.HighlightSubmenu).fold(function(){c.onExecute(e,n)},function(){})})}),Oo(function(e,n){(function(n){var e=r(n,c.data.primary,c.data.menus),t=i();return g.setContents(c.data.primary,e,c.data.expansions,t),g.getPrimary()})(e).each(function(n){ig.append(e,Um(n)),c.onOpenMenu(e,n),c.highlightImmediately&&u(e,n)})})].concat(c.navigateOnHover?[Nr(Xm(),function(n,e){var t=e.event().item();!function(e,n){var t=a(n);g.refresh(t).bind(function(n){return l(e,n),d(e,g,n)})}(n,t),p(n,t,m.HighlightParent),c.onHover(n,t)})]:[])),y={collapseMenu:function(e){ku.getHighlighted(e).each(function(n){ku.getHighlighted(n).each(function(n){h(e,n)})})},highlightPrimary:function(e){g.getPrimary().each(function(n){u(e,n)})}};return{uid:c.uid,dom:c.dom,markers:c.markers,behaviours:mc(c.tmenuBehaviours,[Fa.config({mode:"special",onRight:t(function(n,e){return Du(e.element())?Rn.none():p(n,e,m.HighlightSubmenu)}),onLeft:t(function(n,e){return Du(e.element())?Rn.none():h(n,e)}),onEscape:t(function(n,e){return h(n,e).orThunk(function(){return c.onEscape(n,e).map(function(){return n})})}),focusIn:function(e,n){g.getPrimary().each(function(n){$(e,n.element(),je())})}}),ku.config({highlightClass:c.markers.selectedMenu,itemClass:c.markers.menu}),dm.config({find:function(n){return ku.getHighlighted(n)}}),ig.config({})]),eventOrder:c.eventOrder,apis:y,events:v}},extraApis:{tieredData:function(n,e,t){return{primary:n,menus:e,expansions:t}},singleData:function(n,e){return{primary:n,menus:On(n,e),expansions:{}}},collapseItem:function(n){return{value:hc(ag()),meta:{text:n}}}}}),sg=function(n,e,t,r){return $d(0,e,0,r).bind(function(e){return e.transition.map(function(n){return{transition:n,route:e}})})},lg=function(n,e,t){var r=n.element();return Jr(r,e.destinationAttr)?Rn.some({start:Kr(n.element(),e.stateAttr),destination:Kr(n.element(),e.destinationAttr)}):Rn.none()},dg=/* */Object.freeze({findRoute:$d,disableTransition:Wd,getCurrentRoute:lg,jumpTo:Xd,progressTo:function(t,r,o,i){!function(n,e){Jr(n.element(),e.destinationAttr)&&(qr(n.element(),e.stateAttr,Kr(n.element(),e.destinationAttr)),Qr(n.element(),e.destinationAttr))}(t,r);var n=function(n,e,t,r){return{start:Kr(n.element(),e.stateAttr),destination:r}}(t,r,0,i);sg(t,r,o,n).fold(function(){Xd(t,r,o,i)},function(n){Wd(t,r,o);var e=n.transition;ro(t.element(),e.transitionClass),qr(t.element(),r.destinationAttr,i)})},getState:function(n,e,t){var r=n.element();return Jr(r,e.stateAttr)?Rn.some(Kr(r,e.stateAttr)):Rn.none()}}),mg=/* */Object.freeze({events:function(o,i){return Br([Nr(Yn(),function(t,n){var r=n.event().raw();lg(t,o).each(function(e){$d(0,o,0,e).each(function(n){n.transition.each(function(n){r.propertyName===n.property&&(Xd(t,o,i,e.destination),o.onTransition(t,e))})})})}),Oo(function(n,e){Xd(n,o,i,o.initialState)})])}}),gg=[nr("destinationAttr","data-transitioning-destination"),nr("stateAttr","data-transitioning-state"),Xt("initialState"),Yo("onTransition"),Yo("onFinish"),qt("routes",Lt(pt.value,Lt(pt.value,jt([Zt("transition",[Xt("property"),Xt("transitionClass")])]))))],pg=Wr({fields:gg,name:"transitioning",active:mg,apis:dg,extra:{createRoutes:function(n){var r={};return Bn(n,function(n,e){var t=e.split("<->");r[t[0]]=On(t[1],n),r[t[1]]=On(t[0],n)}),r},createBistate:function(n,e,t){return kn([{key:n,value:On(e,t)},{key:e,value:On(n,t)}])},createTristate:function(n,e,t,r){return kn([{key:n,value:kn([{key:e,value:r},{key:t,value:r}])},{key:e,value:kn([{key:n,value:r},{key:t,value:r}])},{key:t,value:kn([{key:n,value:r},{key:e,value:r}])}])}}}),hg=Ni.resolve("scrollable"),vg={register:function(n){ro(n,hg)},deregister:function(n){io(n,hg)},scrollable:v(hg)},yg=function(n,e,t,r,o){return{data:{value:n,text:e},type:"item",dom:{tag:"div",classes:o?[Ni.resolve("styles-item-is-menu")]:[]},toggling:{toggleOnExecute:!1,toggleClass:Ni.resolve("format-matches"),selected:t},itemBehaviours:Ao(o?[]:[Ai(n,function(n,e){(e?Ri.on:Ri.off)(n)})]),components:[{dom:{tag:"div",attributes:{style:r},innerHtml:e}}]}},bg=function(n,e,t,r){return{value:n,dom:{tag:"div"},components:[Ps.sketch({dom:{tag:"div",classes:[Ni.resolve("styles-collapser")]},components:r?[{dom:{tag:"span",classes:[Ni.resolve("styles-collapse-icon")]}},_d(n)]:[_d(n)],action:function(n){if(r){var e=t().get(n);fg.collapseMenu(e)}}}),{dom:{tag:"div",classes:[Ni.resolve("styles-menu-items-container")]},components:[rg.parts().items({})],behaviours:Ao([fm("adhoc-scrollable-menu",[Oo(function(n,e){zi(n.element(),"overflow-y","auto"),zi(n.element(),"-webkit-overflow-scrolling","touch"),vg.register(n.element())}),ko(function(n){mi(n.element(),"overflow-y"),mi(n.element(),"-webkit-overflow-scrolling"),vg.deregister(n.element())})])])}],items:e,menuBehaviours:Ao([pg.config({initialState:"after",routes:pg.createTristate("before","current","after",{transition:{property:"transform",transitionClass:"transitioning"}})})])}},xg=function(r){var n=function(r,o){var n=bg("Styles",[].concat(Se(r.items,function(n){return yg(qd(n),n.title,n.isSelected(),n.getPreview(),Cn(r.expansions,qd(n)))})),o,!1),e=w(r.menus,function(n,e){var t=Se(n,function(n){return yg(qd(n),n.title,n.isSelected!==undefined&&n.isSelected(),n.getPreview!==undefined?n.getPreview():"",Cn(r.expansions,qd(n)))});return bg(e,t,o,!0)}),t=yt(e,On("styles",n));return{tmenu:fg.tieredData("styles",t,r.expansions)}}(r.formats,function(){return e}),e=Vs(fg.sketch({dom:{tag:"div",classes:[Ni.resolve("styles-menu")]},components:[],fakeFocus:!0,stayInDom:!0,onExecute:function(n,e){var t=al.getValue(e);return r.handle(e,t.value),Rn.none()},onEscape:function(){return Rn.none()},onOpenMenu:function(n,e){var t=Cf(n.element());Ef(e.element(),t),pg.jumpTo(e,"current")},onOpenSubmenu:function(n,e,t){var r=Cf(n.element()),o=Yi(e.element(),'[role="menu"]').getOrDie("hacky"),i=n.getSystem().getByDom(o).getOrDie();Ef(t.element(),r),pg.progressTo(i,"before"),pg.jumpTo(t,"after"),pg.progressTo(t,"current")},onCollapseMenu:function(n,e,t){var r=Yi(e.element(),'[role="menu"]').getOrDie("hacky"),o=n.getSystem().getByDom(r).getOrDie();pg.progressTo(o,"after"),pg.progressTo(t,"current")},navigateOnHover:!1,highlightImmediately:!0,data:n.tmenu,markers:{backgroundMenu:Ni.resolve("styles-background-menu"),menu:Ni.resolve("styles-menu"),selectedMenu:Ni.resolve("styles-selected-menu"),item:Ni.resolve("styles-item"),selectedItem:Ni.resolve("styles-selected-item")}}));return e.asSpec()},wg=function(n){return I(n,function(n,e){var t=Yd(e);return{menus:yt(n.menus,t.menus),items:[t.item].concat(n.items),expansions:yt(n.expansions,t.expansions)}},{menus:{},expansions:{},items:[]})},Sg={expand:wg},Tg=function(r,n){function o(n){return function(){return r.formatter.match(n)}}function i(n){return function(){return r.formatter.getCssText(n)}}var e=Et(n,"style_formats").getOr(Bm),t=function(n){return Se(n,function(n){if(Cn(n,"items")){var e=t(n.items);return yt(function(n){return yt(n,{isSelected:v(!1),getPreview:v("")})}(n),{items:e})}return Cn(n,"format")?function(n){return yt(n,{isSelected:o(n.format),getPreview:i(n.format)})}(n):function(n){var e=hc(n.title),t=yt(n,{format:e,isSelected:o(e),getPreview:i(e)});return r.formatter.register(e,t),t}(n)})};return t(e)},Og=function(t,n,r){var e=function(e,n){var t=function(n){return V(n,function(n){return n.items===undefined?!Cn(n,"format")||e.formatter.canApply(n.format)?[n]:[]:0<t(n.items).length?[n]:[]})},r=t(n);return Sg.expand(r)}(t,n);return xg({formats:e,handle:function(n,e){t.undoManager.transact(function(){Ri.isOn(n)?t.formatter.remove(e):t.formatter.apply(e)}),r()}})},kg=["undo","bold","italic","link","image","bullist","styleselect"],Eg=function(n){return V(n,function(n){return pe(n)?Eg(n):Kd(n)})},Cg=function(e,r){function n(n){return function(){return Us.forToolbarCommand(r,n)}}function t(n){return function(){return Us.forToolbarStateCommand(r,n)}}function o(n,e,t){return function(){return Us.forToolbarStateAction(r,n,e,t)}}function i(){return Og(r,h,function(){r.fire("scrollIntoView")})}function u(n,e){return{isSupported:function(){var e=r.ui.registry.getAll().buttons;return n.forall(function(n){return Cn(e,n)})},sketch:e}}var c=n("undo"),a=n("redo"),f=t("bold"),s=t("italic"),l=t("underline"),d=n("removeformat"),m=o("unlink","link",function(){r.execCommand("unlink",null,!1)}),g=o("unordered-list","ul",function(){r.execCommand("InsertUnorderedList",null,!1)}),p=o("ordered-list","ol",function(){r.execCommand("InsertOrderedList",null,!1)}),h=Tg(r,r.settings);return{undo:u(Rn.none(),c),redo:u(Rn.none(),a),bold:u(Rn.none(),f),italic:u(Rn.none(),s),underline:u(Rn.none(),l),removeformat:u(Rn.none(),d),link:u(Rn.none(),function(){return function(e,t){return Us.forToolbarStateAction(t,"link","link",function(){var n=Fm(e,t);e.setContextToolbar(n),am(t,function(){e.focusToolbar()}),um.query(t).each(function(n){t.selection.select(n.dom())})})}(e,r)}),unlink:u(Rn.none(),m),image:u(Rn.none(),function(){return nd(r)}),bullist:u(Rn.some("bullist"),g),numlist:u(Rn.some("numlist"),p),fontsizeselect:u(Rn.none(),function(){return function(n,e){var t={onChange:function(n){zl.apply(e,n)},getInitialValue:function(){return zl.get(e)}};return Rs(n,"font-size",function(){return Bs(t)},e)}(e,r)}),forecolor:u(Rn.none(),function(){return jl(e,r)}),styleselect:u(Rn.none(),function(){return Us.forToolbar("style-formats",function(n){r.fire("toReading"),e.dropup().appear(i,Ri.on,n)},Ao([Ri.config({toggleClass:Ni.resolve("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),ki.config({channels:kn([Bi(Go.orientationChanged(),Ri.off),Bi(Go.dropupDismissed(),Ri.off)])})]),r)})}},Dg=function(n,t){var e=Jd(n),r={};return V(e,function(n){var e=!Cn(r,n)&&Cn(t,n)&&t[n].isSupported()?[t[n].sketch()]:[];return r[n]=!0,e})},Mg=function(n,e,t,r){n.dom().removeEventListener(e,t,r)},Ig=v(!0),Rg=tinymce.util.Tools.resolve("tinymce.util.Delay"),Ag=tm,Fg=function(r,e){var n=Ye.fromDom(r),o=null,t=nm(n,"orientationchange",function(){Rg.clearInterval(o);var n=tm(r);e.onChange(n),i(function(){e.onReady(n)})}),i=function(n){Rg.clearInterval(o);var e=r.innerHeight,t=0;o=Rg.setInterval(function(){e!==r.innerHeight?(Rg.clearInterval(o),n(Rn.some(r.innerHeight))):20<t&&(Rg.clearInterval(o),n(Rn.none())),t++},50)};return{onAdjustment:i,destroy:function(){t.unbind()}}},Bg=function(n){var e=Ie.detect().os.isiOS(),t=tm(n).isPortrait();return e&&!t?n.screen.height:n.screen.width};function Vg(n){var e=n.raw();return e.touches===undefined||1!==e.touches.length?Rn.none():Rn.some(e.touches[0])}function Ng(t){var r=Ho(Rn.none()),o=function n(t,r){var o=null;return{cancel:function(){null!==o&&(d.clearTimeout(o),o=null)},schedule:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];o=d.setTimeout(function(){t.apply(null,n),o=null},r)}}}(function(n){r.set(Rn.none()),t.triggerEvent(Pe(),n)},400),i=kn([{key:jn(),value:function(t){return Vg(t).each(function(n){o.cancel();var e={x:v(n.clientX),y:v(n.clientY),target:t.target};o.schedule(t),r.set(Rn.some(e))}),Rn.none()}},{key:_n(),value:function(n){return o.cancel(),Vg(n).each(function(e){r.get().each(function(n){!function(n,e){var t=Math.abs(n.clientX-e.x()),r=Math.abs(n.clientY-e.y());return 5<t||5<r}(e,n)||r.set(Rn.none())})}),Rn.none()}},{key:Hn(),value:function(e){o.cancel();return r.get().filter(function(n){return on(n.target(),e.target())}).map(function(n){return t.triggerEvent(_e(),e)})}}]);return{fireIfReady:function(e,n){return Et(i,n).bind(function(n){return n(e)})}}}var jg=function(t){var e=Ng({triggerEvent:function(n,e){t.onTapContent(e)}});return{fireTouchstart:function(n){e.fireIfReady(n,"touchstart")},onTouchend:function(){return nm(t.body(),"touchend",function(n){e.fireIfReady(n,"touchend")})},onTouchmove:function(){return nm(t.body(),"touchmove",function(n){e.fireIfReady(n,"touchmove")})}}},_g=6<=Ie.detect().os.version.major,Hg=function(r,e,t){function o(n){return!on(n.start(),n.finish())||n.soffset()!==n.foffset()}function n(){var n=r.doc().dom().hasFocus()&&r.getSelection().exists(o);t.getByDom(e).each(!0===(n||so(u).filter(function(n){return"input"===W(n)}).exists(function(n){return n.dom().selectionStart!==n.dom().selectionEnd}))?Ri.on:Ri.off)}var i=jg(r),u=un(e),c=[nm(r.body(),"touchstart",function(n){r.onTouchContent(),i.fireTouchstart(n)}),i.onTouchmove(),i.onTouchend(),nm(e,"touchstart",function(n){r.onTouchToolstrip()}),r.onToReading(function(){fo(r.body())}),r.onToEditing(x),r.onScrollToCursor(function(n){n.preventDefault(),r.getCursorBox().each(function(n){var e=r.win(),t=n.top()>e.innerHeight||n.bottom()>e.innerHeight?n.bottom()-e.innerHeight+50:0;0!=t&&e.scrollTo(e.pageXOffset,e.pageYOffset+t)})})].concat(!0==_g?[]:[nm(Ye.fromDom(r.win()),"blur",function(){t.getByDom(e).each(Ri.off)}),nm(u,"select",n),nm(r.doc(),"selectionchange",n)]);return{destroy:function(){D(c,function(n){n.unbind()})}}},Pg=function(n,e){var t=parseInt(Kr(n,e),10);return isNaN(t)?0:t};function zg(n){return Cp.getOption(n)}function Lg(n){return function(n){return zg(n).filter(function(n){return 0!==n.trim().length||-1<n.indexOf("\xa0")}).isSome()}(n)||E(Dp,W(n))}function Gg(n,e,t){var r=n.document.createRange();return function(t,n){n.fold(function(n){t.setStartBefore(n.dom())},function(n,e){t.setStart(n.dom(),e)},function(n){t.setStartAfter(n.dom())})}(r,e),function(t,n){n.fold(function(n){t.setEndBefore(n.dom())},function(n,e){t.setEnd(n.dom(),e)},function(n){t.setEndAfter(n.dom())})}(r,t),r}function Ug(n,e,t,r,o){var i=n.document.createRange();return i.setStart(e.dom(),t),i.setEnd(r.dom(),o),i}function $g(n){return{left:v(n.left),top:v(n.top),right:v(n.right),bottom:v(n.bottom),width:v(n.width),height:v(n.height)}}function Wg(n,e,t){return e(Ye.fromDom(t.startContainer),t.startOffset,Ye.fromDom(t.endContainer),t.endOffset)}function Xg(n,e){return function(n,e){var t=e.ltr();return t.collapsed?e.rtl().filter(function(n){return!1===n.collapsed}).map(function(n){return Bp.rtl(Ye.fromDom(n.endContainer),n.endOffset,Ye.fromDom(n.startContainer),n.startOffset)}).getOrThunk(function(){return Wg(0,Bp.ltr,t)}):Wg(0,Bp.ltr,t)}(0,function(o,n){return n.match({domRange:function(n){return{ltr:v(n),rtl:Rn.none}},relative:function(n,e){return{ltr:h(function(){return Gg(o,n,e)}),rtl:h(function(){return Rn.some(Gg(o,e,n))})}},exact:function(n,e,t,r){return{ltr:h(function(){return Ug(o,n,e,t,r)}),rtl:h(function(){return Rn.some(Ug(o,t,r,n,e))})}}})}(n,e))}function qg(n,e,t){return e>=n.left&&e<=n.right&&t>=n.top&&t<=n.bottom}function Yg(t,r,n,e,o){function i(n){var e=t.dom().createRange();return e.setStart(r.dom(),n),e.collapse(!0),e}var u=function(n){return Cp.get(n)}(r).length,c=function(n,e,t,r,o){if(0===o)return 0;if(e===r)return o-1;for(var i=r,u=1;u<o;u++){var c=n(u),a=Math.abs(e-c.left);if(t<=c.bottom){if(t<c.top||i<a)return u-1;i=a}}return 0}(function(n){return i(n).getBoundingClientRect()},n,e,o.right,u);return i(c)}function Kg(n){return Fr(n,Lg)}function Jg(n){return Np(n,Lg)}function Qg(n,e){return e-n.left<n.right-e}function Zg(n,e,t){var r=n.dom().createRange();return r.selectNode(e.dom()),r.collapse(t),r}function np(e,n,t){var r=e.dom().createRange();r.selectNode(n.dom());var o=r.getBoundingClientRect(),i=Qg(o,t);return(!0===i?Kg:Jg)(n).map(function(n){return Zg(e,n,i)})}function ep(n,e,t){var r=e.dom().getBoundingClientRect(),o=Qg(r,t);return Rn.some(Zg(n,e,o))}function tp(n,e,t,r){var o=n.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect();return function(n,e,t,r){var o=n.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,t)),c=Math.max(i.top,Math.min(i.bottom,r));return Vp(n,e,u,c)}(n,e,Math.max(i.left,Math.min(i.right,t)),Math.max(i.top,Math.min(i.bottom,r)))}function rp(n,e){var t=W(n);return"input"===t?Rp.after(n):E(["br","img"],t)?0===e?Rp.before(n):Rp.after(n):Rp.on(n,e)}function op(n,e,t,r){var o=function(n,e,t,r){var o=un(n).dom().createRange();return o.setStart(n.dom(),e),o.setEnd(t.dom(),r),o}(n,e,t,r),i=on(n,t)&&e===r;return o.collapsed&&!i}function ip(n,e,t,r,o){!function(n,e){Rn.from(n.getSelection()).each(function(n){n.removeAllRanges(),n.addRange(e)})}(n,Ug(n,e,t,r,o))}function up(n,e,t,r,o){!function(u,n){Xg(u,n).match({ltr:function(n,e,t,r){ip(u,n,e,t,r)},rtl:function(n,e,t,r){var o=u.getSelection();if(o.setBaseAndExtent)o.setBaseAndExtent(n.dom(),e,t.dom(),r);else if(o.extend)try{!function(n,e,t,r,o,i){e.collapse(t.dom(),r),e.extend(o.dom(),i)}(0,o,n,e,t,r)}catch(i){ip(u,t,r,n,e)}else ip(u,t,r,n,e)}})}(n,function(n,e,t,r){var o=rp(n,e),i=rp(t,r);return Fp.relative(o,i)}(e,t,r,o))}function cp(n){var e=Ye.fromDom(n.anchorNode),t=Ye.fromDom(n.focusNode);return op(e,n.anchorOffset,t,n.focusOffset)?Rn.some(Mp.create(e,n.anchorOffset,t,n.focusOffset)):function(n){if(0<n.rangeCount){var e=n.getRangeAt(0),t=n.getRangeAt(n.rangeCount-1);return Rn.some(Mp.create(Ye.fromDom(e.startContainer),e.startOffset,Ye.fromDom(t.endContainer),t.endOffset))}return Rn.none()}(n)}function ap(n){return Rn.from(n.getSelection()).filter(function(n){return 0<n.rangeCount}).bind(cp)}function fp(n,e){return function(n){var e=n.getClientRects(),t=0<e.length?e[0]:n.getBoundingClientRect();return 0<t.width||0<t.height?Rn.some(t).map($g):Rn.none()}(function(i,n){return Xg(i,n).match({ltr:function(n,e,t,r){var o=i.document.createRange();return o.setStart(n.dom(),e),o.setEnd(t.dom(),r),o},rtl:function(n,e,t,r){var o=i.document.createRange();return o.setStart(t.dom(),r),o.setEnd(n.dom(),e),o}})}(n,e))}function sp(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:v(2),height:n.height}}function lp(n){return{left:v(n.left),top:v(n.top),right:v(n.right),bottom:v(n.bottom),width:v(n.width),height:v(n.height)}}function dp(t){if(t.collapsed){var r=Ye.fromDom(t.startContainer);return cn(r).bind(function(n){var e=Fp.exact(r,t.startOffset,n,function(n){return"img"===W(n)?1:zg(n).fold(function(){return ut(n).length},function(n){return n.length})}(n));return fp(t.startContainer.ownerDocument.defaultView,e).map(sp).map(_)}).getOr([])}return Se(t.getClientRects(),lp)}function mp(n,e){qr(n,Hp,e)}function gp(n){return{top:v(n.top()),bottom:v(n.top()+n.height())}}function pp(n,e){var t=function(n){return Pg(n,Hp)}(e),r=n.innerHeight;return r<t?Rn.some(t-r):Rn.none()}function hp(n){return Rn.some(Ye.fromDom(n.dom().contentWindow.document.body))}function vp(n){return Rn.some(Ye.fromDom(n.dom().contentWindow.document))}function yp(n){return Rn.from(n.dom().contentWindow)}function bp(n){return yp(n).bind(ap)}function xp(n){return n.getFrame()}function wp(n,t){return function(e){return e[n].getOrThunk(function(){var n=xp(e);return function(){return t(n)}})()}}function Sp(n,e,t,r){return n[t].getOrThunk(function(){return function(n){return nm(e,r,n)}})}function Tp(n){return{left:v(n.left),top:v(n.top),right:v(n.right),bottom:v(n.bottom),width:v(n.width),height:v(n.height)}}function Op(t,r){var o=null;return{cancel:function(){null!==o&&(d.clearTimeout(o),o=null)},throttle:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];null!==o&&d.clearTimeout(o),o=d.setTimeout(function(){t.apply(null,n),o=null},r)}}}function kp(n){return"true"===Kr(n,ih)?function(n){return 0<n.dom().scrollLeft||function(n){n.dom().scrollLeft=1;var e=0!==n.dom().scrollLeft;return n.dom().scrollLeft=0,e}(n)}(n):function(n){return 0<n.dom().scrollTop||function(n){n.dom().scrollTop=1;var e=0!==n.dom().scrollTop;return n.dom().scrollTop=0,e}(n)}(n)}var Ep,Cp=function oy(t,r){var e=function(n){return t(n)?Rn.from(n.dom().nodeValue):Rn.none()};return{get:function(n){if(!t(n))throw new Error("Can only get "+r+" value of a "+r+" node");return e(n).getOr("")},getOption:e,set:function(n,e){if(!t(n))throw new Error("Can only set raw "+r+" value of a "+r+" node");n.dom().nodeValue=e}}}(nt,"text"),Dp=["img","br"],Mp={create:Y("start","soffset","finish","foffset")},Ip=ht([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Rp={before:Ip.before,on:Ip.on,after:Ip.after,cata:function(n,e,t,r){return n.fold(e,t,r)},getStart:function(n){return n.fold(y,y,y)}},Ap=ht([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Fp={domRange:Ap.domRange,relative:Ap.relative,exact:Ap.exact,exactFromRange:function(n){return Ap.exact(n.start(),n.soffset(),n.finish(),n.foffset())},getWin:function(n){return function(n){return Ye.fromDom(n.dom().ownerDocument.defaultView)}(function(n){return n.match({domRange:function(n){return Ye.fromDom(n.startContainer)},relative:function(n,e){return Rp.getStart(n)},exact:function(n,e,t,r){return n}})}(n))},range:Mp.create},Bp=ht([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Vp=function(n,e,t,r){return nt(e)?function(e,t,r,o){var n=e.dom().createRange();n.selectNode(t.dom());var i=n.getClientRects();return bo(i,function(n){return qg(n,r,o)?Rn.some(n):Rn.none()}).map(function(n){return Yg(e,t,r,o,n)})}(n,e,t,r):function(e,n,t,r){var o=e.dom().createRange(),i=ut(n);return bo(i,function(n){return o.selectNode(n.dom()),qg(o.getBoundingClientRect(),t,r)?Vp(e,n,t,r):Rn.none()})}(n,e,t,r)},Np=function(n,i){var u=function(n){for(var e=ut(n),t=e.length-1;0<=t;t--){var r=e[t];if(i(r))return Rn.some(r);var o=u(r);if(o.isSome())return o}return Rn.none()};return u(n)},jp=(document.caretPositionFromPoint||document.caretRangeFromPoint,function(n){var e=n.getSelection();return e!==undefined&&0<e.rangeCount?dp(e.getRangeAt(0)):[]}),_p=function(n){n.focus();var e=Ye.fromDom(n.document.body);(so().exists(function(n){return E(["input","textarea"],W(n))})?function(n){Rg.setTimeout(function(){n()},0)}:t)(function(){so().each(fo),ao(e)})},Hp="data-"+Ni.resolve("last-outer-height"),Pp=function(n,r){var e=Ye.fromDom(r.document.body),t=nm(Ye.fromDom(n),"resize",function(){pp(n,e).each(function(t){(function(n){var e=jp(n);return 0<e.length?Rn.some(e[0]).map(gp):Rn.none()})(r).each(function(n){var e=function(n,e,t){return e.top()>n.innerHeight||e.bottom()>n.innerHeight?Math.min(t,e.bottom()-n.innerHeight+50):0}(r,n,t);0!==e&&r.scrollTo(r.pageXOffset,r.pageYOffset+e)})}),mp(e,n.innerHeight)});mp(e,n.innerHeight);return{toEditing:function(){_p(r)},destroy:function(){t.unbind()}}},zp={getBody:wp("getBody",hp),getDoc:wp("getDoc",vp),getWin:wp("getWin",yp),getSelection:wp("getSelection",bp),getFrame:xp,getActiveApi:function(c){var a=xp(c);return hp(a).bind(function(u){return vp(a).bind(function(i){return yp(a).map(function(o){var n=Ye.fromDom(i.dom().documentElement),e=c.getCursorBox.getOrThunk(function(){return function(){return function(n){return ap(n).map(function(n){return Fp.exact(n.start(),n.soffset(),n.finish(),n.foffset())})}(o).bind(function(n){return fp(o,n).orThunk(function(){return function(n){return ap(n).filter(function(n){return on(n.start(),n.finish())&&n.soffset()===n.foffset()}).bind(function(n){var e=n.start().dom().getBoundingClientRect();return 0<e.width||0<e.height?Rn.some(e).map(Tp):Rn.none()})}(o)})})}}),t=c.setSelection.getOrThunk(function(){return function(n,e,t,r){up(o,n,e,t,r)}}),r=c.clearSelection.getOrThunk(function(){return function(){!function(n){n.getSelection().removeAllRanges()}(o)}});return{body:v(u),doc:v(i),win:v(o),html:v(n),getSelection:l(bp,a),setSelection:t,clearSelection:r,frame:v(a),onKeyup:Sp(c,i,"onKeyup","keyup"),onNodeChanged:Sp(c,i,"onNodeChanged","SelectionChange"),onDomChanged:c.onDomChanged,onScrollToCursor:c.onScrollToCursor,onScrollToElement:c.onScrollToElement,onToReading:c.onToReading,onToEditing:c.onToEditing,onToolbarScrollStart:c.onToolbarScrollStart,onTouchContent:c.onTouchContent,onTapContent:c.onTapContent,onTouchToolstrip:c.onTouchToolstrip,getCursorBox:e}})})})}},Lp="data-ephox-mobile-fullscreen-style",Gp="position:absolute!important;",Up="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",$p=Ie.detect().os.isAndroid(),Wp=function(n,e){function t(r){return function(n){var e=Kr(n,"style"),t=e===undefined?"no-styles":e.trim();t!==r&&(qr(n,Lp,t),qr(n,"style",r))}}var r=function(n,e,t){return $i(n,function(n){return nn(n,e)},t)}(n,"*"),o=V(r,function(n){return function(n,e){return Wi(n,function(n){return nn(n,e)})}(n,"*")}),i=function(n){var e=li(n,"background-color");return e!==undefined&&""!==e?"background-color:"+e+"!important":"background-color:rgb(255,255,255)!important;"}(e);D(o,t("display:none!important;")),D(r,t(Gp+Up+i)),t((!0===$p?"":Gp)+Up+i)(n)},Xp=function(){var n=function(n){return tn(n)}("["+Lp+"]");D(n,function(n){var e=Kr(n,Lp);"no-styles"!==e?qr(n,"style",e):Qr(n,"style"),Qr(n,Lp)})},qp=function(){var e=qi("head").getOrDie(),n=qi('meta[name="viewport"]').getOrThunk(function(){var n=Ye.fromTag("meta");return qr(n,"name","viewport"),ct(e,n),n}),t=Kr(n,"content");return{maximize:function(){qr(n,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},restore:function(){t!==undefined&&null!==t&&0<t.length?qr(n,"content",t):qr(n,"content","user-scalable=yes")}}},Yp=function(e,n){var t=qp(),r=bd(),o=bd();return{enter:function(){n.hide(),ro(e.container,Ni.resolve("fullscreen-maximized")),ro(e.container,Ni.resolve("android-maximized")),t.maximize(),ro(e.body,Ni.resolve("android-scroll-reload")),r.set(Pp(e.win,zp.getWin(e.editor).getOrDie("no"))),zp.getActiveApi(e.editor).each(function(n){Wp(e.container,n.body()),o.set(Hg(n,e.toolstrip,e.alloy))})},exit:function(){t.restore(),n.show(),io(e.container,Ni.resolve("fullscreen-maximized")),io(e.container,Ni.resolve("android-maximized")),Xp(),io(e.body,Ni.resolve("android-scroll-reload")),o.clear(),r.clear()}}},Kp=function(n,e){var t=Vs(mm.sketch({dom:Ls('<div aria-hidden="true" class="${prefix}-mask-tap-icon"></div>'),containerBehaviours:Ao([Ri.config({toggleClass:Ni.resolve("mask-tap-icon-selected"),toggleOnExecute:!1})])})),r=function(t,r){var o=null;return{cancel:function(){null!==o&&(d.clearTimeout(o),o=null)},throttle:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];null===o&&(o=d.setTimeout(function(){t.apply(null,n),o=null},r))}}}(n,200);return mm.sketch({dom:Ls('<div class="${prefix}-disabled-mask"></div>'),components:[mm.sketch({dom:Ls('<div class="${prefix}-content-container"></div>'),components:[Ps.sketch({dom:Ls('<div class="${prefix}-content-tap-section"></div>'),components:[t.asSpec()],action:function(n){r.throttle()},buttonBehaviours:Ao([Ri.config({toggleClass:Ni.resolve("mask-tap-icon-selected")})])})]})]})},Jp=Sr([Yt("editor",[Xt("getFrame"),Kt("getBody"),Kt("getDoc"),Kt("getWin"),Kt("getSelection"),Kt("setSelection"),Kt("clearSelection"),Kt("cursorSaver"),Kt("onKeyup"),Kt("onNodeChanged"),Kt("getCursorBox"),Xt("onDomChanged"),nr("onTouchContent",x),nr("onTapContent",x),nr("onTouchToolstrip",x),nr("onScrollToCursor",v({unbind:x})),nr("onScrollToElement",v({unbind:x})),nr("onToEditing",v({unbind:x})),nr("onToReading",v({unbind:x})),nr("onToolbarScrollStart",y)]),Xt("socket"),Xt("toolstrip"),Xt("dropup"),Xt("toolbar"),Xt("container"),Xt("alloy"),tr("win",function(n){return un(n.socket).dom().defaultView}),tr("body",function(n){return Ye.fromDom(n.socket.dom().ownerDocument.body)}),nr("translate",y),nr("setReadOnly",x),nr("readOnlyOnInit",v(!0))]),Qp=function(n){var e=$t("Getting AndroidWebapp schema",Jp,n);zi(e.toolstrip,"width","100%");var t=Gm(Kp(function(){e.setReadOnly(e.readOnlyOnInit()),o.enter()},e.translate));e.alloy.add(t);var r={show:function(){e.alloy.add(t)},hide:function(){e.alloy.remove(t)}};ct(e.container,t.element());var o=Yp(e,r);return{setReadOnly:e.setReadOnly,refreshStructure:x,enter:o.enter,exit:o.exit,destroy:x}},Zp=v([Xt("dom"),nr("shell",!0),lc("toolbarBehaviours",[ig])]),nh=v([ef({name:"groups",overrides:function(n){return{behaviours:Ao([ig.config({})])}}})]),eh=pf({name:"Toolbar",configFields:Zp(),partFields:nh(),factory:function(e,n,t,r){var o=function(n){return e.shell?Rn.some(n):Tc(n,e,"groups")},i=e.shell?{behaviours:[ig.config({})],components:[]}:{behaviours:[],components:n};return{uid:e.uid,dom:e.dom,components:i.components,behaviours:mc(e.toolbarBehaviours,i.behaviours),apis:{setGroups:function(n,e){o(n).fold(function(){throw d.console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(n){ig.set(n,e)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,e,t){n.setGroups(e,t)}}}),th=v([Xt("items"),(Ep=["itemSelector"],Yt("markers",Se(Ep,Xt))),lc("tgroupBehaviours",[Fa])]),rh=v([tf({name:"items",unit:"item"})]),oh=pf({name:"ToolbarGroup",configFields:th(),partFields:rh(),factory:function(n,e,t,r){return{uid:n.uid,dom:n.dom,components:e,behaviours:mc(n.tgroupBehaviours,[Fa.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),ih="data-"+Ni.resolve("horizontal-scroll"),uh={exclusive:function(n,e){return nm(n,"touchmove",function(n){Ji(n.target(),e).filter(kp).fold(function(){n.raw().preventDefault()},x)})},markAsHorizontal:function(n){qr(n,ih,"true")}};function ch(){function e(n){var e=!0===n.scrollable?"${prefix}-toolbar-scrollable-group":"";return{dom:Ls('<div aria-label="'+n.label+'" class="${prefix}-toolbar-group '+e+'"></div>'),tgroupBehaviours:Ao([fm("adhoc-scrollable-toolbar",!0===n.scrollable?[Eo(function(n,e){zi(n.element(),"overflow-x","auto"),uh.markAsHorizontal(n.element()),vg.register(n.element())})]:[])]),components:[mm.sketch({components:[oh.parts().items({})]})],markers:{itemSelector:"."+Ni.resolve("toolbar-group-item")},items:n.items}}function t(){eh.setGroups(r,o.get()),Ri.off(r)}var r=Gm(eh.sketch({dom:Ls('<div class="${prefix}-toolbar"></div>'),components:[eh.parts().groups({})],toolbarBehaviours:Ao([Ri.config({toggleClass:Ni.resolve("context-toolbar"),toggleOnExecute:!1,aria:{mode:"none"}}),Fa.config({mode:"cyclic"})]),shell:!0})),n=Gm(mm.sketch({dom:{classes:[Ni.resolve("toolstrip")]},components:[Um(r)],containerBehaviours:Ao([Ri.config({toggleClass:Ni.resolve("android-selection-context-toolbar"),toggleOnExecute:!1})])})),o=Ho([]);return{wrapper:v(n),toolbar:v(r),createGroups:function(n){return Se(n,a(oh.sketch,e))},setGroups:function(n){o.set(n),t()},setContextToolbar:function(n){Ri.on(r),eh.setGroups(r,n)},restoreToolbar:function(){Ri.isOn(r)&&t()},refresh:function(){},focus:function(){Fa.focusIn(r)}}}function ah(n,e){ig.append(n,Um(e))}function fh(n,e){ig.remove(n,e)}function sh(e,n){return n.getAnimationRoot.fold(function(){return e.element()},function(n){return n(e)})}function lh(n){return n.dimension.property}function dh(n,e){return n.dimension.getDimension(e)}function mh(n,e){var t=sh(n,e);Rd(t,[e.shrinkingClass,e.growingClass])}function gh(n,e){io(n.element(),e.openClass),ro(n.element(),e.closedClass),zi(n.element(),lh(e),"0px"),gi(n.element())}function ph(n,e){io(n.element(),e.closedClass),ro(n.element(),e.openClass),mi(n.element(),lh(e))}function hh(n,e,t,r){t.setCollapsed(),zi(n.element(),lh(e),dh(e,n.element())),gi(n.element()),mh(n,e),gh(n,e),e.onStartShrink(n),e.onShrunk(n)}function vh(n,e,t,r){var o=r.getOrThunk(function(){return dh(e,n.element())});t.setCollapsed(),zi(n.element(),lh(e),o),gi(n.element());var i=sh(n,e);io(i,e.growingClass),ro(i,e.shrinkingClass),gh(n,e),e.onStartShrink(n)}function yh(n,e,t){var r=dh(e,n.element());("0px"===r?hh:vh)(n,e,t,Rn.some(r))}function bh(n,e,t){var r=sh(n,e),o=uo(r,e.shrinkingClass),i=dh(e,n.element());ph(n,e);var u=dh(e,n.element());(o?function(){zi(n.element(),lh(e),i),gi(n.element())}:function(){gh(n,e)})(),io(r,e.shrinkingClass),ro(r,e.growingClass),ph(n,e),zi(n.element(),lh(e),u),t.setExpanded(),e.onStartGrow(n)}function xh(n,e,t){var r=sh(n,e);return!0===uo(r,e.growingClass)}function wh(n,e,t){var r=sh(n,e);return!0===uo(r,e.shrinkingClass)}function Sh(e,t){var r=Gm(mm.sketch({dom:{tag:"div",classes:[Ni.resolve("dropup")]},components:[],containerBehaviours:Ao([ig.config({}),Vh.config({closedClass:Ni.resolve("dropup-closed"),openClass:Ni.resolve("dropup-open"),shrinkingClass:Ni.resolve("dropup-shrinking"),growingClass:Ni.resolve("dropup-growing"),dimension:{property:"height"},onShrunk:function(n){e(),t(),ig.set(n,[])},onGrown:function(n){e(),t()}}),Fi(function(n,e){o(x)})])})),o=function(n){d.window.requestAnimationFrame(function(){n(),Vh.shrink(r)})};return{appear:function(n,e,t){!0===Vh.hasShrunk(r)&&!1===Vh.isTransitioning(r)&&d.window.requestAnimationFrame(function(){e(t),ig.set(r,[n()]),Vh.grow(r)})},disappear:o,component:v(r),element:r.element}}function Th(n){return 8===n.raw().which&&!E(["input","textarea"],W(n.target()))&&!function(n,e,t){return Ji(n,e,t).isSome()}(n.target(),'[contenteditable="true"]')}function Oh(e,n){var t=$t("Getting GUI events settings",jh,n),r=Ie.detect().deviceType.isTouch()?["touchstart","touchmove","touchend","gesturestart"]:["mousedown","mouseup","mouseover","mousemove","mouseout","click"],o=Ng(t),i=Se(r.concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(n){return nm(e,n,function(e){o.fireIfReady(e,n).each(function(n){n&&e.kill()}),t.triggerEvent(n,e)&&e.kill()})}),u=Ho(Rn.none()),c=nm(e,"paste",function(e){o.fireIfReady(e,"paste").each(function(n){n&&e.kill()}),t.triggerEvent("paste",e)&&e.kill(),u.set(Rn.some(d.setTimeout(function(){t.triggerEvent(Be(),e)},0)))}),a=nm(e,"keydown",function(n){t.triggerEvent("keydown",n)?n.kill():!0===t.stopBackspace&&Th(n)&&n.prevent()}),f=function(n,e){return Nh?em(n,"focus",e):nm(n,"focusin",e)}(e,function(n){t.triggerEvent("focusin",n)&&n.kill()}),s=Ho(Rn.none()),l=function(n,e){return Nh?em(n,"blur",e):nm(n,"focusout",e)}(e,function(n){t.triggerEvent("focusout",n)&&n.kill(),s.set(Rn.some(d.setTimeout(function(){t.triggerEvent(Fe(),n)},0)))});return{unbind:function(){D(i,function(n){n.unbind()}),a.unbind(),f.unbind(),l.unbind(),c.unbind(),u.get().each(d.clearTimeout),s.get().each(d.clearTimeout)}}}function kh(n,e){var t=Et(n,"target").map(function(n){return n()}).getOr(e);return Ho(t)}function Eh(n,r,e,t,o,i){var u=n(r,t),c=function(n,e){var t=Ho(!1),r=Ho(!1);return{stop:function(){t.set(!0)},cut:function(){r.set(!0)},isStopped:t.get,isCut:r.get,event:v(n),setSource:e.set,getSource:e.get}}(e,o);return u.fold(function(){return i.logEventNoHandlers(r,t),_h.complete()},function(e){var t=e.descHandler();return Od(t)(c),c.isStopped()?(i.logEventStopped(r,e.element(),t.purpose()),_h.stopped()):c.isCut()?(i.logEventCut(r,e.element(),t.purpose()),_h.complete()):cn(e.element()).fold(function(){return i.logNoParent(r,e.element(),t.purpose()),_h.complete()},function(n){return i.logEventResponse(r,e.element(),t.purpose()),_h.resume(n)})})}function Ch(n,e,t){var r=function(n){var e=Ho(!1);return{stop:function(){e.set(!0)},cut:x,isStopped:e.get,isCut:v(!1),event:v(n),setSource:o("Cannot set source of a broadcasted event"),getSource:o("Cannot get source of a broadcasted event")}}(e);return D(n,function(n){var e=n.descHandler();Od(e)(r)}),r.isStopped()}var Dh,Mh=function(n){return Gm(Ps.sketch({dom:Ls('<div class="${prefix}-mask-edit-icon ${prefix}-icon"></div>'),action:function(){n.run(function(n){n.setReadOnly(!1)})}}))},Ih=function(){return Gm(mm.sketch({dom:Ls('<div class="${prefix}-editor-socket"></div>'),components:[],containerBehaviours:Ao([ig.config({})])}))},Rh=function(n,e,t,r){(!0===t?_o.toAlpha:_o.toOmega)(r),(t?ah:fh)(n,e)},Ah=/* */Object.freeze({refresh:function(n,e,t){if(t.isExpanded()){mi(n.element(),lh(e));var r=dh(e,n.element());zi(n.element(),lh(e),r)}},grow:function(n,e,t){t.isExpanded()||bh(n,e,t)},shrink:function(n,e,t){t.isExpanded()&&yh(n,e,t)},immediateShrink:function(n,e,t){t.isExpanded()&&hh(n,e,t)},hasGrown:function(n,e,t){return t.isExpanded()},hasShrunk:function(n,e,t){return t.isCollapsed()},isGrowing:xh,isShrinking:wh,isTransitioning:function(n,e,t){return!0===xh(n,e)||!0===wh(n,e)},toggleGrow:function(n,e,t){(t.isExpanded()?yh:bh)(n,e,t)},disableTransitions:mh}),Fh=/* */Object.freeze({exhibit:function(n,e){var t=e.expanded;return Lr(t?{classes:[e.openClass],styles:{}}:{classes:[e.closedClass],styles:On(e.dimension.property,"0px")})},events:function(t,r){return Br([function(n,e){return _r(n)(e)}(Yn(),function(n,e){e.event().raw().propertyName===t.dimension.property&&(mh(n,t),r.isExpanded()&&mi(n.element(),t.dimension.property),(r.isExpanded()?t.onGrown:t.onShrunk)(n))})])}}),Bh=[Xt("closedClass"),Xt("openClass"),Xt("shrinkingClass"),Xt("growingClass"),Kt("getAnimationRoot"),Yo("onShrunk"),Yo("onStartShrink"),Yo("onGrown"),Yo("onStartGrow"),nr("expanded",!1),qt("dimension",Wt("property",{width:[Zo("property","width"),Zo("getDimension",function(n){return Cf(n)+"px"})],height:[Zo("property","height"),Zo("getDimension",function(n){return Ui(n)+"px"})]}))],Vh=Wr({fields:Bh,name:"sliding",active:Fh,apis:Ah,state:/* */Object.freeze({init:function(n){var e=Ho(n.expanded);return Ro({isExpanded:function(){return!0===e.get()},isCollapsed:function(){return!1===e.get()},setCollapsed:l(e.set,!1),setExpanded:l(e.set,!0),readState:function(){return"expanded: "+e.get()}})}})}),Nh=Ie.detect().browser.isFirefox(),jh=jt([(Dh="triggerEvent",qt(Dh,Mr)),nr("stopBackspace",!0)]),_h=ht([{stopped:[]},{resume:["element"]},{complete:[]}]),Hh=function(e,t,r,n,o,i){return Eh(e,t,r,n,o,i).fold(function(){return!0},function(n){return Hh(e,t,r,n,o,i)},function(){return!1})},Ph=function(n,e,t,r,o){var i=kh(t,r);return Hh(n,e,t,r,i,o)},zh=Y("element","descHandler"),Lh=function(n,e){return{id:v(n),descHandler:v(e)}};function Gh(){var i={};return{registerId:function(r,o,n){Bn(n,function(n,e){var t=i[e]!==undefined?i[e]:{};t[o]=Hm(n,r),i[e]=t})},unregisterId:function(t){Bn(i,function(n,e){n.hasOwnProperty(t)&&delete n[t]})},filterByType:function(n){return Et(i,n).map(function(n){return Nn(n,function(n,e){return Lh(e,n)})}).getOr([])},find:function(n,e,t){var r=kt(e)(i);return To(t,function(n){return function(t,r){return df(r).fold(function(){return Rn.none()},function(n){var e=kt(n);return t.bind(e).map(function(n){return zh(r,n)})})}(r,n)},n)}}}function Uh(){function r(n){var e=n.element();return df(e).fold(function(){return function(n,e){var t=hc(ff+n);return lf(e,t),t}("uid-",n.element())},function(n){return n})}var o=Gh(),i={},u=function(n){df(n.element()).each(function(n){delete i[n],o.unregisterId(n)})};return{find:function(n,e,t){return o.find(n,e,t)},filter:function(n){return o.filterByType(n)},register:function(n){var e=r(n);Cn(i,e)&&function(n,e){var t=i[e];if(t!==n)throw new Error('The tagId "'+e+'" is already used by: '+vo(t.element())+"\nCannot use it for: "+vo(n.element())+"\nThe conflicting element is"+(q(t.element())?" ":" not ")+"already in the DOM");u(n)}(n,e);var t=[n];o.registerId(t,e,n.events()),i[e]=n},unregister:u,getById:function(n){return kt(n)(i)}}}var $h=function(t){function r(e){return cn(t.element()).fold(function(){return!0},function(n){return on(e,n)})}function o(n,e){return u.find(r,n,e)}function i(t){var n=u.filter(Ve());D(n,function(n){var e=n.descHandler();Od(e)(t)})}var u=Uh(),n=Oh(t.element(),{triggerEvent:function(e,t){return Xo(e,t.target(),function(n){return function(n,e,t,r){var o=t.target();return Ph(n,e,t,o,r)}(o,e,t,n)})}}),c={debugInfo:v("real"),triggerEvent:function(e,t,r){Xo(e,t,function(n){Ph(o,e,r,t,n)})},triggerFocus:function(e,t){df(e).fold(function(){ao(e)},function(n){Xo(Ae(),e,function(n){!function(n,e,t,r,o){var i=kh(t,r);Eh(n,e,t,r,i,o)}(o,Ae(),{originator:v(t),kill:x,prevent:x,target:v(e)},e,n)})})},triggerEscape:function(n,e){c.triggerEvent("keydown",n.element(),e.event())},getByUid:function(n){return g(n)},getByDom:function(n){return p(n)},build:Gm,addToGui:function(n){f(n)},removeFromGui:function(n){s(n)},addToWorld:function(n){e(n)},removeFromWorld:function(n){a(n)},broadcast:function(n){l(n)},broadcastOn:function(n,e){d(n,e)},broadcastEvent:function(n,e){m(n,e)},isConnected:v(!0)},e=function(n){n.connect(c),nt(n.element())||(u.register(n),D(n.components(),e),c.triggerEvent(ze(),n.element(),{target:v(n.element())}))},a=function(n){nt(n.element())||(D(n.components(),a),u.unregister(n)),n.disconnect()},f=function(n){gn(t,n)},s=function(n){hn(n)},l=function(n){i({universal:v(!0),data:v(n)})},d=function(n,e){i({universal:v(!1),channels:v(n),data:v(e)})},m=function(n,e){var t=u.filter(n);return Ch(t,e)},g=function(n){return u.getById(n).fold(function(){return pt.error(new Error('Could not find component with uid: "'+n+'" in system.'))},pt.value)},p=function(n){var e=df(n).getOr("not found");return g(e)};return e(t),{root:v(t),element:t.element,destroy:function(){n.unbind(),at(t.element())},add:f,remove:s,getByUid:g,getByDom:p,addToWorld:e,removeFromWorld:a,broadcast:l,broadcastOn:d,broadcastEvent:m}},Wh=v(Ni.resolve("readonly-mode")),Xh=v(Ni.resolve("edit-mode"));function qh(n){var e=Gm(mm.sketch({dom:{classes:[Ni.resolve("outer-container")].concat(n.classes)},containerBehaviours:Ao([_o.config({alpha:Wh(),omega:Xh()})])}));return $h(e)}var Yh=function(n,e){var t=Ye.fromTag("input");si(t,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"}),ct(n,t),ao(t),e(t),at(t)},Kh=function(n){var e=n.getSelection();if(0<e.rangeCount){var t=e.getRangeAt(0),r=n.document.createRange();r.setStart(t.startContainer,t.startOffset),r.setEnd(t.endContainer,t.endOffset),e.removeAllRanges(),e.addRange(r)}},Jh=function(n,e){so().each(function(n){on(n,e)||fo(n)}),n.focus(),ao(Ye.fromDom(n.document.body)),Kh(n)},Qh={stubborn:function(n,e,t,r){function o(){Jh(e,r)}var i=nm(t,"keydown",function(n){E(["input","textarea"],W(n.target()))||o()});return{toReading:function(){Yh(n,fo)},toEditing:o,onToolbarTouch:function(){},destroy:function(){i.unbind()}}},timid:function(n,e,t,r){function o(){fo(r)}return{toReading:function(){o()},toEditing:function(){Jh(e,r)},onToolbarTouch:function(){o()},destroy:x}}},Zh=function(e,r,t,o,n){function i(){r.run(function(n){n.refreshSelection()})}function u(n,e){var t=n-o.dom().scrollTop;r.run(function(n){n.scrollIntoView(t,t+e)})}function c(){r.run(function(n){n.clearSelection()})}function a(){e.getCursorBox().each(function(n){u(n.top(),n.height())}),r.run(function(n){n.syncHeight()})}var f=jg(e),s=Op(a,300),l=[e.onKeyup(function(){c(),s.throttle()}),e.onNodeChanged(i),e.onDomChanged(s.throttle),e.onDomChanged(i),e.onScrollToCursor(function(n){n.preventDefault(),s.throttle()}),e.onScrollToElement(function(n){n.element(),u(r,o)}),e.onToEditing(function(){r.run(function(n){n.toEditing()})}),e.onToReading(function(){r.run(function(n){n.toReading()})}),nm(e.doc(),"touchend",function(n){on(e.html(),n.target())||on(e.body(),n.target())}),nm(t,"transitionend",function(n){"height"===n.raw().propertyName&&function(){var e=Ui(t);r.run(function(n){n.setViewportOffset(e)}),i(),a()}()}),em(t,"touchstart",function(n){r.run(function(n){n.highlightSelection()}),function(e){r.run(function(n){n.onToolbarTouch(e)})}(n),e.onTouchToolstrip()}),nm(e.body(),"touchstart",function(n){c(),e.onTouchContent(),f.fireTouchstart(n)}),f.onTouchmove(),f.onTouchend(),nm(e.body(),"click",function(n){n.kill()}),nm(t,"touchmove",function(){e.onToolbarScrollStart()})];return{destroy:function(){D(l,function(n){n.unbind()})}}};var nv,ev,tv,rv,ov={},iv={exports:ov};nv=undefined,ev=ov,tv=iv,rv=undefined,function(n){"object"==typeof ev&&void 0!==tv?tv.exports=n():"function"==typeof nv&&nv.amd?nv([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}(function(){return function s(i,u,c){function a(e,n){if(!u[e]){if(!i[e]){var t="function"==typeof rv&&rv;if(!n&&t)return t(e,!0);if(f)return f(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var o=u[e]={exports:{}};i[e][0].call(o.exports,function(n){return a(i[e][1][n]||n)},o,o.exports,s,i,u,c)}return u[e].exports}for(var f="function"==typeof rv&&rv,n=0;n<c.length;n++)a(c[n]);return a}({1:[function(n,e,t){var r,o,i=e.exports={};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(n){if(r===setTimeout)return setTimeout(n,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(n,0);try{return r(n,0)}catch(e){try{return r.call(null,n,0)}catch(e){return r.call(this,n,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(n){r=u}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(n){o=c}}();var f,s=[],l=!1,d=-1;function m(){l&&f&&(l=!1,f.length?s=f.concat(s):d=-1,s.length&&g())}function g(){if(!l){var n=a(m);l=!0;for(var e=s.length;e;){for(f=s,s=[];++d<e;)f&&f[d].run();d=-1,e=s.length}f=null,l=!1,function t(n){if(o===clearTimeout)return clearTimeout(n);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(n);try{return o(n)}catch(e){try{return o.call(null,n)}catch(e){return o.call(this,n)}}}(n)}}function p(n,e){this.fun=n,this.array=e}function h(){}i.nextTick=function(n){var e=new Array(arguments.length-1);if(1<arguments.length)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];s.push(new p(n,e)),1!==s.length||l||a(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,l,e){(function(e){function r(){}function i(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=undefined,this._deferreds=[],s(n,this)}function o(r,o){for(;3===r._state;)r=r._value;0!==r._state?(r._handled=!0,i._immediateFn(function(){var n=1===r._state?o.onFulfilled:o.onRejected;if(null!==n){var e;try{e=n(r._value)}catch(t){return void c(o.promise,t)}u(o.promise,e)}else(1===r._state?u:c)(o.promise,r._value)})):r._deferreds.push(o)}function u(n,e){try{if(e===n)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if(e instanceof i)return n._state=3,n._value=e,void a(n);if("function"==typeof t)return void s(function r(n,e){return function(){n.apply(e,arguments)}}(t,e),n)}n._state=1,n._value=e,a(n)}catch(o){c(n,o)}}function c(n,e){n._state=2,n._value=e,a(n)}function a(n){2===n._state&&0===n._deferreds.length&&i._immediateFn(function(){n._handled||i._unhandledRejectionFn(n._value)});for(var e=0,t=n._deferreds.length;e<t;e++)o(n,n._deferreds[e]);n._deferreds=null}function f(n,e,t){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.promise=t}function s(n,e){var t=!1;try{n(function(n){t||(t=!0,u(e,n))},function(n){t||(t=!0,c(e,n))})}catch(r){if(t)return;t=!0,c(e,r)}}var n,t;n=this,t=setTimeout,i.prototype["catch"]=function(n){return this.then(null,n)},i.prototype.then=function(n,e){var t=new this.constructor(r);return o(this,new f(n,e,t)),t},i.all=function(n){var a=Array.prototype.slice.call(n);return new i(function(o,i){if(0===a.length)return o([]);var u=a.length;function c(e,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if("function"==typeof t)return void t.call(n,function(n){c(e,n)},i)}a[e]=n,0==--u&&o(a)}catch(r){i(r)}}for(var n=0;n<a.length;n++)c(n,a[n])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(n){n(e)})},i.reject=function(t){return new i(function(n,e){e(t)})},i.race=function(o){return new i(function(n,e){for(var t=0,r=o.length;t<r;t++)o[t].then(n,e)})},i._immediateFn="function"==typeof e?function(n){e(n)}:function(n){t(n,0)},i._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},i._setImmediateFn=function(n){i._immediateFn=n},i._setUnhandledRejectionFn=function(n){i._unhandledRejectionFn=n},void 0!==l&&l.exports?l.exports=i:n.Promise||(n.Promise=i)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(a,n,f){(function(n,e){var r=a("process/browser.js").nextTick,t=Function.prototype.apply,o=Array.prototype.slice,i={},u=0;function c(n,e){this._id=n,this._clearFn=e}f.setTimeout=function(){return new c(t.call(setTimeout,window,arguments),clearTimeout)},f.setInterval=function(){return new c(t.call(setInterval,window,arguments),clearInterval)},f.clearTimeout=f.clearInterval=function(n){n.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},f.enroll=function(n,e){clearTimeout(n._idleTimeoutId),n._idleTimeout=e},f.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},f._unrefActive=f.active=function(n){clearTimeout(n._idleTimeoutId);var e=n._idleTimeout;0<=e&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},e))},f.setImmediate="function"==typeof n?n:function(n){var e=u++,t=!(arguments.length<2)&&o.call(arguments,1);return i[e]=!0,r(function(){i[e]&&(t?n.apply(null,t):n.call(null),f.clearImmediate(e))}),e},f.clearImmediate="function"==typeof e?e:function(n){delete i[n]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,e,t){var r=n("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();e.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)});function uv(n){d.setTimeout(function(){throw n},0)}function cv(n,e,t){return Math.abs(n-e)<=t?Rn.none():n<e?Rn.some(n+t):Rn.some(n-t)}function av(e,t){return bo([{width:320,height:480,keyboard:{portrait:300,landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}],function(n){return function(n,e){return n?Rn.some(e):Rn.none()}(e<=n.width&&t<=n.height,n.keyboard)}).getOr({portrait:t/5,landscape:e/4})}function fv(n){var e=Ag(n).isPortrait(),t=function(n){return av(n.screen.width,n.screen.height)}(n),r=e?t.portrait:t.landscape;return(e?n.screen.height:n.screen.width)-n.innerHeight>r?0:r}function sv(n,e){var t=un(n).dom().defaultView;return Ui(n)+Ui(e)-fv(t)}function lv(n){return Pg(n,Mv)}function dv(n,e){var t=function(n){return Kr(n,Iv)}(n);return Dv.fixed(n,t,e)}function mv(n,e){return Dv.scroller(n,e)}function gv(n){var e=lv(n);return("true"===Kr(n,Rv)?mv:dv)(n,e)}function pv(n,e,t){var r=un(n).dom().defaultView.innerHeight;return qr(n,Av,r+"px"),r-e-t}function hv(n){var e=di(n,"top").getOr("0");return parseInt(e,10)}function vv(n){return parseInt(n.dom().scrollTop,10)}function yv(n,e){var t=e+Vv(n)+"px";zi(n,"top",t)}var bv=iv.exports.boltExport,xv=function(n){var t=Rn.none(),e=[],r=function(n){o()?u(n):e.push(n)},o=function(){return t.isSome()},i=function(n){D(n,u)},u=function(e){t.each(function(n){d.setTimeout(function(){e(n)},0)})};return n(function(n){t=Rn.some(n),i(e),e=[]}),{get:r,map:function(t){return xv(function(e){r(function(n){e(t(n))})})},isReady:o}},wv={nu:xv,pure:function(e){return xv(function(n){n(e)})}},Sv=function(t){function n(n){t().then(n,uv)}return{map:function(n){return Sv(function(){return t().then(n)})},bind:function(e){return Sv(function(){return t().then(function(n){return e(n).toPromise()})})},anonBind:function(n){return Sv(function(){return t().then(function(){return n.toPromise()})})},toLazy:function(){return wv.nu(n)},toCached:function(){var n=null;return Sv(function(){return null===n&&(n=t()),n})},toPromise:t,get:n}},Tv=function(n){return Sv(function(){return new bv(n)})},Ov=function(n){return Sv(function(){return bv.resolve(n)})},kv=function(){var f=null;return{animate:function(r,o,n,i,e,t){function u(n){c=!0,e(n)}var c=!1;Rg.clearInterval(f);function a(n){Rg.clearInterval(f),u(n)}f=Rg.setInterval(function(){var t=r();cv(t,o,n).fold(function(){Rg.clearInterval(f),u(o)},function(n){if(i(n,a),!c){var e=r();(e!==n||Math.abs(e-o)>Math.abs(t-o))&&(Rg.clearInterval(f),u(o))}})},t)}}},Ev=sv,Cv=function(n,e,t){var r=sv(e,t),o=Ui(e)+Ui(t)-r;zi(n,"padding-bottom",o+"px")},Dv=ht([{fixed:["element","property","offsetY"]},{scroller:["element","offsetY"]}]),Mv="data-"+Ni.resolve("position-y-fixed"),Iv="data-"+Ni.resolve("y-property"),Rv="data-"+Ni.resolve("scrolling"),Av="data-"+Ni.resolve("last-window-height"),Fv=function(n){var e=Xi(n,"["+Mv+"]");return Se(e,gv)},Bv=function(r,o,i,u){function n(){var n=t.innerHeight;return function(n){return Pg(n,Av)}(r)<n}function e(){if(d){var n=Ui(i),e=Ui(u),t=pv(r,n,e);qr(r,Mv,n+"px"),zi(r,"height",t+"px"),Cv(o,r,u)}}var t=un(r).dom().defaultView,c=function(n){var e=Kr(n,"style");si(n,{position:"absolute",top:"0px"}),qr(n,Mv,"0px"),qr(n,Iv,"top");return{restore:function(){qr(n,"style",e||""),Qr(n,Mv),Qr(n,Iv)}}}(i),a=Ui(i),f=Ui(u),s=function(n,e,t){var r=Kr(t,"style");vg.register(t),si(t,{position:"absolute",height:e+"px",width:"100%",top:n+"px"}),qr(t,Mv,n+"px"),qr(t,Rv,"true"),qr(t,Iv,"top");return{restore:function(){vg.deregister(t),qr(t,"style",r||""),Qr(t,Mv),Qr(t,Rv),Qr(t,Iv)}}}(a,pv(r,a,f),r),l=function(n){var e=Kr(n,"style");si(n,{position:"absolute",bottom:"0px"}),qr(n,Mv,"0px"),qr(n,Iv,"bottom");return{restore:function(){qr(n,"style",e||""),Qr(n,Mv),Qr(n,Iv)}}}(u),d=!0;return Cv(o,r,u),{setViewportOffset:function(n){qr(r,Mv,n+"px"),e()},isExpanding:n,isShrinking:m(n),refresh:e,restore:function(){d=!1,c.restore(),s.restore(),l.restore()}}},Vv=lv,Nv=kv(),jv="data-"+Ni.resolve("last-scroll-top"),_v=function(t,r,o){return Tv(function(n){var e=l(vv,t);Nv.animate(e,r,15,function(n){t.dom().scrollTop=n,zi(t,"top",hv(t)+15+"px")},function(){t.dom().scrollTop=r,zi(t,"top",o+"px"),n(r)},10)})},Hv=function(o,i){return Tv(function(n){var e=l(vv,o);qr(o,jv,e());var t=Math.abs(i-e()),r=Math.ceil(t/10);Nv.animate(e,i,r,function(n,e){Pg(o,jv)!==o.dom().scrollTop?e(o.dom().scrollTop):(o.dom().scrollTop=n,qr(o,jv,n))},function(){o.dom().scrollTop=i,qr(o,jv,i),n(i)},10)})},Pv=function(i,u){return Tv(function(n){function e(n){zi(i,"top",n+"px")}var t=l(hv,i),r=Math.abs(u-t()),o=Math.ceil(r/10);Nv.animate(t,u,o,e,function(){e(u),n(u)},10)})},zv=function(e,t,r){var o=un(e).dom().defaultView;return Tv(function(n){yv(e,r),yv(t,r),o.scrollTo(0,r),n(r)})};function Lv(i,n){return n(function(t){var r=[],o=0;0===i.length?t([]):D(i,function(n,e){n.get(function(e){return function(n){r[e]=n,++o>=i.length&&t(r)}}(e))})})}function Gv(n,r){return n.fold(function(n,e,t){return function(n,e,t,r){return zi(n,e,t+r+"px"),Ov(r)}(n,e,r,t)},function(n,e){return function(n,e,t){var r=e+t,o=di(n,"top").getOr(t),i=r-parseInt(o,10),u=n.dom().scrollTop+i;return _v(n,u,r)}(n,r,e)})}function Uv(e,t,n,r,o,i){var u=function f(t){var r=Ho(wv.pure({}));return{start:function(e){var n=wv.nu(function(n){return t(e).get(n)});r.set(n)},idle:function(n){r.get().get(function(){n()})}}}(function(n){return zv(e,t,n)}),c=Op(function(){u.idle(function(){Wv(n,r.pageYOffset).get(function(){(function(){var n=jp(i);return Rn.from(n[0]).bind(function(n){var e=n.top()-t.dom().scrollTop;return e>r.innerHeight+5||e<-5?Rn.some({top:v(e),bottom:v(e+n.height())}):Rn.none()})})().each(function(n){t.dom().scrollTop=t.dom().scrollTop+n.top()}),u.start(0),o.refresh()})})},1e3),a=nm(Ye.fromDom(r),"scroll",function(){r.pageYOffset<0||c.throttle()});return Wv(n,r.pageYOffset).get(y),{unbind:a.unbind}}var $v=function(n,e,t,r,o){var i=Ev(e,t),u=l(Kh,n);i<r||i<o?Hv(e,e.dom().scrollTop-i+o).get(u):r<0&&Hv(e,e.dom().scrollTop+r).get(u)},Wv=function(n,e){var t=Fv(n);return function(n){return Lv(n,Tv)}(Se(t,function(n){return Gv(n,e)}))},Xv=function(n){var t=n.cWin(),e=n.ceBody(),r=n.socket(),o=n.toolstrip(),i=n.toolbar(),u=n.contentElement(),c=n.keyboardType(),a=n.outerWindow(),f=n.dropup(),s=Bv(r,e,o,f),l=c(n.outerBody(),t,et(),u,o,i),d=Fg(a,{onChange:x,onReady:s.refresh});d.onAdjustment(function(){s.refresh()});var m=nm(Ye.fromDom(a),"resize",function(){s.isExpanding()&&s.refresh()}),g=Uv(o,r,n.outerBody(),a,s,t),p=function v(t,e){var n=t.document,r=Ye.fromTag("div");function o(n){var e=Ye.fromTag("span");return Id(e,[Ni.resolve("layer-editor"),Ni.resolve("unfocused-selection")]),si(e,{left:n.left()+"px",top:n.top()+"px",width:n.width()+"px",height:n.height()+"px"}),e}ro(r,Ni.resolve("unfocused-selections")),ct(Ye.fromDom(n.documentElement),r);var i=nm(r,"touchstart",function(n){n.prevent(),Jh(t,e),u()}),u=function(){mn(r)};return{update:function(){u();var n=jp(t),e=Se(n,o);dn(r,e)},isActive:function(){return 0<ut(r).length},destroy:function(){i.unbind(),at(r)},clear:u}}(t,u),h=function(){p.clear()};return{toEditing:function(){l.toEditing(),h()},toReading:function(){l.toReading()},onToolbarTouch:function(n){l.onToolbarTouch(n)},refreshSelection:function(){p.isActive()&&p.update()},clearSelection:h,highlightSelection:function(){p.update()},scrollIntoView:function(n,e){$v(t,r,f,n,e)},updateToolbarPadding:x,setViewportOffset:function(n){s.setViewportOffset(n),Pv(r,n).get(y)},syncHeight:function(){zi(u,"height",u.dom().contentWindow.document.body.scrollHeight+"px")},refreshStructure:s.refresh,destroy:function(){s.restore(),d.destroy(),g.unbind(),m.unbind(),l.destroy(),p.destroy(),Yh(et(),fo)}}},qv=function(r,n){var o=qp(),i=xd(),u=xd(),c=bd(),a=bd();return{enter:function(){n.hide();var t=Ye.fromDom(d.document);zp.getActiveApi(r.editor).each(function(n){i.set({socketHeight:di(r.socket,"height"),iframeHeight:di(n.frame(),"height"),outerScroll:d.document.body.scrollTop}),u.set({exclusives:uh.exclusive(t,"."+vg.scrollable())}),ro(r.container,Ni.resolve("fullscreen-maximized")),Wp(r.container,n.body()),o.maximize(),zi(r.socket,"overflow","scroll"),zi(r.socket,"-webkit-overflow-scrolling","touch"),ao(n.body());var e=Q(["cWin","ceBody","socket","toolstrip","toolbar","dropup","contentElement","cursor","keyboardType","isScrolling","outerWindow","outerBody"],[]);c.set(Xv(e({cWin:n.win(),ceBody:n.body(),socket:r.socket,toolstrip:r.toolstrip,toolbar:r.toolbar,dropup:r.dropup.element(),contentElement:n.frame(),cursor:x,outerBody:r.body,outerWindow:r.win,keyboardType:Qh.stubborn,isScrolling:function(){return u.get().exists(function(n){return n.socket.isScrolling()})}}))),c.run(function(n){n.syncHeight()}),a.set(Zh(n,c,r.toolstrip,r.socket,r.dropup))})},refreshStructure:function(){c.run(function(n){n.refreshStructure()})},exit:function(){o.restore(),a.clear(),c.clear(),n.show(),i.on(function(n){n.socketHeight.each(function(n){zi(r.socket,"height",n)}),n.iframeHeight.each(function(n){zi(r.editor.getFrame(),"height",n)}),d.document.body.scrollTop=n.scrollTop}),i.clear(),u.on(function(n){n.exclusives.unbind()}),u.clear(),io(r.container,Ni.resolve("fullscreen-maximized")),Xp(),vg.deregister(r.toolbar),mi(r.socket,"overflow"),mi(r.socket,"-webkit-overflow-scrolling"),fo(r.editor.getFrame()),zp.getActiveApi(r.editor).each(function(n){n.clearSelection()})}}},Yv=function(n){var e=$t("Getting IosWebapp schema",Jp,n);zi(e.toolstrip,"width","100%"),zi(e.container,"position","relative");var t=Gm(Kp(function(){e.setReadOnly(e.readOnlyOnInit()),o.enter()},e.translate));e.alloy.add(t);var r={show:function(){e.alloy.add(t)},hide:function(){e.alloy.remove(t)}},o=qv(e,r);return{setReadOnly:e.setReadOnly,refreshStructure:o.refreshStructure,enter:o.enter,exit:o.exit,destroy:x}};function Kv(n,e,t){n.system().broadcastOn([Go.formatChanged()],{command:e,state:t})}function Jv(m){return{getNotificationManagerImpl:function(){return{open:v({progressBar:{value:x},close:x,text:x}),close:x,reposition:x,getArgs:v({})}},renderUI:function(){var n=m.getElement(),e=Zv(m);!1===function(n){return!1===n.settings.skin}(m)?(m.contentCSS.push(e.content),Po.DOM.styleSheetLoader.load(e.ui,ey(m))):ey(m)();function t(){m.fire("ScrollIntoView")}var f=Ie.detect().os.isAndroid()?function c(n){var e=qh({classes:[Ni.resolve("android-container")]}),t=ch(),r=bd(),o=Mh(r),i=Ih(),u=Sh(x,n);return e.add(t.wrapper()),e.add(i),e.add(u.component()),{system:v(e),element:e.element,init:function(n){r.set(Qp(n))},exit:function(){r.run(function(n){n.exit(),ig.remove(i,o)})},setToolbarGroups:function(n){var e=t.createGroups(n);t.setGroups(e)},setContextToolbar:function(n){var e=t.createGroups(n);t.setContextToolbar(e)},focusToolbar:function(){t.focus()},restoreToolbar:function(){t.restoreToolbar()},updateMode:function(n){Rh(i,o,n,e.root())},socket:v(i),dropup:v(u)}}(t):function a(n){var e=qh({classes:[Ni.resolve("ios-container")]}),t=ch(),r=bd(),o=Mh(r),i=Ih(),u=Sh(function(){r.run(function(n){n.refreshStructure()})},n);return e.add(t.wrapper()),e.add(i),e.add(u.component()),{system:v(e),element:e.element,init:function(n){r.set(Yv(n))},exit:function(){r.run(function(n){ig.remove(i,o),n.exit()})},setToolbarGroups:function(n){var e=t.createGroups(n);t.setGroups(e)},setContextToolbar:function(n){var e=t.createGroups(n);t.setContextToolbar(e)},focusToolbar:function(){t.focus()},restoreToolbar:function(){t.restoreToolbar()},updateMode:function(n){Rh(i,o,n,e.root())},socket:v(i),dropup:v(u)}}(t);!function(n,e){dt(n,e,sn)}(Ye.fromDom(n),f.system());function s(n,e,t,r){!1===r&&m.selection.collapse();var o=i(n,e,t);f.setToolbarGroups(!0===r?o.readOnly:o.main),m.setMode(!0===r?"readonly":"design"),m.fire(!0===r?ty():ry()),f.updateMode(r)}function l(n,e){return m.on(n,e),{unbind:function(){m.off(n)}}}var r=n.ownerDocument.defaultView,d=Fg(r,{onChange:function(){f.system().broadcastOn([Go.orientationChanged()],{width:Bg(r)})},onReady:x}),i=function(n,e,t){var r=n.get();return{readOnly:r.backToMask.concat(e.get()),main:r.backToMask.concat(t.get())}};return m.on("init",function(){f.init({editor:{getFrame:function(){return Ye.fromDom(m.contentAreaContainer.querySelector("iframe"))},onDomChanged:function(){return{unbind:x}},onToReading:function(n){return l(ty(),n)},onToEditing:function(n){return l(ry(),n)},onScrollToCursor:function(e){m.on("ScrollIntoView",function(n){e(n)});return{unbind:function(){m.off("ScrollIntoView"),d.destroy()}}},onTouchToolstrip:function(){n()},onTouchContent:function(){(function(n){return lo(n).bind(function(n){return f.system().getByDom(n).toOption()})})(Ye.fromDom(m.editorContainer.querySelector("."+Ni.resolve("toolbar")))).each(U),f.restoreToolbar(),n()},onTapContent:function(n){var e=n.target();if("img"===W(e))m.selection.select(e.dom()),n.kill();else if("a"===W(e)){f.system().getByDom(Ye.fromDom(m.editorContainer)).each(function(n){_o.isAlpha(n)&&Lo(e.dom())})}}},container:Ye.fromDom(m.editorContainer),socket:Ye.fromDom(m.contentAreaContainer),toolstrip:Ye.fromDom(m.editorContainer.querySelector("."+Ni.resolve("toolstrip"))),toolbar:Ye.fromDom(m.editorContainer.querySelector("."+Ni.resolve("toolbar"))),dropup:f.dropup(),alloy:f.system(),translate:x,setReadOnly:function(n){s(a,c,u,n)},readOnlyOnInit:function(){return!1}});var n=function(){f.dropup().disappear(function(){f.system().broadcastOn([Go.dropupDismissed()],{})})},e={label:"The first group",scrollable:!1,items:[Us.forToolbar("back",function(){m.selection.collapse(),f.exit()},{},m)]},t={label:"Back to read only",scrollable:!1,items:[Us.forToolbar("readonly-back",function(){s(a,c,u,!0)},{},m)]},r=Cg(f,m),o=Dg(m.settings,r),i={label:"The extra group",scrollable:!1,items:[]},u=Ho([{label:"the action group",scrollable:!0,items:o},i]),c=Ho([{label:"The read only mode group",scrollable:!0,items:[]},i]),a=Ho({backToMask:[e],backToReadOnly:[t]});ny(f,m)}),m.on("remove",function(){f.exit()}),m.on("detach",function(){!function(e){var n=ut(e.element());D(n,function(n){e.getByDom(n).each(ft)}),at(e.element())}(f.system()),f.system().destroy()}),{iframeContainer:f.socket().element().dom(),editorContainer:f.element().dom()}}}}var Qv=tinymce.util.Tools.resolve("tinymce.EditorManager"),Zv=function(n){var e=Et(n.settings,"skin_url").fold(function(){return Qv.baseURL+"/skins/ui/oxide"},function(n){return n});return{content:e+"/content.mobile.min.css",ui:e+"/skin.mobile.min.css"}},ny=function(r,n){var e=An(n.formatter.get());D(e,function(e){n.formatter.formatChanged(e,function(n){Kv(r,e,n)})}),D(["ul","ol"],function(t){n.selection.selectorChanged(t,function(n,e){Kv(r,t,n)})})},ey=(v(["x-small","small","medium","large","x-large"]),function(n){function e(){n._skinLoaded=!0,n.fire("SkinLoaded")}return function(){n.initialized?e():n.on("init",e)}}),ty=v("toReading"),ry=v("toEditing");!function iy(){zo.add("mobile",Jv)}()}(window);