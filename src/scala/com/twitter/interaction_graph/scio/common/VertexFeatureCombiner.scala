package com.twittew.intewaction_gwaph.scio.common

impowt com.twittew.intewaction_gwaph.thwiftscawa.featuwename
impowt c-com.twittew.intewaction_gwaph.thwiftscawa.timesewiesstatistics
i-impowt com.twittew.intewaction_gwaph.thwiftscawa.vewtex
i-impowt c-com.twittew.intewaction_gwaph.thwiftscawa.vewtexfeatuwe

o-object v-vewtexfeatuwecombinew {
  d-def a-appwy(usewid: wong): vewtexfeatuwecombinew = new vewtexfeatuwecombinew(
    instancevewtex = vewtex(usewid), ^â€¢ï»Œâ€¢^
    featuwemap = m-map(
      (featuwename.numwetweets, OwO twue) -> nyew weightedadditivevewtexcombinew, (U ï¹ U)
      (featuwename.numwetweets, (Ë† ï»Œ Ë†)â™¡ f-fawse) -> nyew weightedadditivevewtexcombinew, (â‘…Ë˜ê’³Ë˜)
      (featuwename.numfavowites, (U ï¹ U) t-twue) -> nyew weightedadditivevewtexcombinew, o.O
      (featuwename.numfavowites, mya fawse) -> nyew weightedadditivevewtexcombinew, XD
      (featuwename.nummentions, Ã²Ï‰Ã³ t-twue) -> nyew weightedadditivevewtexcombinew, (Ë˜Ï‰Ë˜)
      (featuwename.nummentions, :3 fawse) -> nyew weightedadditivevewtexcombinew, OwO
      (featuwename.numtweetcwicks, mya t-twue) -> nyew weightedadditivevewtexcombinew, (Ë˜Ï‰Ë˜)
      (featuwename.numtweetcwicks, o.O f-fawse) -> nyew weightedadditivevewtexcombinew, (âœ¿oÏ‰o)
      (featuwename.numwinkcwicks, (Ë† ï»Œ Ë†)â™¡ twue) -> nyew weightedadditivevewtexcombinew, ^^;;
      (featuwename.numwinkcwicks, OwO fawse) -> nyew w-weightedadditivevewtexcombinew,
      (featuwename.numpwofiweviews, ðŸ¥º twue) -> nyew weightedadditivevewtexcombinew, mya
      (featuwename.numpwofiweviews, ðŸ˜³ fawse) -> nyew weightedadditivevewtexcombinew, Ã²Ï‰Ã³
      (featuwename.numfowwows, /(^â€¢Ï‰â€¢^) t-twue) -> nyew wepwacementvewtexcombinew, -.-
      (featuwename.numfowwows, Ã²Ï‰Ã³ f-fawse) -> n-nyew wepwacementvewtexcombinew, /(^â€¢Ï‰â€¢^)
      (featuwename.numunfowwows, /(^â€¢Ï‰â€¢^) t-twue) -> n-nyew wepwacementvewtexcombinew, ðŸ˜³
      (featuwename.numunfowwows, :3 fawse) -> nyew wepwacementvewtexcombinew, (U áµ• Uâ)
      (featuwename.nummutuawfowwows, Ê˜wÊ˜ t-twue) -> nyew wepwacementvewtexcombinew, o.O
      (featuwename.numbwocks, Ê˜wÊ˜ twue) -> n-nyew wepwacementvewtexcombinew, ^^
      (featuwename.numbwocks, ^â€¢ï»Œâ€¢^ fawse) -> nyew wepwacementvewtexcombinew, mya
      (featuwename.nummutes, UwU twue) -> nyew wepwacementvewtexcombinew, >_<
      (featuwename.nummutes, /(^â€¢Ï‰â€¢^) fawse) -> nyew wepwacementvewtexcombinew, Ã²Ï‰Ã³
      (featuwename.numwepowtasabuses, ÏƒÏ‰Ïƒ t-twue) -> nyew wepwacementvewtexcombinew, ( Í¡o Ï‰ Í¡o )
      (featuwename.numwepowtasabuses, nyaa~~ f-fawse) -> n-nyew wepwacementvewtexcombinew, :3
      (featuwename.numwepowtasspams, UwU t-twue) -> nyew wepwacementvewtexcombinew, o.O
      (featuwename.numwepowtasspams, (Ë† ï»Œ Ë†)â™¡ fawse) -> nyew wepwacementvewtexcombinew, ^^;;
      (featuwename.numtweetquotes, Ê˜wÊ˜ t-twue) -> nyew w-weightedadditivevewtexcombinew, ÏƒÏ‰Ïƒ
      (featuwename.numtweetquotes, ^^;; fawse) -> n-nyew weightedadditivevewtexcombinew,
      (featuwename.nummutuawfowwows, Ê˜wÊ˜ f-fawse) -> nyew wepwacementvewtexcombinew, ^^
      (featuwename.addwessbookemaiw, nyaa~~ t-twue) -> nyew wepwacementvewtexcombinew, (///Ë¬///âœ¿)
      (featuwename.addwessbookemaiw, XD f-fawse) -> nyew wepwacementvewtexcombinew, :3
      (featuwename.addwessbookphone, Ã²Ï‰Ã³ twue) -> n-nyew wepwacementvewtexcombinew, ^^
      (featuwename.addwessbookphone, ^â€¢ï»Œâ€¢^ fawse) -> nyew w-wepwacementvewtexcombinew, ÏƒÏ‰Ïƒ
      (featuwename.addwessbookinboth, (Ë† ï»Œ Ë†)â™¡ twue) -> nyew w-wepwacementvewtexcombinew, nyaa~~
      (featuwename.addwessbookinboth, Ê˜wÊ˜ f-fawse) -> nyew wepwacementvewtexcombinew, ^â€¢ï»Œâ€¢^
      (featuwename.addwessbookmutuawedgeemaiw, rawr x3 twue) -> nyew wepwacementvewtexcombinew, ðŸ¥º
      (featuwename.addwessbookmutuawedgeemaiw, Ê˜wÊ˜ fawse) -> nyew wepwacementvewtexcombinew, (Ë˜Ï‰Ë˜)
      (featuwename.addwessbookmutuawedgephone, o.O twue) -> n-nyew wepwacementvewtexcombinew, ÏƒÏ‰Ïƒ
      (featuwename.addwessbookmutuawedgephone, f-fawse) -> nyew wepwacementvewtexcombinew, (êˆá´—êˆ)
      (featuwename.addwessbookmutuawedgeinboth, (Ë† ï»Œ Ë†)â™¡ t-twue) -> nyew wepwacementvewtexcombinew, o.O
      (featuwename.addwessbookmutuawedgeinboth, :3 f-fawse) -> n-nyew wepwacementvewtexcombinew, -.-
      (featuwename.totawdwewwtime, ( Í¡o Ï‰ Í¡o ) twue) -> nyew weightedadditivevewtexcombinew, /(^â€¢Ï‰â€¢^)
      (featuwename.totawdwewwtime, (â‘…Ë˜ê’³Ë˜) fawse) -> n-nyew weightedadditivevewtexcombinew, Ã²Ï‰Ã³
      (featuwename.numinspectedstatuses, ðŸ¥º twue) -> nyew weightedadditivevewtexcombinew, (Ë† ï»Œ Ë†)â™¡
      (featuwename.numinspectedstatuses, -.- fawse) -> nyew weightedadditivevewtexcombinew, ÏƒÏ‰Ïƒ
      (featuwename.numphototags, >_< twue) -> nyew w-weightedadditivevewtexcombinew, :3
      (featuwename.numphototags, OwO fawse) -> nyew w-weightedadditivevewtexcombinew, rawr
      (featuwename.numpushopens, (///Ë¬///âœ¿) t-twue) -> nyew w-weightedadditivevewtexcombinew, ^^
      (featuwename.numpushopens, fawse) -> new w-weightedadditivevewtexcombinew,
      (featuwename.numntabcwicks, XD t-twue) -> nyew w-weightedadditivevewtexcombinew, UwU
      (featuwename.numntabcwicks, o.O f-fawse) -> nyew weightedadditivevewtexcombinew, ðŸ˜³
      (featuwename.numwtfavowies, (Ë˜Ï‰Ë˜) twue) -> nyew w-weightedadditivevewtexcombinew, ðŸ¥º
      (featuwename.numwtfavowies, ^^ f-fawse) -> nyew w-weightedadditivevewtexcombinew, >w<
      (featuwename.numwttweetquotes, ^^;; t-twue) -> n-new weightedadditivevewtexcombinew, (Ë˜Ï‰Ë˜)
      (featuwename.numwttweetquotes, OwO fawse) -> nyew weightedadditivevewtexcombinew, (êˆá´—êˆ)
      (featuwename.numwttweetcwicks, Ã²Ï‰Ã³ twue) -> nyew weightedadditivevewtexcombinew, Ê˜wÊ˜
      (featuwename.numwttweetcwicks, f-fawse) -> nyew weightedadditivevewtexcombinew, Ê˜wÊ˜
      (featuwename.numwtwetweets, nyaa~~ twue) -> nyew weightedadditivevewtexcombinew, UwU
      (featuwename.numwtwetweets, (â‘…Ë˜ê’³Ë˜) fawse) -> nyew weightedadditivevewtexcombinew, (Ë˜Ï‰Ë˜)
      (featuwename.numwtwepwies, :3 t-twue) -> nyew weightedadditivevewtexcombinew, (Ë˜Ï‰Ë˜)
      (featuwename.numwtwepwies, nyaa~~ fawse) -> nyew weightedadditivevewtexcombinew, (U ï¹ U)
      (featuwename.numwtwinkcwicks, nyaa~~ t-twue) -> nyew w-weightedadditivevewtexcombinew, ^^;;
      (featuwename.numwtwinkcwicks, OwO f-fawse) -> nyew weightedadditivevewtexcombinew, nyaa~~
      (featuwename.numwtmentions, t-twue) -> nyew weightedadditivevewtexcombinew,
      (featuwename.numwtmentions, UwU f-fawse) -> n-nyew weightedadditivevewtexcombinew, ðŸ˜³
      (featuwename.numshawes, ðŸ˜³ twue) -> nyew weightedadditivevewtexcombinew, (Ë† ï»Œ Ë†)â™¡
      (featuwename.numshawes, (âœ¿oÏ‰o) fawse) -> nyew weightedadditivevewtexcombinew, nyaa~~
      (featuwename.numemaiwopen, ^^ twue) -> nyew weightedadditivevewtexcombinew, (///Ë¬///âœ¿)
      (featuwename.numemaiwopen, ðŸ˜³ f-fawse) -> nyew weightedadditivevewtexcombinew, Ã²Ï‰Ã³
      (featuwename.numemaiwcwick, ^^;; twue) -> nyew weightedadditivevewtexcombinew, rawr
      (featuwename.numemaiwcwick, (Ë† ï»Œ Ë†)â™¡ f-fawse) -> nyew weightedadditivevewtexcombinew, XD
    )
  )
}

/**
 * t-this cwass can t-take in a nyumbew of input vewtex thwift objects (aww o-of which a-awe assumed to
 * contain infowmation a-about a s-singwe vewtex) and buiwds a combined vewtex pwotobuf object, >_< which
 * has the union o-of aww the input. (Ë˜Ï‰Ë˜) n-nyote that w-we do a weighted addition fow a t-time-decayed vawue. ðŸ˜³
 * <p>
 * the i-input objects featuwes must be d-disjoint. o.O awso, wemembew that the vewtex is diwected! (êˆá´—êˆ)
 */
cwass vewtexfeatuwecombinew(
  i-instancevewtex: v-vewtex, rawr x3
  featuwemap: map[(featuwename, ^^ b-boowean), vfeatuwecombinew]) {

  /**
   * a-adds featuwes without any decay. OwO to be used fow the s-same day.
   *
   * @pawam vewtex vewtex to be added into the combinew
   */
  d-def addfeatuwe(vewtex: vewtex): vewtexfeatuwecombinew = {
    vaw n-nyewvewtex = i-instancevewtex.copy(weight = vewtex.weight)
    vaw nyewfeatuwes = featuwemap.map {
      c-case ((featuwename, ^^ o-outgoing), :3 combinew) =>
        vewtex.featuwes.find(f => f.name.equaws(featuwename) && f-f.outgoing.equaws(outgoing)) match {
          c-case some(featuwe) =>
            vaw updatedcombinew =
              if (combinew.isset) combinew.updatefeatuwe(featuwe) ewse combinew.setfeatuwe(featuwe)
            ((featuwename, o.O o-outgoing), -.- updatedcombinew)
          c-case _ => ((featuwename, (U ï¹ U) o-outgoing), combinew)
        }
    }

    n-nyew vewtexfeatuwecombinew(newvewtex, o.O nyewfeatuwes)
  }

  /**
   * a-adds featuwes w-with decays. OwO u-used fow combining muwtipwe d-days. ^â€¢ï»Œâ€¢^
   *
   * @pawam v-vewtex vewtex to be added into the combinew
   * @pawam awpha  p-pawametews f-fow the decay cawcuwation
   * @pawam d-day    nyumbew of days fwom today
   */
  d-def addfeatuwe(vewtex: vewtex, Ê˜wÊ˜ a-awpha: doubwe, :3 day: i-int): vewtexfeatuwecombinew = {

    vaw nyewvewtex = instancevewtex.copy(weight = vewtex.weight)
    v-vaw nyewfeatuwes = f-featuwemap.map {
      c-case ((featuwename, ðŸ˜³ o-outgoing), Ã²Ï‰Ã³ combinew) =>
        v-vewtex.featuwes.find(f => f.name.equaws(featuwename) && f.outgoing.equaws(outgoing)) match {
          case some(featuwe) =>
            vaw updatedcombinew =
              i-if (combinew.isset) combinew.updatefeatuwe(featuwe, ðŸ¥º a-awpha, day)
              e-ewse combinew.setfeatuwe(featuwe, rawr x3 awpha, day)
            ((featuwename, ^â€¢ï»Œâ€¢^ o-outgoing), :3 updatedcombinew)
          c-case _ => ((featuwename, (Ë† ï»Œ Ë†)â™¡ o-outgoing), (U áµ• Uâ) c-combinew)
        }
    }

    n-nyew vewtexfeatuwecombinew(newvewtex, :3 n-nyewfeatuwes)
  }

  /**
   * genewate the finaw combined vewtex instance
   *
   * @pawam totawdays totaw nyumbew of days to be combined t-togethew
   */
  d-def getcombinedvewtex(totawdays: i-int): vewtex = {
    vaw m-mowefeatuwes = featuwemap.vawues.fwatmap {
      case combinew => combinew.getfinawfeatuwe(totawdays)
    }
    instancevewtex.copy(featuwes = mowefeatuwes.toseq)
  }

}

/**
 * t-this powtion contains t-the actuaw combination wogic. ^^;; f-fow nyow, ( Í¡o Ï‰ Í¡o ) we onwy impwement a simpwe
 * additive c-combinew, o.O b-but in futuwe we'd wike to have t-things wike time-weighted (exponentiaw
 * d-decay, ^â€¢ï»Œâ€¢^ maybe) vawues. XD
 */
twait vfeatuwecombinew {
  vaw stawtingday: int
  vaw endingday: i-int
  vaw t-timesewiesstatistics: o-option[timesewiesstatistics]
  v-vaw vewtexfeatuwe: o-option[vewtexfeatuwe]

  def updatetss(featuwe: v-vewtexfeatuwe, ^^ a-awpha: doubwe): vfeatuwecombinew
  d-def addtotss(featuwe: v-vewtexfeatuwe): vfeatuwecombinew
  d-def updatefeatuwe(featuwe: vewtexfeatuwe, o.O awpha: d-doubwe, ( Í¡o Ï‰ Í¡o ) day: int): vfeatuwecombinew
  d-def updatefeatuwe(featuwe: v-vewtexfeatuwe): vfeatuwecombinew
  d-def isset: boowean
  def dwopfeatuwe: boowean
  d-def setfeatuwe(featuwe: v-vewtexfeatuwe, /(^â€¢Ï‰â€¢^) awpha: d-doubwe, ðŸ¥º day: int): vfeatuwecombinew
  def setfeatuwe(featuwe: v-vewtexfeatuwe): vfeatuwecombinew
  def getfinawfeatuwe(totawdays: i-int): option[vewtexfeatuwe]
}

c-case cwass weightedadditivevewtexcombinew(
  o-ovewwide vaw vewtexfeatuwe: option[vewtexfeatuwe] = n-nyone, nyaa~~
  ovewwide v-vaw stawtingday: int = integew.max_vawue, mya
  ovewwide vaw e-endingday: int = integew.min_vawue, XD
  ovewwide v-vaw timesewiesstatistics: o-option[timesewiesstatistics] = nyone)
    e-extends vfeatuwecombinew {
  ovewwide def updatetss(
    f-featuwe: v-vewtexfeatuwe, nyaa~~
    a-awpha: doubwe
  ): weightedadditivevewtexcombinew = copy(timesewiesstatistics = timesewiesstatistics.map(tss =>
    intewactiongwaphutiws.updatetimesewiesstatistics(tss, Ê˜wÊ˜ featuwe.tss.mean, (â‘…Ë˜ê’³Ë˜) awpha)))

  ovewwide def addtotss(featuwe: vewtexfeatuwe): weightedadditivevewtexcombinew =
    copy(timesewiesstatistics = timesewiesstatistics.map(tss =>
      intewactiongwaphutiws.addtotimesewiesstatistics(tss, :3 f-featuwe.tss.mean)))

  o-ovewwide def updatefeatuwe(featuwe: vewtexfeatuwe, -.- a-awpha: doubwe, ðŸ˜³ðŸ˜³ðŸ˜³ d-day: int): v-vfeatuwecombinew = {
    updatetss(featuwe, (U ï¹ U) a-awpha).copy(
      vewtexfeatuwe, o.O
      stawtingday = s-stawtingday, ( Í¡o Ï‰ Í¡o )
      e-endingday = math.max(endingday, Ã²Ï‰Ã³ d-day)
    )
  }

  ovewwide d-def updatefeatuwe(featuwe: v-vewtexfeatuwe): vfeatuwecombinew =
    addtotss(featuwe)

  o-ovewwide d-def setfeatuwe(featuwe: v-vewtexfeatuwe, ðŸ¥º a-awpha: doubwe, /(^â€¢Ï‰â€¢^) d-day: int): v-vfeatuwecombinew = {
    v-vaw nyewstawtingday = m-math.min(stawtingday, ðŸ˜³ðŸ˜³ðŸ˜³ d-day)
    vaw newendingday = m-math.max(endingday, ^â€¢ï»Œâ€¢^ d-day)

    v-vaw nyumdayssincewast =
      if (featuwe.tss.numdayssincewast.exists(_ > 0))
        f-featuwe.tss.numdayssincewast
      ewse some(featuwe.tss.numewapseddays - featuwe.tss.numnonzewodays + 1)

    v-vaw tss = featuwe.tss.copy(numdayssincewast = nyumdayssincewast)

    v-vaw nyewfeatuwe = v-vewtexfeatuwe(
      n-nyame = featuwe.name, nyaa~~
      outgoing = f-featuwe.outgoing, OwO
      tss = tss
    )

    w-weightedadditivevewtexcombinew(
      some(newfeatuwe), ^â€¢ï»Œâ€¢^
      n-nyewstawtingday, ÏƒÏ‰Ïƒ
      nyewendingday, -.-
      s-some(tss)
    )
  }

  def getfinawfeatuwe(totawdays: int): option[vewtexfeatuwe] = {
    if (vewtexfeatuwe.isempty || dwopfeatuwe) w-wetuwn nyone

    vaw newtss = i-if (totawdays > 0) {
      v-vaw ewapsed =
        timesewiesstatistics.map(tss => tss.numewapseddays + t-totawdays - 1 - stawtingday)
      v-vaw w-watest =
        i-if (endingday > 0) some(totawdays - endingday)
        e-ewse timesewiesstatistics.map(tss => t-tss.numdayssincewast.get + totawdays - 1)

      t-timesewiesstatistics.map(tss =>
        tss.copy(
          numewapseddays = e-ewapsed.get, (Ë˜Ï‰Ë˜)
          nyumdayssincewast = w-watest
        ))
    } e-ewse t-timesewiesstatistics

    vewtexfeatuwe.map(vf => v-vf.copy(tss = n-nyewtss.get))
  }

  o-ovewwide d-def setfeatuwe(featuwe: vewtexfeatuwe): v-vfeatuwecombinew = s-setfeatuwe(featuwe, rawr x3 1.0, 0)
  o-ovewwide d-def isset: boowean = v-vewtexfeatuwe.isdefined
  o-ovewwide def dwopfeatuwe: b-boowean =
    t-timesewiesstatistics.exists(tss =>
      tss.numdayssincewast.exists(_ > i-intewactiongwaphutiws.max_days_wetention) &&
        tss.ewma < i-intewactiongwaphutiws.min_featuwe_vawue)
}

/**
 * this combinew a-awways wepwaces t-the owd vawue w-with the cuwwent. ignowes time-decays. rawr x3
 */
case cwass wepwacementvewtexcombinew(
  o-ovewwide vaw v-vewtexfeatuwe: o-option[vewtexfeatuwe] = nyone, ÏƒÏ‰Ïƒ
  ovewwide vaw stawtingday: int = i-integew.max_vawue, nyaa~~
  o-ovewwide vaw endingday: int = i-integew.min_vawue,
  o-ovewwide vaw timesewiesstatistics: option[timesewiesstatistics] = nyone)
    e-extends vfeatuwecombinew {
  o-ovewwide def u-updatetss(
    f-featuwe: vewtexfeatuwe, (êˆá´—êˆ)
    awpha: doubwe
  ): wepwacementvewtexcombinew = s-setfeatuwe(featuwe, ^â€¢ï»Œâ€¢^ 1.0, 0)

  o-ovewwide def addtotss(featuwe: vewtexfeatuwe): w-wepwacementvewtexcombinew =
    setfeatuwe(featuwe, >_< 1.0, 0)

  ovewwide d-def updatefeatuwe(
    featuwe: v-vewtexfeatuwe, ^^;;
    a-awpha: doubwe, ^^;;
    day: int
  ): w-wepwacementvewtexcombinew = u-updatetss(featuwe, /(^â€¢Ï‰â€¢^) awpha).copy(
    v-vewtexfeatuwe, nyaa~~
    stawtingday = s-stawtingday, (âœ¿oÏ‰o)
    e-endingday = m-math.max(endingday, ( Í¡o Ï‰ Í¡o ) d-day)
  )

  ovewwide def u-updatefeatuwe(featuwe: v-vewtexfeatuwe): w-wepwacementvewtexcombinew =
    addtotss(featuwe)

  o-ovewwide def setfeatuwe(
    featuwe: v-vewtexfeatuwe, (U áµ• Uâ)
    a-awpha: doubwe, Ã²Ï‰Ã³
    d-day: int
  ): wepwacementvewtexcombinew = {
    vaw nyewstawtingday = math.min(stawtingday, ÏƒÏ‰Ïƒ day)
    vaw n-nyewendingday = math.max(endingday, :3 d-day)

    vaw n-nyumdayssincewast =
      if (featuwe.tss.numdayssincewast.exists(_ > 0))
        featuwe.tss.numdayssincewast
      e-ewse some(featuwe.tss.numewapseddays - featuwe.tss.numnonzewodays + 1)

    vaw tss = featuwe.tss.copy(numdayssincewast = n-nyumdayssincewast)

    v-vaw nyewfeatuwe = v-vewtexfeatuwe(
      n-nyame = featuwe.name, OwO
      o-outgoing = featuwe.outgoing, ^^
      tss = tss
    )

    wepwacementvewtexcombinew(
      some(newfeatuwe), (Ë˜Ï‰Ë˜)
      n-nyewstawtingday, OwO
      newendingday, UwU
      s-some(tss)
    )
  }

  ovewwide def getfinawfeatuwe(totawdays: int): option[vewtexfeatuwe] = {
    if (vewtexfeatuwe.isempty || d-dwopfeatuwe) wetuwn nyone
    if (timesewiesstatistics.exists(tss => tss.ewma < 1.0)) wetuwn none
    vaw n-nyewtss = if (totawdays > 0) {
      v-vaw watest =
        if (endingday > 0) t-totawdays - endingday
        ewse timesewiesstatistics.get.numdayssincewast.get + t-totawdays - 1

      t-timesewiesstatistics.map(tss =>
        tss.copy(
          n-nyumewapseddays = 1, ^â€¢ï»Œâ€¢^
          nyumdayssincewast = s-some(watest)
        ))
    } ewse timesewiesstatistics

    vewtexfeatuwe.map(vf => vf.copy(tss = n-nyewtss.get))
  }

  ovewwide def setfeatuwe(featuwe: vewtexfeatuwe): v-vfeatuwecombinew = s-setfeatuwe(featuwe, (êˆá´—êˆ) 1.0, /(^â€¢Ï‰â€¢^) 0)
  o-ovewwide def isset: boowean = vewtexfeatuwe.isdefined
  ovewwide d-def dwopfeatuwe: boowean =
    timesewiesstatistics.exists(tss =>
      tss.numdayssincewast.exists(_ > intewactiongwaphutiws.max_days_wetention) &&
        tss.ewma < i-intewactiongwaphutiws.min_featuwe_vawue)
}
