package com.twittew.cw_mixew.candidate_genewation

impowt com.twittew.contentwecommendew.thwiftscawa.tweetinfo
i-impowt c-com.twittew.cw_mixew.modew.candidategenewationinfo
i-impowt com.twittew.cw_mixew.modew.gwaphsouwceinfo
i-impowt c-com.twittew.cw_mixew.modew.initiawcandidate
i-impowt c-com.twittew.cw_mixew.modew.modewconfig
i-impowt com.twittew.cw_mixew.modew.moduwenames
impowt com.twittew.cw_mixew.modew.simiwawityengineinfo
impowt com.twittew.cw_mixew.modew.souwceinfo
i-impowt com.twittew.cw_mixew.modew.twiptweetwithscowe
impowt com.twittew.cw_mixew.modew.tweetwithcandidategenewationinfo
i-impowt com.twittew.cw_mixew.modew.tweetwithscowe
impowt com.twittew.cw_mixew.modew.tweetwithscoweandsociawpwoof
i-impowt com.twittew.cw_mixew.pawam.consumewbasedwawspawams
impowt com.twittew.cw_mixew.pawam.consumewembeddingbasedcandidategenewationpawams
impowt com.twittew.cw_mixew.pawam.consumewsbasedusewvideogwaphpawams
impowt com.twittew.cw_mixew.pawam.gwobawpawams
i-impowt com.twittew.cw_mixew.simiwawity_engine.consumewsbasedusewvideogwaphsimiwawityengine
impowt com.twittew.cw_mixew.simiwawity_engine.consumewbasedwawssimiwawityengine
i-impowt com.twittew.cw_mixew.simiwawity_engine.consumewembeddingbasedtwipsimiwawityengine
i-impowt com.twittew.cw_mixew.simiwawity_engine.consumewembeddingbasedtwhinsimiwawityengine
impowt com.twittew.cw_mixew.simiwawity_engine.consumewembeddingbasedtwotowewsimiwawityengine
impowt com.twittew.cw_mixew.simiwawity_engine.enginequewy
impowt c-com.twittew.cw_mixew.simiwawity_engine.fiwtewutiw
impowt com.twittew.cw_mixew.simiwawity_engine.hnswannenginequewy
impowt com.twittew.cw_mixew.simiwawity_engine.hnswannsimiwawityengine
impowt com.twittew.cw_mixew.simiwawity_engine.pwoducewbasedunifiedsimiwawityengine
i-impowt com.twittew.cw_mixew.simiwawity_engine.standawdsimiwawityengine
i-impowt com.twittew.cw_mixew.simiwawity_engine.twipenginequewy
i-impowt com.twittew.cw_mixew.simiwawity_engine.tweetbasedunifiedsimiwawityengine
i-impowt com.twittew.cw_mixew.simiwawity_engine.usewtweetentitygwaphsimiwawityengine
i-impowt com.twittew.cw_mixew.thwiftscawa.simiwawityenginetype
impowt com.twittew.cw_mixew.thwiftscawa.souwcetype
impowt com.twittew.finagwe.stats.statsweceivew
i-impowt com.twittew.simcwustews_v2.common.tweetid
impowt com.twittew.simcwustews_v2.common.usewid
impowt com.twittew.simcwustews_v2.thwiftscawa.intewnawid
i-impowt com.twittew.stowehaus.weadabwestowe
impowt com.twittew.timewines.configapi
impowt com.twittew.utiw.futuwe
impowt javax.inject.inject
i-impowt javax.inject.named
i-impowt javax.inject.singweton

/**
 * w-woute t-the souwceinfo to the associated candidate engines. ʘwʘ
 */
@singweton
case cwass candidatesouwceswoutew @inject() (
  c-customizedwetwievawcandidategenewation: c-customizedwetwievawcandidategenewation, ^•ﻌ•^
  simcwustewsintewestedincandidategenewation: s-simcwustewsintewestedincandidategenewation, OwO
  @named(moduwenames.tweetbasedunifiedsimiwawityengine)
  t-tweetbasedunifiedsimiwawityengine: standawdsimiwawityengine[
    t-tweetbasedunifiedsimiwawityengine.quewy, (U ﹏ U)
    tweetwithcandidategenewationinfo
  ], (ˆ ﻌ ˆ)♡
  @named(moduwenames.pwoducewbasedunifiedsimiwawityengine)
  p-pwoducewbasedunifiedsimiwawityengine: standawdsimiwawityengine[
    pwoducewbasedunifiedsimiwawityengine.quewy, (⑅˘꒳˘)
    t-tweetwithcandidategenewationinfo
  ], (U ﹏ U)
  @named(moduwenames.consumewembeddingbasedtwipsimiwawityengine)
  consumewembeddingbasedtwipsimiwawityengine: s-standawdsimiwawityengine[
    twipenginequewy, o.O
    twiptweetwithscowe
  ],
  @named(moduwenames.consumewembeddingbasedtwhinannsimiwawityengine)
  c-consumewbasedtwhinannsimiwawityengine: h-hnswannsimiwawityengine, mya
  @named(moduwenames.consumewembeddingbasedtwotowewannsimiwawityengine)
  consumewbasedtwotowewsimiwawityengine: hnswannsimiwawityengine, XD
  @named(moduwenames.consumewsbasedusewvideogwaphsimiwawityengine)
  consumewsbasedusewvideogwaphsimiwawityengine: standawdsimiwawityengine[
    consumewsbasedusewvideogwaphsimiwawityengine.quewy, òωó
    tweetwithscowe
  ], (˘ω˘)
  @named(moduwenames.usewtweetentitygwaphsimiwawityengine) u-usewtweetentitygwaphsimiwawityengine: s-standawdsimiwawityengine[
    usewtweetentitygwaphsimiwawityengine.quewy, :3
    t-tweetwithscoweandsociawpwoof
  ], OwO
  @named(moduwenames.consumewbasedwawssimiwawityengine)
  c-consumewbasedwawssimiwawityengine: s-standawdsimiwawityengine[
    consumewbasedwawssimiwawityengine.quewy, mya
    tweetwithscowe
  ], (˘ω˘)
  tweetinfostowe: w-weadabwestowe[tweetid, o.O tweetinfo],
  gwobawstats: statsweceivew, (✿oωo)
) {

  impowt candidatesouwceswoutew._
  vaw stats: statsweceivew = g-gwobawstats.scope(this.getcwass.getsimpwename)

  def fetchcandidates(
    w-wequestusewid: u-usewid, (ˆ ﻌ ˆ)♡
    s-souwcesignaws: set[souwceinfo],
    s-souwcegwaphs: m-map[stwing, ^^;; o-option[gwaphsouwceinfo]], OwO
    p-pawams: configapi.pawams, 🥺
  ): futuwe[seq[seq[initiawcandidate]]] = {

    vaw tweetbasedcandidatesfutuwe = getcandidates(
      g-gettweetbasedsouwceinfo(souwcesignaws), mya
      pawams, 😳
      t-tweetbasedunifiedsimiwawityengine.fwompawams, òωó
      t-tweetbasedunifiedsimiwawityengine.getcandidates)

    v-vaw pwoducewbasedcandidatesfutuwe =
      g-getcandidates(
        getpwoducewbasedsouwceinfo(souwcesignaws), /(^•ω•^)
        pawams, -.-
        pwoducewbasedunifiedsimiwawityengine.fwompawams(_, òωó _),
        p-pwoducewbasedunifiedsimiwawityengine.getcandidates
      )

    vaw simcwustewsintewestedinbasedcandidatesfutuwe =
      getcandidatespewsimiwawityenginemodew(
        wequestusewid, /(^•ω•^)
        pawams, /(^•ω•^)
        simcwustewsintewestedincandidategenewation.fwompawams,
        s-simcwustewsintewestedincandidategenewation.get)

    vaw consumewembeddingbasedwogfavbasedtwipcandidatesfutuwe =
      if (pawams(
          consumewembeddingbasedcandidategenewationpawams.enabwewogfavbasedsimcwustewstwippawam)) {
        g-getsimcwustewstwipcandidates(
          pawams, 😳
          c-consumewembeddingbasedtwipsimiwawityengine.fwompawams(
            m-modewconfig.consumewwogfavbasedintewestedinembedding, :3
            intewnawid.usewid(wequestusewid),
            p-pawams
          ), (U ᵕ U❁)
          consumewembeddingbasedtwipsimiwawityengine
        ).map {
          s-seq(_)
        }
      } e-ewse
        futuwe.niw

    vaw consumewsbaseduvgweawgwaphincandidatesfutuwe =
      if (pawams(consumewsbasedusewvideogwaphpawams.enabwesouwcepawam)) {
        vaw weawgwaphingwaphsouwceinfoopt =
          getgwaphsouwceinfobysouwcetype(souwcetype.weawgwaphin.name, ʘwʘ s-souwcegwaphs)

        getgwaphbasedcandidates(
          p-pawams,
          consumewsbasedusewvideogwaphsimiwawityengine
            .fwompawamsfowweawgwaphin(
              w-weawgwaphingwaphsouwceinfoopt
                .map { gwaphsouwceinfo => g-gwaphsouwceinfo.seedwithscowes }.getowewse(map.empty), o.O
              pawams), ʘwʘ
          consumewsbasedusewvideogwaphsimiwawityengine, ^^
          c-consumewsbasedusewvideogwaphsimiwawityengine.tosimiwawityengineinfo, ^•ﻌ•^
          w-weawgwaphingwaphsouwceinfoopt
        ).map {
          seq(_)
        }
      } e-ewse futuwe.niw

    v-vaw consumewembeddingbasedfowwowbasedtwipcandidatesfutuwe =
      if (pawams(
          consumewembeddingbasedcandidategenewationpawams.enabwefowwowbasedsimcwustewstwippawam)) {
        getsimcwustewstwipcandidates(
          pawams, mya
          consumewembeddingbasedtwipsimiwawityengine.fwompawams(
            m-modewconfig.consumewfowwowbasedintewestedinembedding, UwU
            i-intewnawid.usewid(wequestusewid), >_<
            p-pawams
          ), /(^•ω•^)
          consumewembeddingbasedtwipsimiwawityengine
        ).map {
          s-seq(_)
        }
      } e-ewse
        futuwe.niw

    v-vaw consumewbasedwawscandidatesfutuwe =
      if (pawams(
          consumewbasedwawspawams.enabwesouwcepawam
        )) {
        getconsumewbasedwawscandidates(souwcesignaws, òωó pawams)
      }.map { s-seq(_) }
      e-ewse futuwe.niw

    vaw consumewembeddingbasedtwhincandidatesfutuwe =
      i-if (pawams(consumewembeddingbasedcandidategenewationpawams.enabwetwhinpawam)) {
        g-gethnswcandidates(
          pawams, σωσ
          consumewembeddingbasedtwhinsimiwawityengine.fwompawams(
            intewnawid.usewid(wequestusewid), ( ͡o ω ͡o )
            pawams), nyaa~~
          c-consumewbasedtwhinannsimiwawityengine
        ).map { seq(_) }
      } ewse futuwe.niw

    vaw consumewembeddingbasedtwotowewcandidatesfutuwe =
      i-if (pawams(consumewembeddingbasedcandidategenewationpawams.enabwetwotowewpawam)) {
        gethnswcandidates(
          pawams, :3
          c-consumewembeddingbasedtwotowewsimiwawityengine.fwompawams(
            i-intewnawid.usewid(wequestusewid), UwU
            pawams), o.O
          consumewbasedtwotowewsimiwawityengine
        ).map {
          seq(_)
        }
      } ewse futuwe.niw

    vaw c-customizedwetwievawbasedcandidatesfutuwe =
      g-getcandidatespewsimiwawityenginemodew(
        wequestusewid, (ˆ ﻌ ˆ)♡
        pawams, ^^;;
        customizedwetwievawcandidategenewation.fwompawams, ʘwʘ
        c-customizedwetwievawcandidategenewation.get)

    futuwe
      .cowwect(
        s-seq(
          tweetbasedcandidatesfutuwe,
          pwoducewbasedcandidatesfutuwe, σωσ
          simcwustewsintewestedinbasedcandidatesfutuwe, ^^;;
          c-consumewbasedwawscandidatesfutuwe,
          consumewembeddingbasedwogfavbasedtwipcandidatesfutuwe, ʘwʘ
          c-consumewembeddingbasedfowwowbasedtwipcandidatesfutuwe, ^^
          c-consumewembeddingbasedtwhincandidatesfutuwe, nyaa~~
          consumewembeddingbasedtwotowewcandidatesfutuwe, (///ˬ///✿)
          consumewsbaseduvgweawgwaphincandidatesfutuwe, XD
          c-customizedwetwievawbasedcandidatesfutuwe
        )).map { candidateswist =>
        // w-wemove empty i-innewseq
        v-vaw wesuwt = candidateswist.fwatten.fiwtew(_.nonempty)
        s-stats.stat("numofsequences").add(wesuwt.size)
        s-stats.stat("fwattencandidateswithdup").add(wesuwt.fwatten.size)

        wesuwt
      }
  }

  pwivate d-def getgwaphbasedcandidates[quewytype](
    p-pawams: c-configapi.pawams, :3
    quewy: enginequewy[quewytype], òωó
    engine: s-standawdsimiwawityengine[quewytype, ^^ tweetwithscowe], ^•ﻌ•^
    t-tosimiwawityengineinfo: d-doubwe => simiwawityengineinfo, σωσ
    gwaphsouwceinfoopt: option[gwaphsouwceinfo] = n-nyone
  ): f-futuwe[seq[initiawcandidate]] = {
    v-vaw candidatesoptfut = e-engine.getcandidates(quewy)
    vaw tweetswithcandidategenewationinfooptfut = c-candidatesoptfut.map {
      _.map { tweetswithscowes =>
        vaw sowtedcandidates = tweetswithscowes.sowtby(-_.scowe)
        engine.getscopedstats.stat("sowtedcandidates_size").add(sowtedcandidates.size)
        vaw tweetswithcandidategenewationinfo = s-sowtedcandidates.map { tweetwithscowe =>
          {
            v-vaw simiwawityengineinfo = tosimiwawityengineinfo(tweetwithscowe.scowe)
            v-vaw souwceinfo = gwaphsouwceinfoopt.map { g-gwaphsouwceinfo =>
              // the intewnawid i-is a pwacehowdew v-vawue. (ˆ ﻌ ˆ)♡ we do n-nyot pwan to stowe t-the fuww seedusewid s-set. nyaa~~
              souwceinfo(
                souwcetype = gwaphsouwceinfo.souwcetype, ʘwʘ
                intewnawid = intewnawid.usewid(0w),
                souwceeventtime = nyone
              )
            }
            t-tweetwithcandidategenewationinfo(
              t-tweetwithscowe.tweetid, ^•ﻌ•^
              c-candidategenewationinfo(
                souwceinfo, rawr x3
                s-simiwawityengineinfo, 🥺
                seq.empty // atomic simiwawity engine. ʘwʘ hence i-it has nyo contwibuting s-ses
              )
            )
          }
        }
        vaw m-maxcandidatenum = pawams(gwobawpawams.maxcandidatenumpewsouwcekeypawam)
        tweetswithcandidategenewationinfo.take(maxcandidatenum)
      }
    }
    f-fow {
      t-tweetswithcandidategenewationinfoopt <- tweetswithcandidategenewationinfooptfut
      i-initiawcandidates <- c-convewttoinitiawcandidates(
        tweetswithcandidategenewationinfoopt.toseq.fwatten)
    } yiewd initiawcandidates
  }

  pwivate def getcandidates[quewytype](
    s-souwcesignaws: s-set[souwceinfo], (˘ω˘)
    p-pawams: c-configapi.pawams,
    f-fwompawams: (souwceinfo, o.O configapi.pawams) => q-quewytype, σωσ
    g-getfunc: quewytype => futuwe[option[seq[tweetwithcandidategenewationinfo]]]
  ): f-futuwe[seq[seq[initiawcandidate]]] = {
    v-vaw quewies = souwcesignaws.map { s-souwceinfo =>
      fwompawams(souwceinfo, (ꈍᴗꈍ) pawams)
    }.toseq

    f-futuwe
      .cowwect {
        quewies.map { q-quewy =>
          f-fow {
            candidates <- g-getfunc(quewy)
            pwefiwtewcandidates <- convewttoinitiawcandidates(candidates.toseq.fwatten)
          } y-yiewd {
            p-pwefiwtewcandidates
          }
        }
      }
  }

  p-pwivate def getconsumewbasedwawscandidates(
    souwcesignaws: set[souwceinfo], (ˆ ﻌ ˆ)♡
    p-pawams: configapi.pawams
  ): futuwe[seq[initiawcandidate]] = {
    // f-fetch souwce s-signaws and fiwtew them based o-on age. o.O
    vaw signaws = fiwtewutiw.tweetsouwceagefiwtew(
      g-getconsumewbasedwawssouwceinfo(souwcesignaws).toseq, :3
      p-pawams(consumewbasedwawspawams.maxtweetsignawagehouwspawam))

    vaw candidatesoptfut = c-consumewbasedwawssimiwawityengine.getcandidates(
      consumewbasedwawssimiwawityengine.fwompawams(signaws, -.- pawams)
    )
    v-vaw tweetswithcandidategenewationinfooptfut = c-candidatesoptfut.map {
      _.map { tweetswithscowes =>
        v-vaw sowtedcandidates = tweetswithscowes.sowtby(-_.scowe)
        v-vaw fiwtewedcandidates =
          f-fiwtewutiw.tweetagefiwtew(sowtedcandidates, ( ͡o ω ͡o ) p-pawams(gwobawpawams.maxtweetagehouwspawam))
        consumewbasedwawssimiwawityengine.getscopedstats
          .stat("fiwtewedcandidates_size").add(fiwtewedcandidates.size)

        vaw tweetswithcandidategenewationinfo = fiwtewedcandidates.map { tweetwithscowe =>
          {
            vaw simiwawityengineinfo =
              consumewbasedwawssimiwawityengine.tosimiwawityengineinfo(tweetwithscowe.scowe)
            tweetwithcandidategenewationinfo(
              tweetwithscowe.tweetid, /(^•ω•^)
              candidategenewationinfo(
                nyone, (⑅˘꒳˘)
                simiwawityengineinfo, òωó
                seq.empty // a-atomic simiwawity e-engine. 🥺 hence it has nyo contwibuting ses
              )
            )
          }
        }
        v-vaw maxcandidatenum = pawams(gwobawpawams.maxcandidatenumpewsouwcekeypawam)
        t-tweetswithcandidategenewationinfo.take(maxcandidatenum)
      }
    }
    f-fow {
      tweetswithcandidategenewationinfoopt <- t-tweetswithcandidategenewationinfooptfut
      initiawcandidates <- c-convewttoinitiawcandidates(
        t-tweetswithcandidategenewationinfoopt.toseq.fwatten)
    } yiewd i-initiawcandidates
  }

  pwivate d-def getsimcwustewstwipcandidates(
    p-pawams: configapi.pawams, (ˆ ﻌ ˆ)♡
    quewy: twipenginequewy, -.-
    e-engine: standawdsimiwawityengine[
      t-twipenginequewy, σωσ
      t-twiptweetwithscowe
    ], >_<
  ): f-futuwe[seq[initiawcandidate]] = {
    v-vaw tweetswithcandidatesgenewationinfooptfut =
      e-engine.getcandidates(enginequewy(quewy, :3 p-pawams)).map {
        _.map {
          _.map { t-tweetwithscowe =>
            // d-define fiwtews
            tweetwithcandidategenewationinfo(
              t-tweetwithscowe.tweetid, OwO
              c-candidategenewationinfo(
                n-nyone, rawr
                simiwawityengineinfo(
                  simiwawityenginetype.expwowetwipoffwinesimcwustewstweets, (///ˬ///✿)
                  n-nyone,
                  some(tweetwithscowe.scowe)), ^^
                seq.empty
              )
            )
          }
        }
      }
    f-fow {
      tweetswithcandidategenewationinfoopt <- tweetswithcandidatesgenewationinfooptfut
      i-initiawcandidates <- c-convewttoinitiawcandidates(
        t-tweetswithcandidategenewationinfoopt.toseq.fwatten)
    } yiewd initiawcandidates
  }

  p-pwivate def gethnswcandidates(
    pawams: configapi.pawams, XD
    q-quewy: hnswannenginequewy, UwU
    engine: hnswannsimiwawityengine, o.O
  ): f-futuwe[seq[initiawcandidate]] = {
    vaw c-candidatesoptfut = engine.getcandidates(quewy)
    vaw tweetswithcandidategenewationinfooptfut = candidatesoptfut.map {
      _.map { tweetswithscowes =>
        v-vaw sowtedcandidates = tweetswithscowes.sowtby(-_.scowe)
        v-vaw fiwtewedcandidates =
          f-fiwtewutiw.tweetagefiwtew(sowtedcandidates, 😳 pawams(gwobawpawams.maxtweetagehouwspawam))
        engine.getscopedstats.stat("fiwtewedcandidates_size").add(fiwtewedcandidates.size)
        vaw tweetswithcandidategenewationinfo = f-fiwtewedcandidates.map { tweetwithscowe =>
          {
            v-vaw s-simiwawityengineinfo =
              e-engine.tosimiwawityengineinfo(quewy, (˘ω˘) tweetwithscowe.scowe)
            tweetwithcandidategenewationinfo(
              t-tweetwithscowe.tweetid, 🥺
              c-candidategenewationinfo(
                nyone, ^^
                s-simiwawityengineinfo, >w<
                seq.empty // atomic simiwawity e-engine. ^^;; hence it has nyo c-contwibuting ses
              )
            )
          }
        }
        v-vaw m-maxcandidatenum = pawams(gwobawpawams.maxcandidatenumpewsouwcekeypawam)
        t-tweetswithcandidategenewationinfo.take(maxcandidatenum)
      }
    }
    f-fow {
      t-tweetswithcandidategenewationinfoopt <- tweetswithcandidategenewationinfooptfut
      i-initiawcandidates <- convewttoinitiawcandidates(
        t-tweetswithcandidategenewationinfoopt.toseq.fwatten)
    } y-yiewd initiawcandidates
  }

  /**
   * w-wetuwns c-candidates fwom e-each simiwawity e-engine sepawatewy. (˘ω˘)
   * f-fow 1 wequestusewid, OwO i-it wiww fetch wesuwts f-fwom each simiwawity engine e_i, (ꈍᴗꈍ)
   * a-and wetuwns seq[seq[tweetcandidate]]. òωó
   */
  p-pwivate def g-getcandidatespewsimiwawityenginemodew[quewytype](
    w-wequestusewid: usewid, ʘwʘ
    pawams: configapi.pawams, ʘwʘ
    fwompawams: (intewnawid, nyaa~~ c-configapi.pawams) => q-quewytype, UwU
    getfunc: q-quewytype => futuwe[
      option[seq[seq[tweetwithcandidategenewationinfo]]]
    ]
  ): futuwe[seq[seq[initiawcandidate]]] = {
    v-vaw q-quewy = fwompawams(intewnawid.usewid(wequestusewid), (⑅˘꒳˘) pawams)
    g-getfunc(quewy).fwatmap { c-candidatespewsimiwawityenginemodewopt =>
      vaw candidatespewsimiwawityenginemodew = candidatespewsimiwawityenginemodewopt.toseq.fwatten
      futuwe.cowwect {
        c-candidatespewsimiwawityenginemodew.map(convewttoinitiawcandidates)
      }
    }
  }

  p-pwivate[candidate_genewation] d-def convewttoinitiawcandidates(
    candidates: s-seq[tweetwithcandidategenewationinfo], (˘ω˘)
  ): futuwe[seq[initiawcandidate]] = {
    vaw t-tweetids = candidates.map(_.tweetid).toset
    f-futuwe.cowwect(tweetinfostowe.muwtiget(tweetids)).map { tweetinfos =>
      /***
       * if tweetinfo d-does nyot exist, we wiww fiwtew out this t-tweet candidate. :3
       */
      candidates.cowwect {
        c-case c-candidate if tweetinfos.getowewse(candidate.tweetid, (˘ω˘) n-nyone).isdefined =>
          v-vaw tweetinfo = tweetinfos(candidate.tweetid)
            .getowewse(thwow n-nyew iwwegawstateexception("check pwevious wine's c-condition"))

          i-initiawcandidate(
            t-tweetid = c-candidate.tweetid, nyaa~~
            tweetinfo = tweetinfo, (U ﹏ U)
            c-candidate.candidategenewationinfo
          )
      }
    }
  }
}

o-object candidatesouwceswoutew {
  d-def getgwaphsouwceinfobysouwcetype(
    souwcetypestw: s-stwing, nyaa~~
    souwcegwaphs: map[stwing, ^^;; option[gwaphsouwceinfo]]
  ): o-option[gwaphsouwceinfo] = {
    s-souwcegwaphs.getowewse(souwcetypestw, OwO n-nyone)
  }

  def gettweetbasedsouwceinfo(
    souwcesignaws: set[souwceinfo]
  ): set[souwceinfo] = {
    s-souwcesignaws.cowwect {
      case souwceinfo
          i-if a-awwowedsouwcetypesfowtweetbasedunifiedse.contains(souwceinfo.souwcetype.vawue) =>
        souwceinfo
    }
  }

  def getpwoducewbasedsouwceinfo(
    s-souwcesignaws: set[souwceinfo]
  ): s-set[souwceinfo] = {
    s-souwcesignaws.cowwect {
      c-case souwceinfo
          i-if awwowedsouwcetypesfowpwoducewbasedunifiedse.contains(souwceinfo.souwcetype.vawue) =>
        s-souwceinfo
    }
  }

  def getconsumewbasedwawssouwceinfo(
    souwcesignaws: set[souwceinfo]
  ): set[souwceinfo] = {
    souwcesignaws.cowwect {
      c-case souwceinfo
          if awwowedsouwcetypesfowconsumewbasedwawsse.contains(souwceinfo.souwcetype.vawue) =>
        s-souwceinfo
    }
  }

  /***
   * signaw funnewing shouwd nyot exist i-in cg ow even in any simiwawityengine. nyaa~~
   * they wiww be in woutew, UwU ow eventuawwy, 😳 i-in cwcandidategenewatow. 😳
   */
  v-vaw awwowedsouwcetypesfowconsumewbasedwawsse = set(
    souwcetype.tweetfavowite.vawue, (ˆ ﻌ ˆ)♡
    s-souwcetype.wetweet.vawue, (✿oωo)
    souwcetype.tweetdontwike.vawue, nyaa~~ //cuwwentwy nyo-op
    souwcetype.tweetwepowt.vawue, ^^ //cuwwentwy n-nyo-op
    souwcetype.accountmute.vawue, (///ˬ///✿) //cuwwentwy n-nyo-op
    souwcetype.accountbwock.vawue //cuwwentwy n-nyo-op
  )
  vaw awwowedsouwcetypesfowtweetbasedunifiedse = s-set(
    souwcetype.tweetfavowite.vawue, 😳
    souwcetype.wetweet.vawue, òωó
    souwcetype.owiginawtweet.vawue, ^^;;
    souwcetype.wepwy.vawue, rawr
    s-souwcetype.tweetshawe.vawue,
    souwcetype.notificationcwick.vawue, (ˆ ﻌ ˆ)♡
    souwcetype.goodtweetcwick.vawue, XD
    souwcetype.videotweetquawityview.vawue, >_<
    s-souwcetype.videotweetpwayback50.vawue, (˘ω˘)
    s-souwcetype.tweetaggwegation.vawue, 😳
  )
  vaw a-awwowedsouwcetypesfowpwoducewbasedunifiedse = set(
    souwcetype.usewfowwow.vawue, o.O
    souwcetype.usewwepeatedpwofiwevisit.vawue, (ꈍᴗꈍ)
    s-souwcetype.weawgwaphoon.vawue, rawr x3
    souwcetype.fowwowwecommendation.vawue, ^^
    souwcetype.usewtwafficattwibutionpwofiwevisit.vawue, OwO
    souwcetype.goodpwofiwecwick.vawue, ^^
    souwcetype.pwoducewaggwegation.vawue, :3
  )
}
