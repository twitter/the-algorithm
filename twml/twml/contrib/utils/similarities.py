import tensorflow.compat.v1 as tf
def cosine_similarity(x1,x2,axis):'\n  cosine similarity of two tensors.\n\n  Arguments:\n    x1:\n      A tf.Tensor\n    x2:\n      A tf.Tensor\n    axis: Dimension along which to normalize.\n  ';A=axis;B=tf.nn.l2_normalize(x1,axis=A);C=tf.nn.l2_normalize(x2,axis=A);return tf.reduce_sum(tf.multiply(B,C),axis=A)